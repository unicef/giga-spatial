<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A powerful Python package for geospatial data analysis and processing"><meta name=author content="Utku Can Ozturk"><link href=https://unicef.github.io/giga-spatial/api/handlers/ rel=canonical><link href=../ rel=prev><link href=../processing/ rel=next><link rel=icon href=../../assets/GIGA_horizontal_notext_white.webp><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.18"><title>Handlers - Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.66ac8b77.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Handlers - Documentation"><meta property=og:description content="A powerful Python package for geospatial data analysis and processing"><meta property=og:image content=https://unicef.github.io/giga-spatial/assets/images/social/api/handlers.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://unicef.github.io/giga-spatial/api/handlers/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Handlers - Documentation"><meta name=twitter:description content="A powerful Python package for geospatial data analysis and processing"><meta name=twitter:image content=https://unicef.github.io/giga-spatial/assets/images/social/api/handlers.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#handlers-module class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Documentation class="md-header__button md-logo" aria-label=Documentation data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Handlers </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/unicef/giga-spatial title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> giga-spatial </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../user-guide/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Documentation class="md-nav__button md-logo" aria-label=Documentation data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> Documentation </label> <div class=md-nav__source> <a href=https://github.com/unicef/giga-spatial title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> giga-spatial </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/configuration.md class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../user-guide/ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Handlers </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Handlers </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#gigaspatial.handlers class=md-nav__link> <span class=md-ellipsis> handlers </span> </a> <nav class=md-nav aria-label=handlers> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gigaspatial.handlers.base class=md-nav__link> <span class=md-ellipsis> base </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.boundaries class=md-nav__link> <span class=md-ellipsis> boundaries </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.ghsl class=md-nav__link> <span class=md-ellipsis> ghsl </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.giga class=md-nav__link> <span class=md-ellipsis> giga </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.google_open_buildings class=md-nav__link> <span class=md-ellipsis> google_open_buildings </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.hdx class=md-nav__link> <span class=md-ellipsis> hdx </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.mapbox_image class=md-nav__link> <span class=md-ellipsis> mapbox_image </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.maxar_image class=md-nav__link> <span class=md-ellipsis> maxar_image </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.microsoft_global_buildings class=md-nav__link> <span class=md-ellipsis> microsoft_global_buildings </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.opencellid class=md-nav__link> <span class=md-ellipsis> opencellid </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.osm class=md-nav__link> <span class=md-ellipsis> osm </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.overture class=md-nav__link> <span class=md-ellipsis> overture </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.rwi class=md-nav__link> <span class=md-ellipsis> rwi </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.unicef_georepo class=md-nav__link> <span class=md-ellipsis> unicef_georepo </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.worldpop class=md-nav__link> <span class=md-ellipsis> worldpop </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../processing/ class=md-nav__link> <span class=md-ellipsis> Processing </span> </a> </li> <li class=md-nav__item> <a href=../core/ class=md-nav__link> <span class=md-ellipsis> Core </span> </a> </li> <li class=md-nav__item> <a href=../generators/ class=md-nav__link> <span class=md-ellipsis> Generators </span> </a> </li> <li class=md-nav__item> <a href=../grid/ class=md-nav__link> <span class=md-ellipsis> Grid </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> How to Contribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#gigaspatial.handlers class=md-nav__link> <span class=md-ellipsis> handlers </span> </a> <nav class=md-nav aria-label=handlers> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gigaspatial.handlers.base class=md-nav__link> <span class=md-ellipsis> base </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.boundaries class=md-nav__link> <span class=md-ellipsis> boundaries </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.ghsl class=md-nav__link> <span class=md-ellipsis> ghsl </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.giga class=md-nav__link> <span class=md-ellipsis> giga </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.google_open_buildings class=md-nav__link> <span class=md-ellipsis> google_open_buildings </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.hdx class=md-nav__link> <span class=md-ellipsis> hdx </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.mapbox_image class=md-nav__link> <span class=md-ellipsis> mapbox_image </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.maxar_image class=md-nav__link> <span class=md-ellipsis> maxar_image </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.microsoft_global_buildings class=md-nav__link> <span class=md-ellipsis> microsoft_global_buildings </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.opencellid class=md-nav__link> <span class=md-ellipsis> opencellid </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.osm class=md-nav__link> <span class=md-ellipsis> osm </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.overture class=md-nav__link> <span class=md-ellipsis> overture </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.rwi class=md-nav__link> <span class=md-ellipsis> rwi </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.unicef_georepo class=md-nav__link> <span class=md-ellipsis> unicef_georepo </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.handlers.worldpop class=md-nav__link> <span class=md-ellipsis> worldpop </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=handlers-module>Handlers Module<a class=headerlink href=#handlers-module title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <h2 id=gigaspatial.handlers class="doc doc-heading"> <code>gigaspatial.handlers</code> <a href=#gigaspatial.handlers class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.base class="doc doc-heading"> <code>base</code> <a href=#gigaspatial.handlers.base class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.base.BaseHandler class="doc doc-heading"> <code>BaseHandler</code> <a href=#gigaspatial.handlers.base.BaseHandler class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="abc.ABC">ABC</span></code></p> <p>Abstract base class that orchestrates configuration, downloading, and reading functionality.</p> <p>This class serves as the main entry point for dataset handlers, providing a unified interface for data acquisition and loading. It manages the lifecycle of config, downloader, and reader components.</p> <p>Subclasses should implement the abstract methods to provide specific handler types and define how components are created and interact.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=k>class</span> <span class=nc>BaseHandler</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>    Abstract base class that orchestrates configuration, downloading, and reading functionality.</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>    This class serves as the main entry point for dataset handlers, providing a unified</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>    interface for data acquisition and loading. It manages the lifecycle of config,</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>    downloader, and reader components.</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>    Subclasses should implement the abstract methods to provide specific handler types</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>    and define how components are created and interact.</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=n>downloader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerDownloader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>        <span class=n>reader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerReader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>    <span class=p>):</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><span class=sd>        Initialize the BaseHandler with optional components.</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><span class=sd>        Args:</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><span class=sd>            config: Configuration object. If None, will be created via create_config()</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><span class=sd>            downloader: Downloader instance. If None, will be created via create_downloader()</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><span class=sd>            reader: Reader instance. If None, will be created via create_reader()</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><span class=sd>            data_store: Data store instance. Defaults to LocalDataStore if not provided</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=sd>            logger: Logger instance. If not provided, creates one based on class name</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>        <span class=c1># Initialize data store first as it&#39;s used by other components</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>        <span class=c1># Initialize logger</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a>        <span class=c1># Initialize or create config</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_config</span><span class=p>(</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>                <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>            <span class=p>)</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>        <span class=c1># Initialize or create downloader</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=o>=</span> <span class=n>downloader</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>                <span class=n>config</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>            <span class=p>)</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>        <span class=c1># Initialize or create reader</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=o>=</span> <span class=n>reader</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_reader</span><span class=p>(</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>                <span class=n>config</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>            <span class=p>)</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>    <span class=nd>@property</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>    <span class=k>def</span> <span class=nf>config</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerConfig</span><span class=p>:</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the configuration object.&quot;&quot;&quot;</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_config</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>    <span class=nd>@property</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a>    <span class=k>def</span> <span class=nf>downloader</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerDownloader</span><span class=p>:</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the downloader object.&quot;&quot;&quot;</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a>    <span class=nd>@property</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a>    <span class=k>def</span> <span class=nf>reader</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerReader</span><span class=p>:</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the reader object.&quot;&quot;&quot;</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a>    <span class=c1># Abstract factory methods for creating components</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>    <span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerConfig</span><span class=p>:</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a><span class=sd>        Create and return a configuration object for this handler.</span>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>        Args:</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a><span class=sd>            **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a><span class=sd>        Returns:</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a><span class=sd>            Configured BaseHandlerConfig instance</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>        <span class=k>pass</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a>    <span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a>        <span class=n>config</span><span class=p>:</span> <span class=n>BaseHandlerConfig</span><span class=p>,</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerDownloader</span><span class=p>:</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>        Create and return a downloader object for this handler.</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>        Args:</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>            **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>        Returns:</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>            Configured BaseHandlerDownloader instance</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>        <span class=k>pass</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>    <span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>        <span class=n>config</span><span class=p>:</span> <span class=n>BaseHandlerConfig</span><span class=p>,</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerReader</span><span class=p>:</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>        Create and return a reader object for this handler.</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a><span class=sd>        Args:</span>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=sd>            **kwargs: Additional reader parameters</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a><span class=sd>        Returns:</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a><span class=sd>            Configured BaseHandlerReader instance</span>
</span><span id=__span-0-555><a id=__codelineno-0-555 name=__codelineno-0-555></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a>        <span class=k>pass</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>    <span class=c1># High-level interface methods</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>    <span class=k>def</span> <span class=nf>ensure_data_available</span><span class=p>(</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a>        <span class=p>],</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a>        <span class=n>force_download</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>        Ensure that data is available for the given source.</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>        This method checks if the required data exists locally, and if not (or if</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a><span class=sd>        force_download is True), downloads it using the downloader.</span>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a><span class=sd>        Args:</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=sd>            force_download: If True, download even if data exists locally</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>            **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a><span class=sd>        Returns:</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a><span class=sd>            bool: True if data is available after this operation</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>            <span class=c1># Resolve what data units are needed</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>                <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>                <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>                <span class=c1># Fallback: try to resolve paths directly</span>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>                <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=p>,</span> <span class=s2>&quot;resolve_source_paths&quot;</span><span class=p>):</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>                    <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Cannot determine required data paths&quot;</span><span class=p>)</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>                    <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>            <span class=c1># Check if data exists (unless force download)</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>force_download</span><span class=p>:</span>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>                <span class=n>missing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>                    <span class=n>path</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>                    <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>                    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>                <span class=p>]</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>                <span class=k>if</span> <span class=ow>not</span> <span class=n>missing_paths</span><span class=p>:</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;All required data is already available&quot;</span><span class=p>)</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>                    <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>            <span class=c1># Download missing or all data</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>                <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a>                <span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>                <span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a>            <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to ensure data availability: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>            <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a>    <span class=k>def</span> <span class=nf>load_data</span><span class=p>(</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>        <span class=p>],</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>        <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a><span class=sd>        Load data from the given source.</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a><span class=sd>        Args:</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a><span class=sd>            ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a><span class=sd>            **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a><span class=sd>        Returns:</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a><span class=sd>            Loaded data (type depends on specific handler implementation)</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>        <span class=k>if</span> <span class=n>ensure_available</span><span class=p>:</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensure_data_available</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>                <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;Could not ensure data availability for loading&quot;</span><span class=p>)</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a>    <span class=k>def</span> <span class=nf>download_and_load</span><span class=p>(</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a>        <span class=p>],</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>        <span class=n>force_download</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a><span class=sd>        Convenience method to download (if needed) and load data in one call.</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a><span class=sd>        Args:</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a><span class=sd>            force_download: If True, download even if data exists locally</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a><span class=sd>            **kwargs: Additional parameters</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a><span class=sd>        Returns:</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a><span class=sd>            Loaded data</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ensure_data_available</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>force_download</span><span class=o>=</span><span class=n>force_download</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a>    <span class=k>def</span> <span class=nf>get_available_data_info</span><span class=p>(</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a>        <span class=p>],</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a><span class=sd>        Get information about available data for the given source.</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a><span class=sd>        Args:</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a><span class=sd>            **kwargs: Additional parameters</span>
</span><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a><span class=sd>        Returns:</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a><span class=sd>            dict: Information about data availability, paths, etc.</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a>                <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a>                <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a>                <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a>            <span class=n>existing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a>                <span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a>            <span class=p>]</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a>            <span class=n>missing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a>                <span class=n>path</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>                <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a>                <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a>            <span class=p>]</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>                <span class=s2>&quot;total_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>data_paths</span><span class=p>),</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>                <span class=s2>&quot;available_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>existing_paths</span><span class=p>),</span>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a>                <span class=s2>&quot;missing_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_paths</span><span class=p>),</span>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a>                <span class=s2>&quot;available_paths&quot;</span><span class=p>:</span> <span class=n>existing_paths</span><span class=p>,</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a>                <span class=s2>&quot;missing_paths&quot;</span><span class=p>:</span> <span class=n>missing_paths</span><span class=p>,</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a>                <span class=s2>&quot;all_available&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_paths</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a>            <span class=p>}</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to get data info: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a>                <span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>),</span>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a>                <span class=s2>&quot;total_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-730><a id=__codelineno-0-730 name=__codelineno-0-730></a>                <span class=s2>&quot;available_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-731><a id=__codelineno-0-731 name=__codelineno-0-731></a>                <span class=s2>&quot;missing_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a>                <span class=s2>&quot;available_paths&quot;</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a>                <span class=s2>&quot;missing_paths&quot;</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a>                <span class=s2>&quot;all_available&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a>            <span class=p>}</span>
</span><span id=__span-0-736><a id=__codelineno-0-736 name=__codelineno-0-736></a>
</span><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a>    <span class=k>def</span> <span class=nf>cleanup</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a><span class=sd>        Cleanup resources used by the handler.</span>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a><span class=sd>        Override in subclasses if specific cleanup is needed.</span>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cleaning up </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a>        <span class=c1># Subclasses can override to add specific cleanup logic</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a>    <span class=k>def</span> <span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Context manager entry.&quot;&quot;&quot;</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a>        <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a>    <span class=k>def</span> <span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_val</span><span class=p>,</span> <span class=n>exc_tb</span><span class=p>):</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Context manager exit.&quot;&quot;&quot;</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cleanup</span><span class=p>()</span>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;String representation of the handler.&quot;&quot;&quot;</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>(&quot;</span>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a>            <span class=sa>f</span><span class=s2>&quot;config=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a>            <span class=sa>f</span><span class=s2>&quot;downloader=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a>            <span class=sa>f</span><span class=s2>&quot;reader=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.base.BaseHandler.config class="doc doc-heading"> <code class="highlight language-python"><span class=n>config</span><span class=p>:</span> <span class=n>BaseHandlerConfig</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get the configuration object.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.base.BaseHandler.downloader class="doc doc-heading"> <code class="highlight language-python"><span class=n>downloader</span><span class=p>:</span> <span class=n>BaseHandlerDownloader</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.downloader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get the downloader object.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.base.BaseHandler.reader class="doc doc-heading"> <code class="highlight language-python"><span class=n>reader</span><span class=p>:</span> <span class=n>BaseHandlerReader</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.reader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get the reader object.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.__enter__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__enter__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.__enter__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Context manager entry.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a><span class=k>def</span> <span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Context manager entry.&quot;&quot;&quot;</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a>    <span class=k>return</span> <span class=bp>self</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.__exit__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__exit__</span><span class=p>(</span><span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_val</span><span class=p>,</span> <span class=n>exc_tb</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.__exit__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Context manager exit.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a><span class=k>def</span> <span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_val</span><span class=p>,</span> <span class=n>exc_tb</span><span class=p>):</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Context manager exit.&quot;&quot;&quot;</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>    <span class=bp>self</span><span class=o>.</span><span class=n>cleanup</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>downloader</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>reader</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the BaseHandler with optional components.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>Configuration object. If None, will be created via create_config()</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>downloader</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerDownloader" href="#gigaspatial.handlers.base.BaseHandlerDownloader">BaseHandlerDownloader</a>]</code> </td> <td> <div class=doc-md-description> <p>Downloader instance. If None, will be created via create_downloader()</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>reader</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerReader" href="#gigaspatial.handlers.base.BaseHandlerReader">BaseHandlerReader</a>]</code> </td> <td> <div class=doc-md-description> <p>Reader instance. If None, will be created via create_reader()</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Data store instance. Defaults to LocalDataStore if not provided</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Logger instance. If not provided, creates one based on class name</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>    <span class=n>downloader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerDownloader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>    <span class=n>reader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerReader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=p>):</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><span class=sd>    Initialize the BaseHandler with optional components.</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><span class=sd>    Args:</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><span class=sd>        config: Configuration object. If None, will be created via create_config()</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><span class=sd>        downloader: Downloader instance. If None, will be created via create_downloader()</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a><span class=sd>        reader: Reader instance. If None, will be created via create_reader()</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><span class=sd>        data_store: Data store instance. Defaults to LocalDataStore if not provided</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=sd>        logger: Logger instance. If not provided, creates one based on class name</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>    <span class=c1># Initialize data store first as it&#39;s used by other components</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>    <span class=c1># Initialize logger</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a>    <span class=c1># Initialize or create config</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_config</span><span class=p>(</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>        <span class=p>)</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>    <span class=c1># Initialize or create downloader</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=o>=</span> <span class=n>downloader</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_downloader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>            <span class=n>config</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=p>)</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>    <span class=c1># Initialize or create reader</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=o>=</span> <span class=n>reader</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_reader</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_reader</span><span class=p>(</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>            <span class=n>config</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>logger</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.__repr__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__repr__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.__repr__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>String representation of the handler.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a><span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;String representation of the handler.&quot;&quot;&quot;</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>        <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>(&quot;</span>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a>        <span class=sa>f</span><span class=s2>&quot;config=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a>        <span class=sa>f</span><span class=s2>&quot;downloader=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a>        <span class=sa>f</span><span class=s2>&quot;reader=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.cleanup class="doc doc-heading"> <code class="highlight language-python"><span class=n>cleanup</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.cleanup class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Cleanup resources used by the handler.</p> <p>Override in subclasses if specific cleanup is needed.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a><span class=k>def</span> <span class=nf>cleanup</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a><span class=sd>    Cleanup resources used by the handler.</span>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a><span class=sd>    Override in subclasses if specific cleanup is needed.</span>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cleaning up </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.create_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_config</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.create_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a configuration object for this handler.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional configuration parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configured BaseHandlerConfig instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerConfig</span><span class=p>:</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a><span class=sd>    Create and return a configuration object for this handler.</span>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>    Args:</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a><span class=sd>        **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a><span class=sd>    Returns:</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a><span class=sd>        Configured BaseHandlerConfig instance</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.create_downloader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_downloader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.create_downloader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a downloader object for this handler.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional downloader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerDownloader" href="#gigaspatial.handlers.base.BaseHandlerDownloader">BaseHandlerDownloader</a></code> </td> <td> <div class=doc-md-description> <p>Configured BaseHandlerDownloader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a><span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a>    <span class=n>config</span><span class=p>:</span> <span class=n>BaseHandlerConfig</span><span class=p>,</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerDownloader</span><span class=p>:</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>    Create and return a downloader object for this handler.</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>    Args:</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>        **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>    Returns:</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>        Configured BaseHandlerDownloader instance</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.create_reader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_reader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandler.create_reader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a reader object for this handler.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional reader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerReader" href="#gigaspatial.handlers.base.BaseHandlerReader">BaseHandlerReader</a></code> </td> <td> <div class=doc-md-description> <p>Configured BaseHandlerReader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>    <span class=n>config</span><span class=p>:</span> <span class=n>BaseHandlerConfig</span><span class=p>,</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BaseHandlerReader</span><span class=p>:</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>    Create and return a reader object for this handler.</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a><span class=sd>    Args:</span>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=sd>        **kwargs: Additional reader parameters</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a><span class=sd>    Returns:</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a><span class=sd>        Configured BaseHandlerReader instance</span>
</span><span id=__span-0-555><a id=__codelineno-0-555 name=__codelineno-0-555></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.download_and_load class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_and_load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>force_download</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.download_and_load class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Convenience method to download (if needed) and load data in one call.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>force_download</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, download even if data exists locally</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>Loaded data</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a><span class=k>def</span> <span class=nf>download_and_load</span><span class=p>(</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a>    <span class=p>],</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>    <span class=n>force_download</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a><span class=sd>    Convenience method to download (if needed) and load data in one call.</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a><span class=sd>    Args:</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a><span class=sd>        force_download: If True, download even if data exists locally</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a><span class=sd>        **kwargs: Additional parameters</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a><span class=sd>    Returns:</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a><span class=sd>        Loaded data</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>    <span class=bp>self</span><span class=o>.</span><span class=n>ensure_data_available</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>force_download</span><span class=o>=</span><span class=n>force_download</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.ensure_data_available class="doc doc-heading"> <code class="highlight language-python"><span class=n>ensure_data_available</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>force_download</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.ensure_data_available class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Ensure that data is available for the given source.</p> <p>This method checks if the required data exists locally, and if not (or if force_download is True), downloads it using the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>force_download</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, download even if data exists locally</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to download methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>True if data is available after this operation</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a><span class=k>def</span> <span class=nf>ensure_data_available</span><span class=p>(</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a>    <span class=p>],</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a>    <span class=n>force_download</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>    Ensure that data is available for the given source.</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>    This method checks if the required data exists locally, and if not (or if</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a><span class=sd>    force_download is True), downloads it using the downloader.</span>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a><span class=sd>    Args:</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=sd>        force_download: If True, download even if data exists locally</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>        **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a><span class=sd>    Returns:</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a><span class=sd>        bool: True if data is available after this operation</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>        <span class=c1># Resolve what data units are needed</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>            <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>            <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>            <span class=c1># Fallback: try to resolve paths directly</span>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=p>,</span> <span class=s2>&quot;resolve_source_paths&quot;</span><span class=p>):</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>                <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Cannot determine required data paths&quot;</span><span class=p>)</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>                <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>        <span class=c1># Check if data exists (unless force download)</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>force_download</span><span class=p>:</span>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>            <span class=n>missing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>                <span class=n>path</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>                <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>                <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>            <span class=p>]</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>missing_paths</span><span class=p>:</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;All required data is already available&quot;</span><span class=p>)</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>                <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>        <span class=c1># Download missing or all data</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>            <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a>            <span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>            <span class=bp>self</span><span class=o>.</span><span class=n>downloader</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a>        <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to ensure data availability: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>        <span class=k>return</span> <span class=kc>False</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.get_available_data_info class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_available_data_info</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.get_available_data_info class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get information about available data for the given source.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> <code>dict</code> </td> <td> <div class=doc-md-description> <p>Information about data availability, paths, etc.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a><span class=k>def</span> <span class=nf>get_available_data_info</span><span class=p>(</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a>    <span class=p>],</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a><span class=sd>    Get information about available data for the given source.</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a><span class=sd>    Args:</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a><span class=sd>        **kwargs: Additional parameters</span>
</span><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a><span class=sd>    Returns:</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a><span class=sd>        dict: Information about data availability, paths, etc.</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;get_relevant_data_units&quot;</span><span class=p>):</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a>            <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a>            <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a>            <span class=n>data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a>        <span class=n>existing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a>            <span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a>        <span class=p>]</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a>        <span class=n>missing_paths</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a>            <span class=n>path</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>            <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>data_paths</span>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a>        <span class=p>]</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>            <span class=s2>&quot;total_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>data_paths</span><span class=p>),</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>            <span class=s2>&quot;available_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>existing_paths</span><span class=p>),</span>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a>            <span class=s2>&quot;missing_data_units&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_paths</span><span class=p>),</span>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a>            <span class=s2>&quot;available_paths&quot;</span><span class=p>:</span> <span class=n>existing_paths</span><span class=p>,</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a>            <span class=s2>&quot;missing_paths&quot;</span><span class=p>:</span> <span class=n>missing_paths</span><span class=p>,</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a>            <span class=s2>&quot;all_available&quot;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_paths</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a>        <span class=p>}</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to get data info: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a>            <span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>),</span>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a>            <span class=s2>&quot;total_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-730><a id=__codelineno-0-730 name=__codelineno-0-730></a>            <span class=s2>&quot;available_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-731><a id=__codelineno-0-731 name=__codelineno-0-731></a>            <span class=s2>&quot;missing_data_units&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a>            <span class=s2>&quot;available_paths&quot;</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a>            <span class=s2>&quot;missing_paths&quot;</span><span class=p>:</span> <span class=p>[],</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a>            <span class=s2>&quot;all_available&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a>        <span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandler.load_data class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_data</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandler.load_data class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load data from the given source.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>ensure_available</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, ensure data is downloaded before loading</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to load methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>Loaded data (type depends on specific handler implementation)</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a><span class=k>def</span> <span class=nf>load_data</span><span class=p>(</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>    <span class=p>],</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a><span class=sd>    Load data from the given source.</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a><span class=sd>    Args:</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a><span class=sd>        ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a><span class=sd>        **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a><span class=sd>    Returns:</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a><span class=sd>        Loaded data (type depends on specific handler implementation)</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>    <span class=k>if</span> <span class=n>ensure_available</span><span class=p>:</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>ensure_data_available</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;Could not ensure data availability for loading&quot;</span><span class=p>)</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>reader</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.base.BaseHandlerConfig class="doc doc-heading"> <code>BaseHandlerConfig</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="abc.ABC">ABC</span></code></p> <p>Abstract base class for handler configuration objects. Provides standard fields for path, parallelism, data store, and logger. Extend this class for dataset-specific configuration.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=nd>@dataclass</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=k>class</span> <span class=nc>BaseHandlerConfig</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    Abstract base class for handler configuration objects.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    Provides standard fields for path, parallelism, data store, and logger.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>    Extend this class for dataset-specific configuration.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>n_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>cpu_count</span><span class=p>()</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=n>LocalDataStore</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>repr</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units</span><span class=p>(</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=p>],</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=p>):</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>            <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_relevant_data_units_by_country</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>)):</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>            <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>            <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=p>(</span><span class=n>Iterable</span><span class=p>,</span> <span class=n>Point</span><span class=p>))</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>source</span><span class=p>):</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>                <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>                    <span class=s2>&quot;List input to get_relevant_data_units must be all points.&quot;</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>                <span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unsupported source type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=k>return</span> <span class=n>data_units</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        Given a geometry, return a list of relevant data unit identifiers (e.g., tiles, files, resources).</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=k>pass</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        Given a list of points, return a list of relevant data unit identifiers.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=k>pass</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_country</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>        Given a country code or name, return a list of relevant data unit identifiers.</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=kn>from</span> <span class=nn>gigaspatial.handlers.boundaries</span> <span class=kn>import</span> <span class=n>AdminBoundaries</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=n>country_geometry</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=n>AdminBoundaries</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>country_code</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=o>.</span><span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=n>geometry</span><span class=o>=</span><span class=n>country_geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unit</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        Given a data unit identifier, return the corresponding file path.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>pass</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>    <span class=k>def</span> <span class=nf>get_data_unit_paths</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>units</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Iterable</span><span class=p>[</span><span class=n>Any</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>        Given data unit identifiers, return the corresponding file paths.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=n>units</span> <span class=o>=</span> <span class=p>[</span><span class=n>units</span><span class=p>]</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>units</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>unit</span><span class=o>=</span><span class=n>unit</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=k>for</span> <span class=n>unit</span> <span class=ow>in</span> <span class=n>units</span><span class=p>]</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerConfig.get_data_unit_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerConfig.get_data_unit_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given a data unit identifier, return the corresponding file path.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unit</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>    Given a data unit identifier, return the corresponding file path.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerConfig.get_data_unit_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerConfig.get_data_unit_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given data unit identifiers, return the corresponding file paths.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=k>def</span> <span class=nf>get_data_unit_paths</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>units</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Iterable</span><span class=p>[</span><span class=n>Any</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>    Given data unit identifiers, return the corresponding file paths.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=n>units</span> <span class=o>=</span> <span class=p>[</span><span class=n>units</span><span class=p>]</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>units</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>unit</span><span class=o>=</span><span class=n>unit</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=k>for</span> <span class=n>unit</span> <span class=ow>in</span> <span class=n>units</span><span class=p>]</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given a country code or name, return a list of relevant data unit identifiers.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_country</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>    Given a country code or name, return a list of relevant data unit identifiers.</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=kn>from</span> <span class=nn>gigaspatial.handlers.boundaries</span> <span class=kn>import</span> <span class=n>AdminBoundaries</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>    <span class=n>country_geometry</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>AdminBoundaries</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>country_code</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=o>.</span><span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=n>geometry</span><span class=o>=</span><span class=n>country_geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_geometry class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_geometry class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given a geometry, return a list of relevant data unit identifiers (e.g., tiles, files, resources).</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>    Given a geometry, return a list of relevant data unit identifiers (e.g., tiles, files, resources).</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerConfig.get_relevant_data_units_by_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given a list of points, return a list of relevant data unit identifiers.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    Given a list of points, return a list of relevant data unit identifiers.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.base.BaseHandlerDownloader class="doc doc-heading"> <code>BaseHandlerDownloader</code> <a href=#gigaspatial.handlers.base.BaseHandlerDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="abc.ABC">ABC</span></code></p> <p>Abstract base class for handler downloader classes. Standardizes config, data_store, and logger initialization. Extend this class for dataset-specific downloaders.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=k>class</span> <span class=nc>BaseHandlerDownloader</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>    Abstract base class for handler downloader classes.</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    Standardizes config, data_store, and logger initialization.</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>    Extend this class for dataset-specific downloaders.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>    <span class=p>):</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=k>if</span> <span class=n>data_store</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=k>elif</span> <span class=n>config</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;data_store&quot;</span><span class=p>):</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>data_store</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=n>logger</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=ow>or</span> <span class=p>(</span><span class=nb>getattr</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;logger&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>if</span> <span class=n>config</span> <span class=k>else</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>        Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=k>pass</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>    <span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=k>pass</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>    <span class=k>def</span> <span class=nf>download</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>        <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerDownloader.download class="doc doc-heading"> <code class="highlight language-python"><span class=n>download</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerDownloader.download class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Abstract method to download data. Implement in subclasses.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=k>def</span> <span class=nf>download</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>    Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerDownloader.download_data_unit class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_unit</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerDownloader.download_data_unit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Abstract method to download data. Implement in subclasses.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>    Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerDownloader.download_data_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_units</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerDownloader.download_data_units class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Abstract method to download data. Implement in subclasses.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    Abstract method to download data. Implement in subclasses.</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.base.BaseHandlerReader class="doc doc-heading"> <code>BaseHandlerReader</code> <a href=#gigaspatial.handlers.base.BaseHandlerReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="abc.ABC">ABC</span></code></p> <p>Abstract base class for handler reader classes. Provides common methods for resolving source paths and loading data. Supports resolving by country, points, geometry, GeoDataFrame, or explicit paths. Includes generic loader functions for raster and tabular data.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=k>class</span> <span class=nc>BaseHandlerReader</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>    Abstract base class for handler reader classes.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>    Provides common methods for resolving source paths and loading data.</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    Supports resolving by country, points, geometry, GeoDataFrame, or explicit paths.</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>    Includes generic loader functions for raster and tabular data.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseHandlerConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>    <span class=p>):</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=k>if</span> <span class=n>data_store</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=k>elif</span> <span class=n>config</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;data_store&quot;</span><span class=p>):</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>data_store</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>logger</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=ow>or</span> <span class=p>(</span><span class=nb>getattr</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;logger&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>if</span> <span class=n>config</span> <span class=k>else</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>    <span class=k>def</span> <span class=nf>resolve_source_paths</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country code</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>            <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=p>],</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>        Resolve source data paths based on the type of source input.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>        Args:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>            source: Can be a country code or name (str), list of points, geometry, GeoDataFrame, or explicit path(s)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>            **kwargs: Additional parameters for path resolution</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        Returns:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>            List of resolved source paths</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>)):</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=c1># Could be a country code or a path</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>source</span><span class=p>))</span> <span class=ow>or</span> <span class=nb>str</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>                <span class=p>(</span><span class=s2>&quot;.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;.tif&quot;</span><span class=p>,</span> <span class=s2>&quot;.json&quot;</span><span class=p>,</span> <span class=s2>&quot;.parquet&quot;</span><span class=p>,</span> <span class=s2>&quot;.gz&quot;</span><span class=p>,</span> <span class=s2>&quot;.geojson&quot;</span><span class=p>,</span> <span class=s2>&quot;.zip&quot;</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>            <span class=p>):</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>                <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_paths</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>                <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_country</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>)):</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_geometry</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>            <span class=c1># List of points or paths</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>            <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=p>(</span><span class=n>Iterable</span><span class=p>,</span> <span class=n>Point</span><span class=p>))</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>source</span><span class=p>):</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>                <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_points</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>            <span class=k>elif</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>))</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>source</span><span class=p>):</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>                <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_paths</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>                    <span class=s2>&quot;List input to resolve_source_paths must be all points or all paths.&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>                <span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unsupported source type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Resolved </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>source_data_paths</span><span class=p>)</span><span class=si>}</span><span class=s2> paths!&quot;</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=k>return</span> <span class=n>source_data_paths</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>    <span class=k>def</span> <span class=nf>resolve_by_country</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>        Resolve source paths for a given country code/name.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        Uses the config&#39;s get_relevant_data_units_by_country method.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by country&quot;</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>    <span class=k>def</span> <span class=nf>resolve_by_points</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>        Resolve source paths for a list of points.</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>        Uses the config&#39;s get_relevant_data_units_by_points method.</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by points&quot;</span><span class=p>)</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>    <span class=k>def</span> <span class=nf>resolve_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=sd>        Resolve source paths for a geometry or GeoDataFrame.</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>        Uses the config&#39;s get_relevant_data_units_by_geometry method.</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>    <span class=k>def</span> <span class=nf>resolve_by_paths</span><span class=p>(</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>paths</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><span class=sd>        Return explicit paths as a list.</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>paths</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>)):</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>            <span class=k>return</span> <span class=p>[</span><span class=n>paths</span><span class=p>]</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>paths</span><span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=k>def</span> <span class=nf>_pre_load_hook</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Hook called before loading data.&quot;&quot;&quot;</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>,</span> <span class=p>(</span><span class=n>Path</span><span class=p>,</span> <span class=nb>str</span><span class=p>)):</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>            <span class=n>source_data_path</span> <span class=o>=</span> <span class=p>[</span><span class=n>source_data_path</span><span class=p>]</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>source_data_path</span><span class=p>:</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No paths found!&quot;</span><span class=p>)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>        <span class=n>source_data_paths</span> <span class=o>=</span> <span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span> <span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>source_data_path</span><span class=p>]</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>            <span class=sa>f</span><span class=s2>&quot;Pre-loading validation complete for </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>)</span><span class=si>}</span><span class=s2> files&quot;</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>        <span class=p>)</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>        <span class=k>return</span> <span class=n>source_data_paths</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>    <span class=k>def</span> <span class=nf>_post_load_hook</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Hook called after loading data.&quot;&quot;&quot;</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No data was loaded from the source files&quot;</span><span class=p>)</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>                <span class=k>return</span> <span class=n>data</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=si>}</span><span class=s2> valid data records.&quot;</span><span class=p>)</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Post-load processing complete.&quot;</span><span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=k>return</span> <span class=n>data</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>    <span class=k>def</span> <span class=nf>_check_file_exists</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>file_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]):</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><span class=sd>        Check that all specified files exist in the data store.</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=sd>        Args:</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=sd>            file_paths (List[Union[str, Path]]): List of file paths to check.</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>        Raises:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>            RuntimeError: If any file does not exist in the data store.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>        <span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>file_paths</span><span class=p>:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>file_path</span><span class=p>)):</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>                <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>                    <span class=sa>f</span><span class=s2>&quot;Source file does not exist in the data store: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>                <span class=p>)</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>    <span class=k>def</span> <span class=nf>_load_raster_data</span><span class=p>(</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>raster_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>]:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>        Load raster data from file paths.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>        Args:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>            raster_paths (List[Union[str, Path]]): List of file paths to raster files.</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><span class=sd>        Returns:</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>            List[TifProcessor]: List of TifProcessor objects for accessing the raster data.</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>        <span class=k>return</span> <span class=p>[</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>            <span class=n>TifProcessor</span><span class=p>(</span><span class=n>data_path</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;single&quot;</span><span class=p>)</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>            <span class=k>for</span> <span class=n>data_path</span> <span class=ow>in</span> <span class=n>raster_paths</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>        <span class=p>]</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>    <span class=k>def</span> <span class=nf>_load_tabular_data</span><span class=p>(</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>file_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=n>read_function</span><span class=p>:</span> <span class=n>Callable</span> <span class=o>=</span> <span class=n>read_dataset</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>]:</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><span class=sd>        Load and concatenate tabular data from multiple files.</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=sd>        Args:</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><span class=sd>            file_paths (List[Union[str, Path]]): List of file paths to load data from.</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><span class=sd>            read_function (Callable): Function to use for reading individual files.</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>                Defaults to read_dataset. Should accept (data_store, file_path) arguments.</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>        Returns:</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><span class=sd>            Union[pd.DataFrame, gpd.GeoDataFrame]: Concatenated data from all files.</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><span class=sd>                Returns empty DataFrame if no data is loaded.</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>        <span class=n>all_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>        <span class=k>for</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>file_paths</span><span class=p>:</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>            <span class=n>all_data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>read_function</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>file_path</span><span class=p>))</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>all_data</span><span class=p>:</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>all_data</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>    <span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><span class=sd>        Abstract method to load source data from paths.</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>        Args:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>            source_data_path: List of source paths</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>            **kwargs: Additional parameters for data loading</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><span class=sd>        Returns:</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><span class=sd>            Loaded data (DataFrame, GeoDataFrame, etc.)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=k>pass</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>    <span class=k>def</span> <span class=nf>load</span><span class=p>(</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>            <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>            <span class=n>Path</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>            <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>        <span class=p>],</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>        Load data from the given source.</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>        Args:</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            source: The data source (country code/name, points, geometry, paths, etc.).</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>            **kwargs: Additional parameters to pass to the loading process.</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>        Returns:</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>            The loaded data. The type depends on the subclass implementation.</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>        <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>source_data_paths</span><span class=p>:</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>                <span class=s2>&quot;No source data paths resolved. There&#39;s no matching data to load!&quot;</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>            <span class=p>)</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=n>processed_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pre_load_hook</span><span class=p>(</span><span class=n>source_data_paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>processed_paths</span><span class=p>:</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No valid paths to load data from.&quot;</span><span class=p>)</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>        <span class=n>loaded_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_from_paths</span><span class=p>(</span><span class=n>processed_paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_post_load_hook</span><span class=p>(</span><span class=n>loaded_data</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.load class="doc doc-heading"> <code class="highlight language-python"><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.load class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load data from the given source.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[float, float], <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source (country code/name, points, geometry, paths, etc.).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters to pass to the loading process.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>The loaded data. The type depends on the subclass implementation.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=k>def</span> <span class=nf>load</span><span class=p>(</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>        <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>        <span class=n>Path</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>        <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>    <span class=p>],</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>    Load data from the given source.</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>    Args:</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        source: The data source (country code/name, points, geometry, paths, etc.).</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>        **kwargs: Additional parameters to pass to the loading process.</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>    Returns:</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>        The loaded data. The type depends on the subclass implementation.</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>    <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>source_data_paths</span><span class=p>:</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>            <span class=s2>&quot;No source data paths resolved. There&#39;s no matching data to load!&quot;</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>        <span class=p>)</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>    <span class=n>processed_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pre_load_hook</span><span class=p>(</span><span class=n>source_data_paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>processed_paths</span><span class=p>:</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No valid paths to load data from.&quot;</span><span class=p>)</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>    <span class=n>loaded_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_from_paths</span><span class=p>(</span><span class=n>processed_paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_post_load_hook</span><span class=p>(</span><span class=n>loaded_data</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.load_from_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_from_paths</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.handlers.base.BaseHandlerReader.load_from_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Abstract method to load source data from paths.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source_data_path</code></td> <td> <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]</code> </td> <td> <div class=doc-md-description> <p>List of source paths</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters for data loading</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>Loaded data (DataFrame, GeoDataFrame, etc.)</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><span class=sd>    Abstract method to load source data from paths.</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>    Args:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>        source_data_path: List of source paths</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>        **kwargs: Additional parameters for data loading</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><span class=sd>    Returns:</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><span class=sd>        Loaded data (DataFrame, GeoDataFrame, etc.)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.resolve_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>resolve_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.resolve_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Resolve source paths for a given country code/name. Uses the config's get_relevant_data_units_by_country method.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=k>def</span> <span class=nf>resolve_by_country</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>    Resolve source paths for a given country code/name.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>    Uses the config&#39;s get_relevant_data_units_by_country method.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by country&quot;</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>    <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.resolve_by_geometry class="doc doc-heading"> <code class="highlight language-python"><span class=n>resolve_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.resolve_by_geometry class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Resolve source paths for a geometry or GeoDataFrame. Uses the config's get_relevant_data_units_by_geometry method.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><span class=k>def</span> <span class=nf>resolve_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=sd>    Resolve source paths for a geometry or GeoDataFrame.</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>    Uses the config&#39;s get_relevant_data_units_by_geometry method.</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.resolve_by_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>resolve_by_paths</span><span class=p>(</span><span class=n>paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.resolve_by_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return explicit paths as a list.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><span class=k>def</span> <span class=nf>resolve_by_paths</span><span class=p>(</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>paths</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><span class=sd>    Return explicit paths as a list.</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>paths</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>)):</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=k>return</span> <span class=p>[</span><span class=n>paths</span><span class=p>]</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>paths</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.resolve_by_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>resolve_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.resolve_by_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Resolve source paths for a list of points. Uses the config's get_relevant_data_units_by_points method.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=k>def</span> <span class=nf>resolve_by_points</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>    Resolve source paths for a list of points.</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>    Uses the config&#39;s get_relevant_data_units_by_points method.</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Config is required for resolving by points&quot;</span><span class=p>)</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>    <span class=n>data_units</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>data_units</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.base.BaseHandlerReader.resolve_source_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>resolve_source_paths</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.base.BaseHandlerReader.resolve_source_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Resolve source data paths based on the type of source input.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[float, float], <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>Can be a country code or name (str), list of points, geometry, GeoDataFrame, or explicit path(s)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters for path resolution</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]</code> </td> <td> <div class=doc-md-description> <p>List of resolved source paths</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=k>def</span> <span class=nf>resolve_source_paths</span><span class=p>(</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country code</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=p>],</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>    Resolve source data paths based on the type of source input.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>    Args:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>        source: Can be a country code or name (str), list of points, geometry, GeoDataFrame, or explicit path(s)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        **kwargs: Additional parameters for path resolution</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>    Returns:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>        List of resolved source paths</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>)):</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=c1># Could be a country code or a path</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>source</span><span class=p>))</span> <span class=ow>or</span> <span class=nb>str</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>            <span class=p>(</span><span class=s2>&quot;.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;.tif&quot;</span><span class=p>,</span> <span class=s2>&quot;.json&quot;</span><span class=p>,</span> <span class=s2>&quot;.parquet&quot;</span><span class=p>,</span> <span class=s2>&quot;.gz&quot;</span><span class=p>,</span> <span class=s2>&quot;.geojson&quot;</span><span class=p>,</span> <span class=s2>&quot;.zip&quot;</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=p>):</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_paths</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>            <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_country</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>)):</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>        <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_geometry</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=c1># List of points or paths</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>        <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=p>(</span><span class=n>Iterable</span><span class=p>,</span> <span class=n>Point</span><span class=p>))</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>source</span><span class=p>):</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>            <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_points</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=k>elif</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>))</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>source</span><span class=p>):</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=n>source_data_paths</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolve_by_paths</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>                <span class=s2>&quot;List input to resolve_source_paths must be all points or all paths.&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>            <span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unsupported source type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Resolved </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>source_data_paths</span><span class=p>)</span><span class=si>}</span><span class=s2> paths!&quot;</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>    <span class=k>return</span> <span class=n>source_data_paths</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.boundaries class="doc doc-heading"> <code>boundaries</code> <a href=#gigaspatial.handlers.boundaries class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.boundaries.AdminBoundaries class="doc doc-heading"> <code>AdminBoundaries</code> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Base class for administrative boundary data with flexible fields.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=k>class</span> <span class=nc>AdminBoundaries</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Base class for administrative boundary data with flexible fields.&quot;&quot;&quot;</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>boundaries</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>AdminBoundary</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=nb>list</span><span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=n>level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=o>...</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=n>ge</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=n>le</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Administrative level (e.g., 0=country, 1=state, etc.)&quot;</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>ClassVar</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=n>_schema_config</span><span class=p>:</span> <span class=n>ClassVar</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=s2>&quot;gadm&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=s2>&quot;country_code&quot;</span><span class=p>:</span> <span class=s2>&quot;GID_0&quot;</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=s2>&quot;GID_</span><span class=si>{level}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;NAME_</span><span class=si>{level}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=s2>&quot;parent_id&quot;</span><span class=p>:</span> <span class=s2>&quot;GID_</span><span class=si>{parent_level}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=p>},</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=s2>&quot;internal&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=s2>&quot;admin</span><span class=si>{level}</span><span class=s2>_id_giga&quot;</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>            <span class=s2>&quot;name_en&quot;</span><span class=p>:</span> <span class=s2>&quot;name_en&quot;</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=s2>&quot;country_code&quot;</span><span class=p>:</span> <span class=s2>&quot;iso_3166_1_alpha_3&quot;</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=p>},</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=p>}</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=k>def</span> <span class=nf>get_schema_config</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return field mappings for different data sources&quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_schema_config</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>def</span> <span class=nf>from_gadm</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=bp>cls</span><span class=p>,</span> <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load and create instance from GADM data.&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;https://geodata.ucdavis.edu/gadm/gadm4.1/json/gadm41_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>.json&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=sa>f</span><span class=s2>&quot;Loading GADM data for country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2> from URL: </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=n>gdf</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_map_fields</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=s2>&quot;gadm&quot;</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=k>if</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>                <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;COUNTRY&quot;</span><span class=p>]</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=k>elif</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>                <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;parent_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=n>AdminBoundary</span><span class=p>(</span><span class=o>**</span><span class=n>row_dict</span><span class=p>)</span> <span class=k>for</span> <span class=n>row_dict</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=p>]</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects.&quot;</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>                <span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span> <span class=n>country_code</span><span class=o>=</span><span class=n>country_code</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=n>HTTPError</span><span class=p>,</span> <span class=ne>FileNotFoundError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>                <span class=sa>f</span><span class=s2>&quot;Error loading GADM data for </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2> at admin level </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;gadm&quot;</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>def</span> <span class=nf>from_data_store</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=n>path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=s2>&quot;Path&quot;</span><span class=p>],</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load and create instance from internal data store.&quot;&quot;&quot;</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>            <span class=sa>f</span><span class=s2>&quot;Loading data from data store at path: </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=n>gdf</span> <span class=o>=</span> <span class=n>read_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=k>if</span> <span class=n>gdf</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>                <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data found at </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>                <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>gdf</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_map_fields</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=k>if</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;parent_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[:</span><span class=o>-</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                <span class=n>AdminBoundary</span><span class=p>(</span><span class=o>**</span><span class=n>row_dict</span><span class=p>)</span> <span class=k>for</span> <span class=n>row_dict</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>            <span class=p>]</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects.&quot;</span><span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>FileNotFoundError</span><span class=p>,</span> <span class=ne>KeyError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=sa>f</span><span class=s2>&quot;No data found at </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2> for admin level </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=k>def</span> <span class=nf>from_georepo</span><span class=p>(</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>        Load and create instance from GeoRepo (UNICEF) API.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        Args:</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>            country: Country name (if using name-based lookup)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>            iso3: ISO3 code (if using code-based lookup)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>            admin_level: Administrative level (0=country, 1=state, etc.)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>            api_key: GeoRepo API key (optional)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>            email: GeoRepo user email (optional)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>            kwargs: Extra arguments (ignored)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        Returns:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>            AdminBoundaries instance</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>            <span class=sa>f</span><span class=s2>&quot;Loading data from UNICEF GeoRepo for country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>        <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>        <span class=kn>from</span> <span class=nn>gigaspatial.handlers.unicef_georepo</span> <span class=kn>import</span> <span class=n>get_country_boundaries_by_iso3</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=c1># Fetch boundaries from GeoRepo</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=n>geojson</span> <span class=o>=</span> <span class=n>get_country_boundaries_by_iso3</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>        <span class=n>features</span> <span class=o>=</span> <span class=n>geojson</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;features&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=n>parent_level</span> <span class=o>=</span> <span class=n>admin_level</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=k>for</span> <span class=n>feat</span> <span class=ow>in</span> <span class=n>features</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>            <span class=n>props</span> <span class=o>=</span> <span class=n>feat</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;properties&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>            <span class=n>geometry</span> <span class=o>=</span> <span class=n>feat</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>            <span class=n>shapely_geom</span> <span class=o>=</span> <span class=n>shape</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span> <span class=k>if</span> <span class=n>geometry</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=c1># For admin_level 0, no parent_id</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=n>parent_id</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=k>if</span> <span class=n>admin_level</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                <span class=n>parent_id</span> <span class=o>=</span> <span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;adm</span><span class=si>{</span><span class=n>parent_level</span><span class=si>}</span><span class=s2>_ucode&quot;</span><span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>            <span class=n>boundary</span> <span class=o>=</span> <span class=n>AdminBoundary</span><span class=p>(</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>                <span class=nb>id</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ucode&quot;</span><span class=p>),</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>                <span class=n>name</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>),</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>                <span class=n>name_en</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name_en&quot;</span><span class=p>),</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>                <span class=n>geometry</span><span class=o>=</span><span class=n>shapely_geom</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>                <span class=n>parent_id</span><span class=o>=</span><span class=n>parent_id</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                <span class=n>country_code</span><span class=o>=</span><span class=n>country_code</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=n>boundaries</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>boundary</span><span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects from GeoRepo data.&quot;</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>        <span class=c1># Try to infer country_code from first boundary if not set</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=k>if</span> <span class=n>boundaries</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>country_code</span><span class=p>:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>            <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>country_code</span> <span class=o>=</span> <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>    <span class=k>def</span> <span class=nf>create</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>        <span class=n>country_code</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=n>path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=s2>&quot;Path&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Factory method to create AdminBoundaries instance from either GADM or data store.&quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=sa>f</span><span class=s2>&quot;Creating AdminBoundaries instance. Country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>, data_store provided: </span><span class=si>{</span><span class=n>data_store</span><span class=w> </span><span class=ow>is</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=kc>None</span><span class=si>}</span><span class=s2>, path provided: </span><span class=si>{</span><span class=n>path</span><span class=w> </span><span class=ow>is</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=kc>None</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=n>iso3_code</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>country_code</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=k>if</span> <span class=n>data_store</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>                <span class=k>if</span> <span class=n>country_code</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>                    <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>                        <span class=s2>&quot;If data_store is provided, path or country_code must also be specified.&quot;</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>                    <span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>                <span class=n>path</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_admin_path</span><span class=p>(</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>                    <span class=n>country_code</span><span class=o>=</span><span class=n>iso3_code</span><span class=p>,</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>                    <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>                <span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_data_store</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=k>elif</span> <span class=n>country_code</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=kn>from</span> <span class=nn>gigaspatial.handlers.unicef_georepo</span> <span class=kn>import</span> <span class=n>GeoRepoClient</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>                <span class=n>client</span> <span class=o>=</span> <span class=n>GeoRepoClient</span><span class=p>()</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>                <span class=k>if</span> <span class=n>client</span><span class=o>.</span><span class=n>check_connection</span><span class=p>():</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>                    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;GeoRepo connection successful.&quot;</span><span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>                    <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_georepo</span><span class=p>(</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>                        <span class=n>iso3_code</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                        <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                    <span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>                    <span class=sa>f</span><span class=s2>&quot;GeoRepo initialization failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. Falling back to GADM.&quot;</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                <span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>                <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;GeoRepo error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. Falling back to GADM.&quot;</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_gadm</span><span class=p>(</span><span class=n>iso3_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>                <span class=s2>&quot;Either country_code or (data_store, path) must be provided.&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>            <span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=k>def</span> <span class=nf>_create_empty_instance</span><span class=p>(</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=bp>cls</span><span class=p>,</span> <span class=n>country_code</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>source_type</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Create an empty instance with the required schema structure.&quot;&quot;&quot;</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=c1># for to_geodataframe() to use later</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>instance</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>(</span><span class=n>boundaries</span><span class=o>=</span><span class=p>[],</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span> <span class=n>country_code</span><span class=o>=</span><span class=n>country_code</span><span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=n>schema_fields</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>get_schema_config</span><span class=p>()[</span><span class=n>source_type</span><span class=p>]</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=n>schema_fields</span><span class=o>.</span><span class=n>update</span><span class=p>([</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span> <span class=s2>&quot;country_code&quot;</span><span class=p>,</span> <span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;name_en&quot;</span><span class=p>])</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>            <span class=n>schema_fields</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s2>&quot;parent_id&quot;</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>        <span class=n>instance</span><span class=o>.</span><span class=n>_empty_schema</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>schema_fields</span><span class=p>)</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=k>return</span> <span class=n>instance</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=k>def</span> <span class=nf>_map_fields</span><span class=p>(</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=n>gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=n>source</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=n>current_level</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map source fields to schema fields&quot;&quot;&quot;</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=n>config</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>get_schema_config</span><span class=p>()</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=n>parent_level</span> <span class=o>=</span> <span class=n>current_level</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=n>field_mapping</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>config</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>            <span class=k>if</span> <span class=s2>&quot;</span><span class=si>{parent_level}</span><span class=s2>&quot;</span> <span class=ow>in</span> <span class=n>v</span><span class=p>:</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>                <span class=n>field_mapping</span><span class=p>[</span><span class=n>v</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>parent_level</span><span class=o>=</span><span class=n>parent_level</span><span class=p>)]</span> <span class=o>=</span> <span class=n>k</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>            <span class=k>elif</span> <span class=s2>&quot;</span><span class=si>{level}</span><span class=s2>&quot;</span> <span class=ow>in</span> <span class=n>v</span><span class=p>:</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>                <span class=n>field_mapping</span><span class=p>[</span><span class=n>v</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>current_level</span><span class=p>)]</span> <span class=o>=</span> <span class=n>k</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>                <span class=n>field_mapping</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>k</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=k>return</span> <span class=n>gdf</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>field_mapping</span><span class=p>)</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>    <span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Convert the AdminBoundaries to a GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundaries</span><span class=p>:</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;_empty_schema&quot;</span><span class=p>):</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>                <span class=n>columns</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_empty_schema</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>                <span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;country_code&quot;</span><span class=p>,</span> <span class=s2>&quot;geometry&quot;</span><span class=p>]</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>level</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                    <span class=n>columns</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;parent_id&quot;</span><span class=p>)</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>            <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>columns</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span> <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>        <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>            <span class=p>[</span><span class=n>boundary</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span> <span class=k>for</span> <span class=n>boundary</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundaries</span><span class=p>],</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>            <span class=n>geometry</span><span class=o>=</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>            <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.create class="doc doc-heading"> <code class="highlight language-python"><span class=n>create</span><span class=p>(</span><span class=n>country_code</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>path</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.create class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Factory method to create AdminBoundaries instance from either GADM or data store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=nd>@classmethod</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=k>def</span> <span class=nf>create</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>    <span class=n>country_code</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>    <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>    <span class=n>path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=s2>&quot;Path&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Factory method to create AdminBoundaries instance from either GADM or data store.&quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=sa>f</span><span class=s2>&quot;Creating AdminBoundaries instance. Country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>, data_store provided: </span><span class=si>{</span><span class=n>data_store</span><span class=w> </span><span class=ow>is</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=kc>None</span><span class=si>}</span><span class=s2>, path provided: </span><span class=si>{</span><span class=n>path</span><span class=w> </span><span class=ow>is</span><span class=w> </span><span class=ow>not</span><span class=w> </span><span class=kc>None</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>    <span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=n>iso3_code</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>country_code</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>    <span class=k>if</span> <span class=n>data_store</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=k>if</span> <span class=n>country_code</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>                <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>                    <span class=s2>&quot;If data_store is provided, path or country_code must also be specified.&quot;</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>                <span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>            <span class=n>path</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_admin_path</span><span class=p>(</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>                <span class=n>country_code</span><span class=o>=</span><span class=n>iso3_code</span><span class=p>,</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>                <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>            <span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_data_store</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=k>elif</span> <span class=n>country_code</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=kn>from</span> <span class=nn>gigaspatial.handlers.unicef_georepo</span> <span class=kn>import</span> <span class=n>GeoRepoClient</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>            <span class=n>client</span> <span class=o>=</span> <span class=n>GeoRepoClient</span><span class=p>()</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=k>if</span> <span class=n>client</span><span class=o>.</span><span class=n>check_connection</span><span class=p>():</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>                <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;GeoRepo connection successful.&quot;</span><span class=p>)</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>                <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_georepo</span><span class=p>(</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>                    <span class=n>iso3_code</span><span class=p>,</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                    <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>                <span class=sa>f</span><span class=s2>&quot;GeoRepo initialization failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. Falling back to GADM.&quot;</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>            <span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;GeoRepo error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. Falling back to GADM.&quot;</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>from_gadm</span><span class=p>(</span><span class=n>iso3_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=s2>&quot;Either country_code or (data_store, path) must be provided.&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.from_data_store class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_data_store</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.from_data_store class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load and create instance from internal data store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=nd>@classmethod</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=k>def</span> <span class=nf>from_data_store</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=n>path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=s2>&quot;Path&quot;</span><span class=p>],</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Load and create instance from internal data store.&quot;&quot;&quot;</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=sa>f</span><span class=s2>&quot;Loading data from data store at path: </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>read_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>path</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=k>if</span> <span class=n>gdf</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data found at </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_map_fields</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>            <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>            <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;parent_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[:</span><span class=o>-</span><span class=mi>3</span><span class=p>])</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>            <span class=n>AdminBoundary</span><span class=p>(</span><span class=o>**</span><span class=n>row_dict</span><span class=p>)</span> <span class=k>for</span> <span class=n>row_dict</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=p>]</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects.&quot;</span><span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>    <span class=k>except</span> <span class=p>(</span><span class=ne>FileNotFoundError</span><span class=p>,</span> <span class=ne>KeyError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=sa>f</span><span class=s2>&quot;No data found at </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2> for admin level </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;internal&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.from_gadm class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_gadm</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.from_gadm class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load and create instance from GADM data.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=nd>@classmethod</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=k>def</span> <span class=nf>from_gadm</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=bp>cls</span><span class=p>,</span> <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Load and create instance from GADM data.&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;https://geodata.ucdavis.edu/gadm/gadm4.1/json/gadm41_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>.json&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=sa>f</span><span class=s2>&quot;Loading GADM data for country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2> from URL: </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_map_fields</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=s2>&quot;gadm&quot;</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;COUNTRY&quot;</span><span class=p>]</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=k>elif</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;country_code&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>gdf</span><span class=p>[</span><span class=s2>&quot;parent_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=n>AdminBoundary</span><span class=p>(</span><span class=o>**</span><span class=n>row_dict</span><span class=p>)</span> <span class=k>for</span> <span class=n>row_dict</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=p>]</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects.&quot;</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span> <span class=n>country_code</span><span class=o>=</span><span class=n>country_code</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>    <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=n>HTTPError</span><span class=p>,</span> <span class=ne>FileNotFoundError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=sa>f</span><span class=s2>&quot;Error loading GADM data for </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2> at admin level </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_empty_instance</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=s2>&quot;gadm&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.from_georepo class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_georepo</span><span class=p>(</span><span class=n>country_code</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.from_georepo class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load and create instance from GeoRepo (UNICEF) API.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>country</code></td> <td> </td> <td> <div class=doc-md-description> <p>Country name (if using name-based lookup)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>iso3</code></td> <td> </td> <td> <div class=doc-md-description> <p>ISO3 code (if using code-based lookup)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>admin_level</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Administrative level (0=country, 1=state, etc.)</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td><code>api_key</code></td> <td> </td> <td> <div class=doc-md-description> <p>GeoRepo API key (optional)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>email</code></td> <td> </td> <td> <div class=doc-md-description> <p>GeoRepo user email (optional)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Extra arguments (ignored)</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.boundaries.AdminBoundaries" href="#gigaspatial.handlers.boundaries.AdminBoundaries">AdminBoundaries</a></code> </td> <td> <div class=doc-md-description> <p>AdminBoundaries instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=nd>@classmethod</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=k>def</span> <span class=nf>from_georepo</span><span class=p>(</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>    <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=n>admin_level</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;AdminBoundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>    Load and create instance from GeoRepo (UNICEF) API.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    Args:</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>        country: Country name (if using name-based lookup)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        iso3: ISO3 code (if using code-based lookup)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>        admin_level: Administrative level (0=country, 1=state, etc.)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        api_key: GeoRepo API key (optional)</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        email: GeoRepo user email (optional)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        kwargs: Extra arguments (ignored)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    Returns:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>        AdminBoundaries instance</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=sa>f</span><span class=s2>&quot;Loading data from UNICEF GeoRepo for country: </span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>, admin level: </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>    <span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>    <span class=kn>from</span> <span class=nn>gigaspatial.handlers.unicef_georepo</span> <span class=kn>import</span> <span class=n>get_country_boundaries_by_iso3</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=c1># Fetch boundaries from GeoRepo</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>    <span class=n>geojson</span> <span class=o>=</span> <span class=n>get_country_boundaries_by_iso3</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=n>features</span> <span class=o>=</span> <span class=n>geojson</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;features&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>    <span class=n>boundaries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=n>parent_level</span> <span class=o>=</span> <span class=n>admin_level</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=k>for</span> <span class=n>feat</span> <span class=ow>in</span> <span class=n>features</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=n>props</span> <span class=o>=</span> <span class=n>feat</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;properties&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=n>geometry</span> <span class=o>=</span> <span class=n>feat</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>shapely_geom</span> <span class=o>=</span> <span class=n>shape</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span> <span class=k>if</span> <span class=n>geometry</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=c1># For admin_level 0, no parent_id</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=n>parent_id</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=n>parent_id</span> <span class=o>=</span> <span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;adm</span><span class=si>{</span><span class=n>parent_level</span><span class=si>}</span><span class=s2>_ucode&quot;</span><span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=n>boundary</span> <span class=o>=</span> <span class=n>AdminBoundary</span><span class=p>(</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>            <span class=nb>id</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ucode&quot;</span><span class=p>),</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>name</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>),</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=n>name_en</span><span class=o>=</span><span class=n>props</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name_en&quot;</span><span class=p>),</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=n>geometry</span><span class=o>=</span><span class=n>shapely_geom</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=n>parent_id</span><span class=o>=</span><span class=n>parent_id</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>            <span class=n>country_code</span><span class=o>=</span><span class=n>country_code</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=n>boundaries</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>boundary</span><span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=sa>f</span><span class=s2>&quot;Created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>boundaries</span><span class=p>)</span><span class=si>}</span><span class=s2> AdminBoundary objects from GeoRepo data.&quot;</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=c1># Try to infer country_code from first boundary if not set</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=k>if</span> <span class=n>boundaries</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>country_code</span><span class=p>:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>country_code</span> <span class=o>=</span> <span class=n>boundaries</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>boundaries</span><span class=o>=</span><span class=n>boundaries</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=n>admin_level</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.get_schema_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_schema_config</span><span class=p>()</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.get_schema_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return field mappings for different data sources</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=nd>@classmethod</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=k>def</span> <span class=nf>get_schema_config</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return field mappings for different data sources&quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_schema_config</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.boundaries.AdminBoundaries.to_geodataframe class="doc doc-heading"> <code class="highlight language-python"><span class=n>to_geodataframe</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.boundaries.AdminBoundaries.to_geodataframe class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Convert the AdminBoundaries to a GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert the AdminBoundaries to a GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundaries</span><span class=p>:</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;_empty_schema&quot;</span><span class=p>):</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>            <span class=n>columns</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_empty_schema</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>            <span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;country_code&quot;</span><span class=p>,</span> <span class=s2>&quot;geometry&quot;</span><span class=p>]</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>level</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                <span class=n>columns</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;parent_id&quot;</span><span class=p>)</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>        <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>columns</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span> <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>    <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>        <span class=p>[</span><span class=n>boundary</span><span class=o>.</span><span class=n>model_dump</span><span class=p>()</span> <span class=k>for</span> <span class=n>boundary</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundaries</span><span class=p>],</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>        <span class=n>geometry</span><span class=o>=</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>        <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>,</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.boundaries.AdminBoundary class="doc doc-heading"> <code>AdminBoundary</code> <a href=#gigaspatial.handlers.boundaries.AdminBoundary class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Base class for administrative boundary data with flexible fields.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/boundaries.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=k>class</span> <span class=nc>AdminBoundary</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Base class for administrative boundary data with flexible fields.&quot;&quot;&quot;</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Unique identifier for the administrative unit&quot;</span><span class=p>)</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Primary local name&quot;</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Polygon</span><span class=p>,</span> <span class=n>MultiPolygon</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>        <span class=o>...</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Geometry of the administrative boundary&quot;</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>name_en</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>        <span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;English name if different from local name&quot;</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>parent_id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>        <span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;ID of parent administrative unit&quot;</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=p>)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>country_code</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>        <span class=kc>None</span><span class=p>,</span> <span class=n>min_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;ISO 3166-1 alpha-3 country code&quot;</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=k>class</span> <span class=nc>Config</span><span class=p>:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>        <span class=c1># extra = &quot;allow&quot;</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>        <span class=n>arbitrary_types_allowed</span> <span class=o>=</span> <span class=kc>True</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.ghsl class="doc doc-heading"> <code>ghsl</code> <a href=#gigaspatial.handlers.ghsl class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.ghsl.CoordSystem class="doc doc-heading"> <code>CoordSystem</code> <a href=#gigaspatial.handlers.ghsl.CoordSystem class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code>int</code>, <code><span title="enum.Enum">Enum</span></code></p> <p>Enum for coordinate systems used by GHSL datasets.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=k>class</span> <span class=nc>CoordSystem</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Enum for coordinate systems used by GHSL datasets.&quot;&quot;&quot;</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=n>WGS84</span> <span class=o>=</span> <span class=mi>4326</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>Mollweide</span> <span class=o>=</span> <span class=mi>54009</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.ghsl.GHSLDataConfig class="doc doc-heading"> <code>GHSLDataConfig</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code></p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>ConfigDict</span><span class=p>(</span><span class=n>arbitrary_types_allowed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=k>class</span> <span class=nc>GHSLDataConfig</span><span class=p>(</span><span class=n>BaseHandlerConfig</span><span class=p>):</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=c1># constants</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=n>AVAILABLE_YEARS</span><span class=p>:</span> <span class=n>List</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1975</span><span class=p>,</span> <span class=mi>2031</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=mi>2018</span><span class=p>))</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=n>AVAILABLE_RESOLUTIONS</span><span class=p>:</span> <span class=n>List</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1000</span><span class=p>])</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=c1># base config</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=n>GHSL_DB_BASE_URL</span><span class=p>:</span> <span class=n>HttpUrl</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/GHSL/&quot;</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>    <span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=n>TILES_URL</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;https://ghsl.jrc.ec.europa.eu/download/GHSL_data_</span><span class=si>{}</span><span class=s2>_shapefile.zip&quot;</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=c1># user config</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;ghsl&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>))</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=n>coord_system</span><span class=p>:</span> <span class=n>CoordSystem</span> <span class=o>=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>WGS84</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>    <span class=n>release</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;R2023A&quot;</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=n>product</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=s2>&quot;GHS_BUILT_H_AGBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=s2>&quot;GHS_BUILT_H_ANBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=s2>&quot;GHS_BUILT_V&quot;</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=s2>&quot;GHS_POP&quot;</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>    <span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=n>year</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2020</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=n>resolution</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__post_init__</span><span class=p>()</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=bp>self</span><span class=o>.</span><span class=n>TILES_URL</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>TILES_URL</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_load_tiles</span><span class=p>()</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=k>def</span> <span class=nf>_load_tiles</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load GHSL tiles from tiles shapefile.&quot;&quot;&quot;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>TILES_URL</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to download tiles shapefile: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>                <span class=sa>f</span><span class=s2>&quot;Could not download GHSL tiles from </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>TILES_URL</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=p>)</span> <span class=kn>from</span> <span class=nn>e</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;year&quot;</span><span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>def</span> <span class=nf>validate_year</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=k>if</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>AVAILABLE_YEARS</span><span class=p>:</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=k>return</span> <span class=n>value</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=sa>f</span><span class=s2>&quot;No datasets found for the provided year: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=se>\n</span><span class=s2>Available years are: </span><span class=si>{</span><span class=bp>cls</span><span class=o>.</span><span class=n>AVAILABLE_YEARS</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;resolution&quot;</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>    <span class=k>def</span> <span class=nf>validate_resolution</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>if</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>AVAILABLE_RESOLUTIONS</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=k>return</span> <span class=n>value</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=sa>f</span><span class=s2>&quot;No datasets found for the provided resolution: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=se>\n</span><span class=s2>Available resolutions are: </span><span class=si>{</span><span class=bp>cls</span><span class=o>.</span><span class=n>AVAILABLE_RESOLUTIONS</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;after&quot;</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=k>def</span> <span class=nf>validate_configuration</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>        Validate that the configuration is valid based on dataset availability constraints.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>        Specific rules:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>        -</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>==</span> <span class=mi>2018</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;GHS_BUILT_V&quot;</span><span class=p>,</span> <span class=s2>&quot;GHS_POP&quot;</span><span class=p>,</span> <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>]:</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> product is not available for 2018&quot;</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>!=</span> <span class=s2>&quot;GHS_BUILT_H&quot;</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> product is not available at 10 (10m) resolution&quot;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=k>if</span> <span class=s2>&quot;GHS_BUILT_H&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=mi>2018</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                    <span class=s2>&quot;Building height product is only available for 2018, year is set as 2018&quot;</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                <span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=mi>2018</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>==</span> <span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>==</span> <span class=mi>2018</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                    <span class=s2>&quot;Built-up surface product for 2018 is only available at 10m resolution, resolution is set as 10m&quot;</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                <span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=mi>2018</span><span class=p>:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                    <span class=s2>&quot;Built-up surface product at resolution 10 is only available for 2018, year is set as 2018&quot;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=mi>2018</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>!=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                    <span class=sa>f</span><span class=s2>&quot;Built-up surface product at resolution 10 is only available with Mollweide (</span><span class=si>{</span><span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=si>}</span><span class=s2>) projection, coordinate system is set as Mollweide&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>==</span> <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=mi>1000</span><span class=p>:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                    <span class=sa>f</span><span class=s2>&quot;Settlement model (SMOD) product is only available at 1000 (1km) resolution, resolution is set as 1000&quot;</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                <span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>=</span> <span class=mi>1000</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>!=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                    <span class=sa>f</span><span class=s2>&quot;Settlement model (SMOD) product is only available with Mollweide (</span><span class=si>{</span><span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=si>}</span><span class=s2>) projection, coordinate system is set as Mollweide&quot;</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                <span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>        <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>    <span class=nd>@property</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>    <span class=k>def</span> <span class=nf>crs</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=k>return</span> <span class=s2>&quot;EPSG:4326&quot;</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>==</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>WGS84</span> <span class=k>else</span> <span class=s2>&quot;ESRI:54009&quot;</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>        Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><span class=sd>        Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unit</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>file_ext</span><span class=o>=</span><span class=s2>&quot;.zip&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Construct and return the path for the configured dataset or dataset tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_info</span><span class=p>()</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=n>tile_path</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=o>/</span> <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_folder&quot;</span><span class=p>]</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_0&quot;</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>                <span class=o>+</span> <span class=p>(</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>unit</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>unit</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>                <span class=o>+</span> <span class=n>file_ext</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>            <span class=p>)</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=p>)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=k>return</span> <span class=n>tile_path</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=k>def</span> <span class=nf>compute_dataset_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tile_id</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Compute the download URL for a GHSL dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_info</span><span class=p>()</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=n>path_segments</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GHSL_DB_BASE_URL</span><span class=p>),</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>            <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_folder&quot;</span><span class=p>],</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>            <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_name&quot;</span><span class=p>],</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>            <span class=sa>f</span><span class=s2>&quot;V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>-0&quot;</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>            <span class=s2>&quot;tiles&quot;</span> <span class=k>if</span> <span class=n>tile_id</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_0&quot;</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>            <span class=o>+</span> <span class=p>(</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>tile_id</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>            <span class=o>+</span> <span class=s2>&quot;.zip&quot;</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>        <span class=p>]</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>        <span class=k>return</span> <span class=s2>&quot;/&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path_segments</span><span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=k>def</span> <span class=nf>_get_relevant_tiles</span><span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>            <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>        <span class=p>],</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>        Identify and return the GHSL tiles that spatially intersect with the given geometry.</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>        The input geometry can be a Shapely geometry object, a GeoDataFrame,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>        or a list of Point objects or (lon, lat) tuples. The method ensures</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><span class=sd>        the input geometry is in GHSL tiles projection for the spatial intersection.</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>        Args:</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=sd>            source: A Shapely geometry, a GeoDataFrame, or a list of Point</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>                      objects or (lat, lon) tuples representing the area of interest.</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>        Returns:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>            A list the tile ids for the intersecting tiles.</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>        Raises:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>            ValueError: If the input `source` is not one of the supported types.</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>            <span class=k>if</span> <span class=n>source</span><span class=o>.</span><span class=n>crs</span> <span class=o>!=</span> <span class=s2>&quot;EPSG:4326&quot;</span><span class=p>:</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                <span class=n>source</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>unary_union</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>            <span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>            <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>        <span class=p>):</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>source</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>            <span class=nb>len</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>pt</span><span class=p>,</span> <span class=n>Point</span><span class=p>)</span> <span class=k>for</span> <span class=n>pt</span> <span class=ow>in</span> <span class=n>source</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>        <span class=p>):</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>            <span class=n>points</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>                <span class=n>pt</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>pt</span><span class=p>,</span> <span class=n>Point</span><span class=p>)</span> <span class=k>else</span> <span class=n>Point</span><span class=p>(</span><span class=n>pt</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>pt</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=k>for</span> <span class=n>pt</span> <span class=ow>in</span> <span class=n>source</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=p>]</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>MultiPoint</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>                <span class=sa>f</span><span class=s2>&quot;Expected Geometry, GeoDataFrame or iterable object of Points got </span><span class=si>{</span><span class=n>source</span><span class=o>.</span><span class=vm>__class__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>            <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>crs</span> <span class=o>!=</span> <span class=n>crs</span><span class=p>:</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>                <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span><span class=n>geometry</span><span class=o>=</span><span class=p>[</span><span class=n>search_geom</span><span class=p>],</span> <span class=n>crs</span><span class=o>=</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>                <span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>                <span class=o>.</span><span class=n>geometry</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>            <span class=p>)</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=c1># Find intersecting tiles</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>            <span class=n>tile_geom</span><span class=o>.</span><span class=n>intersects</span><span class=p>(</span><span class=n>search_geom</span><span class=p>)</span> <span class=k>for</span> <span class=n>tile_geom</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=p>)</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>mask</span><span class=p>,</span> <span class=s2>&quot;tile_id&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>to_list</span><span class=p>()</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>    <span class=k>def</span> <span class=nf>_get_product_info</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Generate and return common product information used in multiple methods.&quot;&quot;&quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=n>resolution_str</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>            <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>resolution</span><span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>==</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>            <span class=k>else</span> <span class=p>(</span><span class=s2>&quot;3ss&quot;</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>100</span> <span class=k>else</span> <span class=s2>&quot;30ss&quot;</span><span class=p>)</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=n>product_folder</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2>_GLOBE_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>        <span class=n>product_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2>_E</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>_GLOBE_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>resolution_str</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=n>product_version</span> <span class=o>=</span> <span class=mi>2</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>==</span> <span class=s2>&quot;GHS_SMOD&quot;</span> <span class=k>else</span> <span class=mi>1</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>            <span class=s2>&quot;resolution_str&quot;</span><span class=p>:</span> <span class=n>resolution_str</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>            <span class=s2>&quot;product_folder&quot;</span><span class=p>:</span> <span class=n>product_folder</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>            <span class=s2>&quot;product_name&quot;</span><span class=p>:</span> <span class=n>product_name</span><span class=p>,</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>            <span class=s2>&quot;product_version&quot;</span><span class=p>:</span> <span class=n>product_version</span><span class=p>,</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>        <span class=p>}</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Return a string representation of the GHSL dataset configuration.&quot;&quot;&quot;</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>            <span class=sa>f</span><span class=s2>&quot;GHSLDataConfig(&quot;</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>            <span class=sa>f</span><span class=s2>&quot;product=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2>&#39;, &quot;</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>            <span class=sa>f</span><span class=s2>&quot;year=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>            <span class=sa>f</span><span class=s2>&quot;resolution=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>resolution</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>            <span class=sa>f</span><span class=s2>&quot;coord_system=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>            <span class=sa>f</span><span class=s2>&quot;release=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>            <span class=sa>f</span><span class=s2>&quot;)&quot;</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.__repr__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__repr__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.__repr__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return a string representation of the GHSL dataset configuration.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a string representation of the GHSL dataset configuration.&quot;&quot;&quot;</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>        <span class=sa>f</span><span class=s2>&quot;GHSLDataConfig(&quot;</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>        <span class=sa>f</span><span class=s2>&quot;product=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2>&#39;, &quot;</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>        <span class=sa>f</span><span class=s2>&quot;year=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>        <span class=sa>f</span><span class=s2>&quot;resolution=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>resolution</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>        <span class=sa>f</span><span class=s2>&quot;coord_system=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>        <span class=sa>f</span><span class=s2>&quot;release=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>        <span class=sa>f</span><span class=s2>&quot;)&quot;</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.compute_dataset_url class="doc doc-heading"> <code class="highlight language-python"><span class=n>compute_dataset_url</span><span class=p>(</span><span class=n>tile_id</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.compute_dataset_url class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Compute the download URL for a GHSL dataset.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=k>def</span> <span class=nf>compute_dataset_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tile_id</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the download URL for a GHSL dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>    <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_info</span><span class=p>()</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=n>path_segments</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>GHSL_DB_BASE_URL</span><span class=p>),</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>        <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_folder&quot;</span><span class=p>],</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_name&quot;</span><span class=p>],</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=sa>f</span><span class=s2>&quot;V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>-0&quot;</span><span class=p>,</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>        <span class=s2>&quot;tiles&quot;</span> <span class=k>if</span> <span class=n>tile_id</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_0&quot;</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=o>+</span> <span class=p>(</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>tile_id</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=o>+</span> <span class=s2>&quot;.zip&quot;</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=p>]</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=k>return</span> <span class=s2>&quot;/&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path_segments</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.get_data_unit_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>unit</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>file_ext</span><span class=o>=</span><span class=s1>&#39;.zip&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.get_data_unit_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Construct and return the path for the configured dataset or dataset tile.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unit</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>file_ext</span><span class=o>=</span><span class=s2>&quot;.zip&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Construct and return the path for the configured dataset or dataset tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>    <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_product_info</span><span class=p>()</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>    <span class=n>tile_path</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=o>/</span> <span class=n>info</span><span class=p>[</span><span class=s2>&quot;product_folder&quot;</span><span class=p>]</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=o>/</span> <span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_V</span><span class=si>{</span><span class=n>info</span><span class=p>[</span><span class=s1>&#39;product_version&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>_0&quot;</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=o>+</span> <span class=p>(</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>unit</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>unit</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=o>+</span> <span class=n>file_ext</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=p>)</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=p>)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=k>return</span> <span class=n>tile_path</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.get_relevant_data_units_by_geometry class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.get_relevant_data_units_by_geometry class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a given geometry or GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>    Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.get_relevant_data_units_by_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.get_relevant_data_units_by_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a list of points.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><span class=sd>    Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataConfig.validate_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_configuration</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataConfig.validate_configuration class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Validate that the configuration is valid based on dataset availability constraints.</p> <h6 id=gigaspatial.handlers.ghsl.GHSLDataConfig.validate_configuration--specific-rules>Specific rules:<a class=headerlink href=#gigaspatial.handlers.ghsl.GHSLDataConfig.validate_configuration--specific-rules title="Permanent link">&para;</a></h6> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;after&quot;</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=k>def</span> <span class=nf>validate_configuration</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    Validate that the configuration is valid based on dataset availability constraints.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    Specific rules:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>    -</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>==</span> <span class=mi>2018</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;GHS_BUILT_V&quot;</span><span class=p>,</span> <span class=s2>&quot;GHS_POP&quot;</span><span class=p>,</span> <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>]:</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> product is not available for 2018&quot;</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>!=</span> <span class=s2>&quot;GHS_BUILT_H&quot;</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> product is not available at 10 (10m) resolution&quot;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=k>if</span> <span class=s2>&quot;GHS_BUILT_H&quot;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=mi>2018</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                <span class=s2>&quot;Building height product is only available for 2018, year is set as 2018&quot;</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=p>)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>            <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=mi>2018</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>==</span> <span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>==</span> <span class=mi>2018</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                <span class=s2>&quot;Built-up surface product for 2018 is only available at 10m resolution, resolution is set as 10m&quot;</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>            <span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=mi>2018</span><span class=p>:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=s2>&quot;Built-up surface product at resolution 10 is only available for 2018, year is set as 2018&quot;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=mi>2018</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=mi>10</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>!=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                <span class=sa>f</span><span class=s2>&quot;Built-up surface product at resolution 10 is only available with Mollweide (</span><span class=si>{</span><span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=si>}</span><span class=s2>) projection, coordinate system is set as Mollweide&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>product</span> <span class=o>==</span> <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=mi>1000</span><span class=p>:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                <span class=sa>f</span><span class=s2>&quot;Settlement model (SMOD) product is only available at 1000 (1km) resolution, resolution is set as 1000&quot;</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>            <span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>=</span> <span class=mi>1000</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>!=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                <span class=sa>f</span><span class=s2>&quot;Settlement model (SMOD) product is only available with Mollweide (</span><span class=si>{</span><span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span><span class=si>}</span><span class=s2>) projection, coordinate system is set as Mollweide&quot;</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>            <span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>            <span class=bp>self</span><span class=o>.</span><span class=n>coord_system</span> <span class=o>=</span> <span class=n>CoordSystem</span><span class=o>.</span><span class=n>Mollweide</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>    <span class=k>return</span> <span class=bp>self</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.ghsl.GHSLDataDownloader class="doc doc-heading"> <code>GHSLDataDownloader</code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerDownloader" href="#gigaspatial.handlers.base.BaseHandlerDownloader">BaseHandlerDownloader</a></code></p> <p>A class to handle downloads of GHSL datasets.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=k>class</span> <span class=nc>GHSLDataDownloader</span><span class=p>(</span><span class=n>BaseHandlerDownloader</span><span class=p>):</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;A class to handle downloads of GHSL datasets.&quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=p>):</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=sd>        Initialize the downloader.</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><span class=sd>        Args:</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>            config: Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>            data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>            logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>        <span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>            <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>GHSLDataConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>GHSLDataConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>        <span class=p>)</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>    <span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>        <span class=n>tile_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>        <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>        <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>        Downloads and optionally extracts files for a given tile.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>        Args:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>            tile_id: tile ID to process.</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>            extract: If True and the downloaded file is a zip, extract its contents. Defaults to False.</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>            file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>            **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>        Returns:</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>            Path to the downloaded file if extract=False,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>            List of paths to the extracted files if extract=True,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>            None on failure.</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>        <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>compute_dataset_url</span><span class=p>(</span><span class=n>tile_id</span><span class=o>=</span><span class=n>tile_id</span><span class=p>)</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>        <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>tile_id</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>extract</span><span class=p>:</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_file</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_path</span><span class=p>)</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>        <span class=n>extracted_files</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>            <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s2>&quot;.zip&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>temp_file</span><span class=p>:</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>                <span class=n>downloaded_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_file</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>Path</span><span class=p>(</span><span class=n>temp_file</span><span class=o>.</span><span class=n>name</span><span class=p>))</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>                <span class=k>if</span> <span class=ow>not</span> <span class=n>downloaded_path</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>                    <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>            <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>downloaded_path</span><span class=p>),</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>zip_ref</span><span class=p>:</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>                <span class=k>if</span> <span class=n>file_pattern</span><span class=p>:</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>                    <span class=kn>import</span> <span class=nn>re</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>                    <span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>file_pattern</span><span class=p>)</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>                    <span class=n>files_to_extract</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>                        <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span> <span class=k>if</span> <span class=n>pattern</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>                    <span class=p>]</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>                    <span class=n>files_to_extract</span> <span class=o>=</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>                <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files_to_extract</span><span class=p>:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>                    <span class=n>extracted_path</span> <span class=o>=</span> <span class=n>output_path</span><span class=o>.</span><span class=n>parent</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>                    <span class=k>with</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file</span><span class=p>)</span> <span class=k>as</span> <span class=n>source</span><span class=p>:</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>                        <span class=n>file_content</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>extracted_path</span><span class=p>),</span> <span class=n>file_content</span><span class=p>)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>                    <span class=n>extracted_files</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>extracted_path</span><span class=p>)</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Extracted </span><span class=si>{</span><span class=n>file</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>extracted_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>            <span class=n>Path</span><span class=p>(</span><span class=n>temp_file</span><span class=o>.</span><span class=n>name</span><span class=p>)</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>            <span class=k>return</span> <span class=n>extracted_files</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading/extracting tile </span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>    <span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>        <span class=n>tile_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>        <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>        <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>        Downloads multiple tiles in parallel, with an option to extract them.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>        Args:</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>            tile_ids: A list of tile IDs to download.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>            file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>            **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>        Returns:</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>            A list where each element corresponds to a tile ID and contains:</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>            - Path to the downloaded file if extract=False.</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>            - List of paths to extracted files if extract=True.</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>            - None if the download or extraction failed for a tile.</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>tile_ids</span><span class=p>:</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No tiles to download&quot;</span><span class=p>)</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=n>processes</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>            <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>                <span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>            <span class=p>)</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>            <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>                <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>                    <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span><span class=n>download_func</span><span class=p>,</span> <span class=n>tile_ids</span><span class=p>),</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>                    <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tile_ids</span><span class=p>),</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>                    <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading data&quot;</span><span class=p>,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>                <span class=p>)</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>            <span class=p>)</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>        <span class=k>return</span> <span class=n>file_paths</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>    <span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>        <span class=p>],</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>        <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=sd>        Download GHSL data for a specified geographic region.</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><span class=sd>        The region can be defined by a country code/name, a list of points,</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><span class=sd>        a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><span class=sd>        relevant GHSL tiles intersecting the region and downloads the</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><span class=sd>        specified type of data (polygons or points) for those tiles in parallel.</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><span class=sd>        Args:</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=sd>            source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><span class=sd>                    Can be:</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><span class=sd>                      - A string representing a country code or name.</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><span class=sd>                      - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=sd>                      - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>                      - A GeoDataFrame with geometry column in EPSG:4326.</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><span class=sd>            extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>            file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>            **kwargs: Additional keyword arguments. These will be passed down to</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>                      `AdminBoundaries.create()` (if `source` is a country)</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>                      and to `self.download_data_units()`.</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>        Returns:</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>            A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><span class=sd>            Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><span class=sd>            all downloads fail.</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>            <span class=n>tiles</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>        <span class=p>)</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>    <span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>        <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>        <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>        <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=sd>        Download GHSL data for a specific country.</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a><span class=sd>        This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=sd>        using its code or name.</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a><span class=sd>        Args:</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=sd>            country_code: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>            data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=sd>                        `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a><span class=sd>                        `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>            country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>                               country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>                               instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=sd>            extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>            file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>            **kwargs: Additional keyword arguments that are passed to</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>                      `download_data_units`. For example, `extract` to download and extract.</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>        Returns:</span>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>            A list of local file paths for the successfully downloaded tiles</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>            for the specified country.</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>            <span class=n>source</span><span class=o>=</span><span class=n>country_code</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>            <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>            <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span><span class=p>,</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a>            <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>            <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span><span class=p>,</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a>        <span class=p>)</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a>    <span class=k>def</span> <span class=nf>_download_file</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>url</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]:</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a><span class=sd>        Downloads a file from a URL to a specified output path with a progress bar.</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>        Args:</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=sd>            url: The URL to download from.</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>            output_path: The local path to save the downloaded file.</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>        Returns:</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>            The path to the downloaded file on success, None on failure.</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a>            <span class=n>total_size</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content-length&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>                <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>                    <span class=n>total</span><span class=o>=</span><span class=n>total_size</span><span class=p>,</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>                    <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;B&quot;</span><span class=p>,</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>                    <span class=n>unit_scale</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>                    <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>output_path</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>                <span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>                    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>                        <span class=k>if</span> <span class=n>chunk</span><span class=p>:</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>                            <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>                            <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>))</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully downloaded: </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>            <span class=k>return</span> <span class=n>output_path</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to download </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a>            <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a>, dict[str, <span title="typing.Union">Union</span>[str, int]]]</code> </td> <td> <div class=doc-md-description> <p>Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional data storage interface. If not provided, uses LocalDataStore.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional custom logger. If not provided, uses default logger.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><span class=p>):</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=sd>    Initialize the downloader.</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><span class=sd>    Args:</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>        config: Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>        data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>        logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>    <span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>        <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>GHSLDataConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>GHSLDataConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>    <span class=p>)</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataDownloader.download class="doc doc-heading"> <code class="highlight language-python"><span class=n>download</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=s1>&#39;.*</span><span class=se>\\</span><span class=s1>.tif$&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader.download class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download GHSL data for a specified geographic region.</p> <p>The region can be defined by a country code/name, a list of points, a Shapely geometry, or a GeoDataFrame. This method identifies the relevant GHSL tiles intersecting the region and downloads the specified type of data (polygons or points) for those tiles in parallel.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[float, float], <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>Defines the geographic area for which to download data. Can be: - A string representing a country code or name. - A list of (latitude, longitude) tuples or Shapely Point objects. - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon). - A GeoDataFrame with geometry column in EPSG:4326.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>extract</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True and the downloaded files are zips, extract their contents. Defaults to False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>file_pattern</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Optional regex pattern to filter extracted files (if extract=True).</p> </div> </td> <td> <code>&#39;.*\\.tif$&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments. These will be passed down to <code>AdminBoundaries.create()</code> (if <code>source</code> is a country) and to <code>self.download_data_units()</code>.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>Returns an empty list if no data is found for the region or if</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>all downloads fail.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>    <span class=p>],</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>    <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>    <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=sd>    Download GHSL data for a specified geographic region.</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a><span class=sd>    The region can be defined by a country code/name, a list of points,</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><span class=sd>    a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><span class=sd>    relevant GHSL tiles intersecting the region and downloads the</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><span class=sd>    specified type of data (polygons or points) for those tiles in parallel.</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><span class=sd>    Args:</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=sd>        source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><span class=sd>                Can be:</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><span class=sd>                  - A string representing a country code or name.</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><span class=sd>                  - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=sd>                  - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>                  - A GeoDataFrame with geometry column in EPSG:4326.</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><span class=sd>        extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>        file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>        **kwargs: Additional keyword arguments. These will be passed down to</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>                  `AdminBoundaries.create()` (if `source` is a country)</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>                  and to `self.download_data_units()`.</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>    Returns:</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>        A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><span class=sd>        Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><span class=sd>        all downloads fail.</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>    <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=n>tiles</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataDownloader.download_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_by_country</span><span class=p>(</span><span class=n>country_code</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>country_geom_path</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=s1>&#39;.*</span><span class=se>\\</span><span class=s1>.tif$&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader.download_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download GHSL data for a specific country.</p> <p>This is a convenience method to download data for an entire country using its code or name.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>country_code</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The country code (e.g., 'USA', 'GBR') or name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional instance of a <code>DataStore</code> to be used by <code>AdminBoundaries</code> for loading country boundaries. If None, <code>AdminBoundaries</code> will use its default data loading.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>country_geom_path</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]</code> </td> <td> <div class=doc-md-description> <p>Optional path to a GeoJSON file containing the country boundary. If provided, this boundary is used instead of the default from <code>AdminBoundaries</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>extract</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True and the downloaded files are zips, extract their contents. Defaults to False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>file_pattern</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Optional regex pattern to filter extracted files (if extract=True).</p> </div> </td> <td> <code>&#39;.*\\.tif$&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments that are passed to <code>download_data_units</code>. For example, <code>extract</code> to download and extract.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>for the specified country.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a><span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>    <span class=n>country_code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>    <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>    <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>    <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=sd>    Download GHSL data for a specific country.</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a><span class=sd>    This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=sd>    using its code or name.</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a><span class=sd>    Args:</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=sd>        country_code: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>        data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=sd>                    `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a><span class=sd>                    `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>        country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>                           country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>                           instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=sd>        extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>        file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>        **kwargs: Additional keyword arguments that are passed to</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>                  `download_data_units`. For example, `extract` to download and extract.</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>    Returns:</span>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>        A list of local file paths for the successfully downloaded tiles</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>        for the specified country.</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>        <span class=n>source</span><span class=o>=</span><span class=n>country_code</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>        <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>        <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span><span class=p>,</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a>        <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>        <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span><span class=p>,</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataDownloader.download_data_unit class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_unit</span><span class=p>(</span><span class=n>tile_id</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=s1>&#39;.*</span><span class=se>\\</span><span class=s1>.tif$&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader.download_data_unit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Downloads and optionally extracts files for a given tile.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tile_id</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>tile ID to process.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>extract</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True and the downloaded file is a zip, extract its contents. Defaults to False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>file_pattern</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Optional regex pattern to filter extracted files (if extract=True).</p> </div> </td> <td> <code>&#39;.*\\.tif$&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to download methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>Path to the downloaded file if extract=False,</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>List of paths to the extracted files if extract=True,</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>None on failure.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>    <span class=n>tile_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>    <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>    <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>    Downloads and optionally extracts files for a given tile.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>    Args:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        tile_id: tile ID to process.</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>        extract: If True and the downloaded file is a zip, extract its contents. Defaults to False.</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>        file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>        **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>    Returns:</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>        Path to the downloaded file if extract=False,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>        List of paths to the extracted files if extract=True,</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>        None on failure.</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>    <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>compute_dataset_url</span><span class=p>(</span><span class=n>tile_id</span><span class=o>=</span><span class=n>tile_id</span><span class=p>)</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>tile_id</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>extract</span><span class=p>:</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_file</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_path</span><span class=p>)</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>    <span class=n>extracted_files</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>        <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s2>&quot;.zip&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>temp_file</span><span class=p>:</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>            <span class=n>downloaded_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_file</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>Path</span><span class=p>(</span><span class=n>temp_file</span><span class=o>.</span><span class=n>name</span><span class=p>))</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>downloaded_path</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>                <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>        <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>downloaded_path</span><span class=p>),</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>zip_ref</span><span class=p>:</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=k>if</span> <span class=n>file_pattern</span><span class=p>:</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>                <span class=kn>import</span> <span class=nn>re</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>                <span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>file_pattern</span><span class=p>)</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>                <span class=n>files_to_extract</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>                    <span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span> <span class=k>if</span> <span class=n>pattern</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>                <span class=p>]</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>                <span class=n>files_to_extract</span> <span class=o>=</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>            <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files_to_extract</span><span class=p>:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>                <span class=n>extracted_path</span> <span class=o>=</span> <span class=n>output_path</span><span class=o>.</span><span class=n>parent</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>                <span class=k>with</span> <span class=n>zip_ref</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file</span><span class=p>)</span> <span class=k>as</span> <span class=n>source</span><span class=p>:</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>                    <span class=n>file_content</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>extracted_path</span><span class=p>),</span> <span class=n>file_content</span><span class=p>)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>                <span class=n>extracted_files</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>extracted_path</span><span class=p>)</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Extracted </span><span class=si>{</span><span class=n>file</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>extracted_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=n>Path</span><span class=p>(</span><span class=n>temp_file</span><span class=o>.</span><span class=n>name</span><span class=p>)</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=k>return</span> <span class=n>extracted_files</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading/extracting tile </span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataDownloader.download_data_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_units</span><span class=p>(</span><span class=n>tile_ids</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=s1>&#39;.*</span><span class=se>\\</span><span class=s1>.tif$&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataDownloader.download_data_units class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Downloads multiple tiles in parallel, with an option to extract them.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tile_ids</code></td> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>A list of tile IDs to download.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>extract</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True and the downloaded files are zips, extract their contents. Defaults to False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>file_pattern</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Optional regex pattern to filter extracted files (if extract=True).</p> </div> </td> <td> <code>&#39;.*\\.tif$&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to download methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>A list where each element corresponds to a tile ID and contains:</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <ul> <li>Path to the downloaded file if extract=False.</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <ul> <li>List of paths to extracted files if extract=True.</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]]]</code> </td> <td> <div class=doc-md-description> <ul> <li>None if the download or extraction failed for a tile.</li> </ul> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>    <span class=n>tile_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>    <span class=n>extract</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>    <span class=n>file_pattern</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]]]]:</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>    Downloads multiple tiles in parallel, with an option to extract them.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>    Args:</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>        tile_ids: A list of tile IDs to download.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        extract: If True and the downloaded files are zips, extract their contents. Defaults to False.</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>        file_pattern: Optional regex pattern to filter extracted files (if extract=True).</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>        **kwargs: Additional parameters passed to download methods</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>    Returns:</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>        A list where each element corresponds to a tile ID and contains:</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>        - Path to the downloaded file if extract=False.</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>        - List of paths to extracted files if extract=True.</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>        - None if the download or extraction failed for a tile.</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>tile_ids</span><span class=p>:</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No tiles to download&quot;</span><span class=p>)</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>    <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=n>processes</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>            <span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>,</span> <span class=n>extract</span><span class=o>=</span><span class=n>extract</span><span class=p>,</span> <span class=n>file_pattern</span><span class=o>=</span><span class=n>file_pattern</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>        <span class=p>)</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>            <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>                <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span><span class=n>download_func</span><span class=p>,</span> <span class=n>tile_ids</span><span class=p>),</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>                <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tile_ids</span><span class=p>),</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>                <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading data&quot;</span><span class=p>,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>            <span class=p>)</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>        <span class=p>)</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>    <span class=k>return</span> <span class=n>file_paths</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.ghsl.GHSLDataHandler class="doc doc-heading"> <code>GHSLDataHandler</code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandler" href="#gigaspatial.handlers.base.BaseHandler">BaseHandler</a></code></p> <p>Handler for GHSL (Global Human Settlement Layer) dataset.</p> <p>This class provides a unified interface for downloading and loading GHSL data. It manages the lifecycle of configuration, downloading, and reading components.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a><span class=k>class</span> <span class=nc>GHSLDataHandler</span><span class=p>(</span><span class=n>BaseHandler</span><span class=p>):</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a><span class=sd>    Handler for GHSL (Global Human Settlement Layer) dataset.</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a><span class=sd>    This class provides a unified interface for downloading and loading GHSL data.</span>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a><span class=sd>    It manages the lifecycle of configuration, downloading, and reading components.</span>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>        <span class=n>product</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>            <span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>            <span class=s2>&quot;GHS_BUILT_H_AGBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>            <span class=s2>&quot;GHS_BUILT_H_ANBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>            <span class=s2>&quot;GHS_BUILT_V&quot;</span><span class=p>,</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>            <span class=s2>&quot;GHS_POP&quot;</span><span class=p>,</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>            <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>        <span class=p>],</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a>        <span class=n>year</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>        <span class=n>resolution</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a>        <span class=n>downloader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataDownloader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>        <span class=n>reader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataReader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a>    <span class=p>):</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a><span class=sd>        Initialize the GHSLDataHandler.</span>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a><span class=sd>        Args:</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a><span class=sd>            product: The GHSL product to use. Must be one of:</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a><span class=sd>                    - GHS_BUILT_S: Built-up surface</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a><span class=sd>                    - GHS_BUILT_H_AGBH: Average building height</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a><span class=sd>                    - GHS_BUILT_H_ANBH: Average number of building heights</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a><span class=sd>                    - GHS_BUILT_V: Building volume</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a><span class=sd>                    - GHS_POP: Population</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a><span class=sd>                    - GHS_SMOD: Settlement model</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a><span class=sd>            year: The year of the data (default: 2020)</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a><span class=sd>            resolution: The resolution in meters (default: 100)</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a><span class=sd>            config: Optional configuration object</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a><span class=sd>            downloader: Optional downloader instance</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a><span class=sd>            reader: Optional reader instance</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a><span class=sd>            data_store: Optional data store instance</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a><span class=sd>            logger: Optional logger instance</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a><span class=sd>            **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_product</span> <span class=o>=</span> <span class=n>product</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_year</span> <span class=o>=</span> <span class=n>year</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_resolution</span> <span class=o>=</span> <span class=n>resolution</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>            <span class=n>downloader</span><span class=o>=</span><span class=n>downloader</span><span class=p>,</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>            <span class=n>reader</span><span class=o>=</span><span class=n>reader</span><span class=p>,</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>            <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>            <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>        <span class=p>)</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>    <span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataConfig</span><span class=p>:</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a><span class=sd>        Create and return a GHSLDataConfig instance.</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a><span class=sd>        Args:</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a><span class=sd>            **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a><span class=sd>        Returns:</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a><span class=sd>            Configured GHSLDataConfig instance</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>        <span class=k>return</span> <span class=n>GHSLDataConfig</span><span class=p>(</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>            <span class=n>product</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_product</span><span class=p>,</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a>            <span class=n>year</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_year</span><span class=p>,</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>            <span class=n>resolution</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_resolution</span><span class=p>,</span>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>            <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a>            <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a>        <span class=p>)</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a>    <span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a>        <span class=n>config</span><span class=p>:</span> <span class=n>GHSLDataConfig</span><span class=p>,</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataDownloader</span><span class=p>:</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a><span class=sd>        Create and return a GHSLDataDownloader instance.</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a><span class=sd>        Args:</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a><span class=sd>            **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a><span class=sd>        Returns:</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a><span class=sd>            Configured GHSLDataDownloader instance</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a>        <span class=k>return</span> <span class=n>GHSLDataDownloader</span><span class=p>(</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a>        <span class=p>)</span>
</span><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a>    <span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a>        <span class=n>config</span><span class=p>:</span> <span class=n>GHSLDataConfig</span><span class=p>,</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataReader</span><span class=p>:</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a><span class=sd>        Create and return a GHSLDataReader instance.</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a><span class=sd>        Args:</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a><span class=sd>            **kwargs: Additional reader parameters</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a><span class=sd>        Returns:</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a><span class=sd>            Configured GHSLDataReader instance</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>        <span class=k>return</span> <span class=n>GHSLDataReader</span><span class=p>(</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>        <span class=p>)</span>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a>    <span class=k>def</span> <span class=nf>load_data</span><span class=p>(</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a>        <span class=p>],</span>
</span><span id=__span-0-730><a id=__codelineno-0-730 name=__codelineno-0-730></a>        <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-731><a id=__codelineno-0-731 name=__codelineno-0-731></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a>    <span class=p>):</span>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a>            <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a>            <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span>
</span><span id=__span-0-736><a id=__codelineno-0-736 name=__codelineno-0-736></a>            <span class=n>file_ext</span><span class=o>=</span><span class=s2>&quot;.tif&quot;</span><span class=p>,</span>
</span><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a>            <span class=n>extract</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a>            <span class=n>file_pattern</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;.*\.tif$&quot;</span><span class=p>,</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a>        <span class=p>)</span>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a>    <span class=k>def</span> <span class=nf>load_into_dataframe</span><span class=p>(</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a>        <span class=p>],</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>        <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a><span class=sd>        Load GHSL data into a pandas DataFrame.</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a><span class=sd>        Args:</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a><span class=sd>            ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a><span class=sd>            **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-762><a id=__codelineno-0-762 name=__codelineno-0-762></a>
</span><span id=__span-0-763><a id=__codelineno-0-763 name=__codelineno-0-763></a><span class=sd>        Returns:</span>
</span><span id=__span-0-764><a id=__codelineno-0-764 name=__codelineno-0-764></a><span class=sd>            DataFrame containing the GHSL data</span>
</span><span id=__span-0-765><a id=__codelineno-0-765 name=__codelineno-0-765></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-766><a id=__codelineno-0-766 name=__codelineno-0-766></a>        <span class=n>tif_processors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-767><a id=__codelineno-0-767 name=__codelineno-0-767></a>            <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-768><a id=__codelineno-0-768 name=__codelineno-0-768></a>        <span class=p>)</span>
</span><span id=__span-0-769><a id=__codelineno-0-769 name=__codelineno-0-769></a>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
</span><span id=__span-0-770><a id=__codelineno-0-770 name=__codelineno-0-770></a>            <span class=p>[</span><span class=n>tp</span><span class=o>.</span><span class=n>to_dataframe</span><span class=p>()</span> <span class=k>for</span> <span class=n>tp</span> <span class=ow>in</span> <span class=n>tif_processors</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-771><a id=__codelineno-0-771 name=__codelineno-0-771></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataHandler.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span> <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>downloader</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>reader</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the GHSLDataHandler.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>product</code></td> <td> <code><span title="typing.Literal">Literal</span>[&#39;GHS_BUILT_S&#39;, &#39;GHS_BUILT_H_AGBH&#39;, &#39;GHS_BUILT_H_ANBH&#39;, &#39;GHS_BUILT_V&#39;, &#39;GHS_POP&#39;, &#39;GHS_SMOD&#39;]</code> </td> <td> <div class=doc-md-description> <p>The GHSL product to use. Must be one of: - GHS_BUILT_S: Built-up surface - GHS_BUILT_H_AGBH: Average building height - GHS_BUILT_H_ANBH: Average number of building heights - GHS_BUILT_V: Building volume - GHS_POP: Population - GHS_SMOD: Settlement model</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>year</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The year of the data (default: 2020)</p> </div> </td> <td> <code>2020</code> </td> </tr> <tr class=doc-section-item> <td><code>resolution</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The resolution in meters (default: 100)</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional configuration object</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>downloader</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataDownloader" href="#gigaspatial.handlers.ghsl.GHSLDataDownloader">GHSLDataDownloader</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional downloader instance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>reader</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataReader" href="#gigaspatial.handlers.ghsl.GHSLDataReader">GHSLDataReader</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional reader instance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional data store instance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional logger instance</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional configuration parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>    <span class=n>product</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>        <span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>        <span class=s2>&quot;GHS_BUILT_H_AGBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>        <span class=s2>&quot;GHS_BUILT_H_ANBH&quot;</span><span class=p>,</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>        <span class=s2>&quot;GHS_BUILT_V&quot;</span><span class=p>,</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>        <span class=s2>&quot;GHS_POP&quot;</span><span class=p>,</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>        <span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>    <span class=p>],</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a>    <span class=n>year</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>    <span class=n>resolution</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a>    <span class=n>downloader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataDownloader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>    <span class=n>reader</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GHSLDataReader</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a><span class=p>):</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a><span class=sd>    Initialize the GHSLDataHandler.</span>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a><span class=sd>    Args:</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a><span class=sd>        product: The GHSL product to use. Must be one of:</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a><span class=sd>                - GHS_BUILT_S: Built-up surface</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a><span class=sd>                - GHS_BUILT_H_AGBH: Average building height</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a><span class=sd>                - GHS_BUILT_H_ANBH: Average number of building heights</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a><span class=sd>                - GHS_BUILT_V: Building volume</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a><span class=sd>                - GHS_POP: Population</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a><span class=sd>                - GHS_SMOD: Settlement model</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a><span class=sd>        year: The year of the data (default: 2020)</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a><span class=sd>        resolution: The resolution in meters (default: 100)</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a><span class=sd>        config: Optional configuration object</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a><span class=sd>        downloader: Optional downloader instance</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a><span class=sd>        reader: Optional reader instance</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a><span class=sd>        data_store: Optional data store instance</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a><span class=sd>        logger: Optional logger instance</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a><span class=sd>        **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_product</span> <span class=o>=</span> <span class=n>product</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_year</span> <span class=o>=</span> <span class=n>year</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_resolution</span> <span class=o>=</span> <span class=n>resolution</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>        <span class=n>downloader</span><span class=o>=</span><span class=n>downloader</span><span class=p>,</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>        <span class=n>reader</span><span class=o>=</span><span class=n>reader</span><span class=p>,</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>        <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>        <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataHandler.create_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_config</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler.create_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GHSLDataConfig instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional configuration parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configured GHSLDataConfig instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a><span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataConfig</span><span class=p>:</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a><span class=sd>    Create and return a GHSLDataConfig instance.</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a><span class=sd>    Args:</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a><span class=sd>        **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a><span class=sd>    Returns:</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a><span class=sd>        Configured GHSLDataConfig instance</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>    <span class=k>return</span> <span class=n>GHSLDataConfig</span><span class=p>(</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>        <span class=n>product</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_product</span><span class=p>,</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a>        <span class=n>year</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_year</span><span class=p>,</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>        <span class=n>resolution</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_resolution</span><span class=p>,</span>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>        <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a>        <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataHandler.create_downloader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_downloader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler.create_downloader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GHSLDataDownloader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional downloader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataDownloader" href="#gigaspatial.handlers.ghsl.GHSLDataDownloader">GHSLDataDownloader</a></code> </td> <td> <div class=doc-md-description> <p>Configured GHSLDataDownloader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a><span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a>    <span class=n>config</span><span class=p>:</span> <span class=n>GHSLDataConfig</span><span class=p>,</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataDownloader</span><span class=p>:</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a><span class=sd>    Create and return a GHSLDataDownloader instance.</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a><span class=sd>    Args:</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a><span class=sd>        **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a><span class=sd>    Returns:</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a><span class=sd>        Configured GHSLDataDownloader instance</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a>    <span class=k>return</span> <span class=n>GHSLDataDownloader</span><span class=p>(</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataHandler.create_reader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_reader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler.create_reader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GHSLDataReader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional reader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataReader" href="#gigaspatial.handlers.ghsl.GHSLDataReader">GHSLDataReader</a></code> </td> <td> <div class=doc-md-description> <p>Configured GHSLDataReader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a><span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a>    <span class=n>config</span><span class=p>:</span> <span class=n>GHSLDataConfig</span><span class=p>,</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GHSLDataReader</span><span class=p>:</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a><span class=sd>    Create and return a GHSLDataReader instance.</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a><span class=sd>    Args:</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a><span class=sd>        **kwargs: Additional reader parameters</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a><span class=sd>    Returns:</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a><span class=sd>        Configured GHSLDataReader instance</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>    <span class=k>return</span> <span class=n>GHSLDataReader</span><span class=p>(</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataHandler.load_into_dataframe class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_into_dataframe</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataHandler.load_into_dataframe class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load GHSL data into a pandas DataFrame.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>ensure_available</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, ensure data is downloaded before loading</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to load methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>DataFrame containing the GHSL data</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=k>def</span> <span class=nf>load_into_dataframe</span><span class=p>(</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a>    <span class=p>],</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a><span class=sd>    Load GHSL data into a pandas DataFrame.</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a><span class=sd>    Args:</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a><span class=sd>        ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a><span class=sd>        **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-762><a id=__codelineno-0-762 name=__codelineno-0-762></a>
</span><span id=__span-0-763><a id=__codelineno-0-763 name=__codelineno-0-763></a><span class=sd>    Returns:</span>
</span><span id=__span-0-764><a id=__codelineno-0-764 name=__codelineno-0-764></a><span class=sd>        DataFrame containing the GHSL data</span>
</span><span id=__span-0-765><a id=__codelineno-0-765 name=__codelineno-0-765></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-766><a id=__codelineno-0-766 name=__codelineno-0-766></a>    <span class=n>tif_processors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-767><a id=__codelineno-0-767 name=__codelineno-0-767></a>        <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-768><a id=__codelineno-0-768 name=__codelineno-0-768></a>    <span class=p>)</span>
</span><span id=__span-0-769><a id=__codelineno-0-769 name=__codelineno-0-769></a>    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
</span><span id=__span-0-770><a id=__codelineno-0-770 name=__codelineno-0-770></a>        <span class=p>[</span><span class=n>tp</span><span class=o>.</span><span class=n>to_dataframe</span><span class=p>()</span> <span class=k>for</span> <span class=n>tp</span> <span class=ow>in</span> <span class=n>tif_processors</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-771><a id=__codelineno-0-771 name=__codelineno-0-771></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.ghsl.GHSLDataReader class="doc doc-heading"> <code>GHSLDataReader</code> <a href=#gigaspatial.handlers.ghsl.GHSLDataReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerReader" href="#gigaspatial.handlers.base.BaseHandlerReader">BaseHandlerReader</a></code></p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a><span class=k>class</span> <span class=nc>GHSLDataReader</span><span class=p>(</span><span class=n>BaseHandlerReader</span><span class=p>):</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a>    <span class=p>):</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>        Initialize the downloader.</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a><span class=sd>        Args:</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>            config: Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a><span class=sd>            data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>            logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a>        <span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a>            <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>GHSLDataConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>GHSLDataConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a>        <span class=p>)</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a>    <span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>]:</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>        Load TifProcessors from GHSL dataset.</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a><span class=sd>        Args:</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a><span class=sd>            source_data_path: List of file paths to load</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a><span class=sd>        Returns:</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a><span class=sd>            List[TifProcessor]: List of TifProcessor objects for accessing the raster data.</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_raster_data</span><span class=p>(</span><span class=n>raster_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>)</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>    <span class=k>def</span> <span class=nf>load</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>file_ext</span><span class=o>=</span><span class=s2>&quot;.tif&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataReader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataReader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.ghsl.GHSLDataConfig" href="#gigaspatial.handlers.ghsl.GHSLDataConfig">GHSLDataConfig</a>, dict[str, <span title="typing.Union">Union</span>[str, int]]]</code> </td> <td> <div class=doc-md-description> <p>Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional data storage interface. If not provided, uses LocalDataStore.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional custom logger. If not provided, uses default logger.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>GHSLDataConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a><span class=p>):</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>    Initialize the downloader.</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a><span class=sd>    Args:</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>        config: Configuration for the GHSL dataset, either as a GHSLDataConfig object or a dictionary of parameters</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a><span class=sd>        data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>        logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a>    <span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a>        <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>GHSLDataConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>GHSLDataConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a>    <span class=p>)</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.ghsl.GHSLDataReader.load_from_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_from_paths</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.ghsl.GHSLDataReader.load_from_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load TifProcessors from GHSL dataset. Args: source_data_path: List of file paths to load Returns: List[TifProcessor]: List of TifProcessor objects for accessing the raster data.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/ghsl.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a><span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>]:</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>    Load TifProcessors from GHSL dataset.</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a><span class=sd>    Args:</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a><span class=sd>        source_data_path: List of file paths to load</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a><span class=sd>    Returns:</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a><span class=sd>        List[TifProcessor]: List of TifProcessor objects for accessing the raster data.</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_raster_data</span><span class=p>(</span><span class=n>raster_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.giga class="doc doc-heading"> <code>giga</code> <a href=#gigaspatial.handlers.giga class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.giga.GigaSchoolLocationFetcher class="doc doc-heading"> <code>GigaSchoolLocationFetcher</code> <a href=#gigaspatial.handlers.giga.GigaSchoolLocationFetcher class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Fetch and process school location data from the Giga School Geolocation Data API.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/giga.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>ConfigDict</span><span class=p>(</span><span class=n>arbitrary_types_allowed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=k>class</span> <span class=nc>GigaSchoolLocationFetcher</span><span class=p>:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>    Fetch and process school location data from the Giga School Geolocation Data API.</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>api_url</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://uni-ooi-giga-maps-service.azurewebsites.net/api/v1/schools_location/country/</span><span class=si>{isocode3}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Base URL for the Giga School API&quot;</span><span class=p>,</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>api_key</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>GIGA_SCHOOL_LOCATION_API_KEY</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>page_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Number of records per API page&quot;</span><span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>sleep_time</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>        <span class=n>default</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Sleep time between API requests&quot;</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=p>)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=nb>repr</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>            <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=bp>self</span><span class=o>.</span><span class=n>api_url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>api_url</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>isocode3</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>        Fetch and process school locations.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>        Args:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>            **kwargs: Additional parameters for customization</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>                - page_size: Override default page size</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>                - sleep_time: Override default sleep time between requests</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>                - max_pages: Limit the number of pages to fetch</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>        Returns:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>            pd.DataFrame: School locations with geospatial info.</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=c1># Override defaults with kwargs if provided</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=n>page_size</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;page_size&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>page_size</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=n>sleep_time</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;sleep_time&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>sleep_time</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=n>max_pages</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;max_pages&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=c1># Prepare headers</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>            <span class=s2>&quot;Authorization&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Bearer </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=s2>&quot;Accept&quot;</span><span class=p>:</span> <span class=s2>&quot;application/json&quot;</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=p>}</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=n>all_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=sa>f</span><span class=s2>&quot;Starting to fetch school locations for country: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>            <span class=c1># Check if we&#39;ve reached max_pages limit</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>            <span class=k>if</span> <span class=n>max_pages</span> <span class=ow>and</span> <span class=n>page</span> <span class=o>&gt;</span> <span class=n>max_pages</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Reached maximum pages limit: </span><span class=si>{</span><span class=n>max_pages</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>                <span class=k>break</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2> with params: </span><span class=si>{</span><span class=n>params</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>api_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>                <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                <span class=n>parsed</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=n>data</span> <span class=o>=</span> <span class=n>parsed</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Request failed on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>                <span class=k>break</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to parse JSON response on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>                <span class=k>break</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=c1># Check if we got any data</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>. Stopping.&quot;</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>                <span class=k>break</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=n>all_data</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetched page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2> with </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=si>}</span><span class=s2> records&quot;</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=c1># If we got fewer records than page_size, we&#39;ve reached the end</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>page_size</span><span class=p>:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Reached end of data (partial page received)&quot;</span><span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>                <span class=k>break</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=c1># Sleep to be respectful to the API</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>            <span class=k>if</span> <span class=n>sleep_time</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>sleep_time</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Finished fetching. Total records: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>all_data</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=c1># Convert to DataFrame and process</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>all_data</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No data fetched, returning empty DataFrame&quot;</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>all_data</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_process_geospatial_data</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>    <span class=k>def</span> <span class=nf>_process_geospatial_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        Process and enhance the DataFrame with geospatial information.</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        Args:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>            df: Raw DataFrame from API</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        Returns:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>            pd.DataFrame: Enhanced DataFrame with geospatial data</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=k>if</span> <span class=n>df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>            <span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>Point</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>],</span> <span class=n>row</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Created geometry for all </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span><span class=si>}</span><span class=s2> records&quot;</span><span class=p>)</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=k>return</span> <span class=n>df</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.giga.GigaSchoolLocationFetcher.fetch_locations class="doc doc-heading"> <code class="highlight language-python"><span class=n>fetch_locations</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.giga.GigaSchoolLocationFetcher.fetch_locations class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Fetch and process school locations.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters for customization - page_size: Override default page size - sleep_time: Override default sleep time between requests - max_pages: Limit the number of pages to fetch</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: School locations with geospatial info.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/giga.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    Fetch and process school locations.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    Args:</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>        **kwargs: Additional parameters for customization</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>            - page_size: Override default page size</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>            - sleep_time: Override default sleep time between requests</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>            - max_pages: Limit the number of pages to fetch</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    Returns:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>        pd.DataFrame: School locations with geospatial info.</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=c1># Override defaults with kwargs if provided</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=n>page_size</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;page_size&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>page_size</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>    <span class=n>sleep_time</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;sleep_time&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>sleep_time</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=n>max_pages</span> <span class=o>=</span> <span class=n>kwargs</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;max_pages&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=c1># Prepare headers</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=s2>&quot;Authorization&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Bearer </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=s2>&quot;Accept&quot;</span><span class=p>:</span> <span class=s2>&quot;application/json&quot;</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=p>}</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=n>all_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=sa>f</span><span class=s2>&quot;Starting to fetch school locations for country: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=c1># Check if we&#39;ve reached max_pages limit</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=k>if</span> <span class=n>max_pages</span> <span class=ow>and</span> <span class=n>page</span> <span class=o>&gt;</span> <span class=n>max_pages</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Reached maximum pages limit: </span><span class=si>{</span><span class=n>max_pages</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=k>break</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2> with params: </span><span class=si>{</span><span class=n>params</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>api_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=n>parsed</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>parsed</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;data&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Request failed on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>            <span class=k>break</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to parse JSON response on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=k>break</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=c1># Check if we got any data</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data on page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2>. Stopping.&quot;</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=k>break</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=n>all_data</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetched page </span><span class=si>{</span><span class=n>page</span><span class=si>}</span><span class=s2> with </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=si>}</span><span class=s2> records&quot;</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=c1># If we got fewer records than page_size, we&#39;ve reached the end</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>page_size</span><span class=p>:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Reached end of data (partial page received)&quot;</span><span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>            <span class=k>break</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=c1># Sleep to be respectful to the API</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=k>if</span> <span class=n>sleep_time</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>sleep_time</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Finished fetching. Total records: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>all_data</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=c1># Convert to DataFrame and process</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>all_data</span><span class=p>:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No data fetched, returning empty DataFrame&quot;</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>all_data</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_process_geospatial_data</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=k>return</span> <span class=n>df</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.google_open_buildings class="doc doc-heading"> <code>google_open_buildings</code> <a href=#gigaspatial.handlers.google_open_buildings class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig class="doc doc-heading"> <code>GoogleOpenBuildingsConfig</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code></p> <p>Configuration for Google Open Buildings dataset files. Implements the BaseHandlerConfig interface for data unit resolution.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=nd>@dataclass</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=k>class</span> <span class=nc>GoogleOpenBuildingsConfig</span><span class=p>(</span><span class=n>BaseHandlerConfig</span><span class=p>):</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    Configuration for Google Open Buildings dataset files.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    Implements the BaseHandlerConfig interface for data unit resolution.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>TILES_URL</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=s2>&quot;https://openbuildings-public-dot-gweb-research.uw.r.appspot.com/public/tiles.geojson&quot;</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;google_open_buildings&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>data_types</span><span class=p>:</span> <span class=nb>tuple</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__post_init__</span><span class=p>()</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_load_s2_tiles</span><span class=p>()</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>def</span> <span class=nf>_load_s2_tiles</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load S2 tiles from GeoJSON file.&quot;&quot;&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>TILES_URL</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=o>.</span><span class=n>from_features</span><span class=p>(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s2>&quot;features&quot;</span><span class=p>],</span> <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>        Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>unit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=n>data_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        Given a tile row or tile_id, return the corresponding file path.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=n>tile_id</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>            <span class=n>unit</span><span class=p>[</span><span class=s2>&quot;tile_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=nb>dict</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>            <span class=k>else</span> <span class=n>unit</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>data_type</span><span class=si>}</span><span class=s2>_s2_level_4_</span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>_buildings.csv.gz&quot;</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=k>def</span> <span class=nf>get_data_unit_paths</span><span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>units</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]],</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>data_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        Given data unit identifiers, return the corresponding file paths.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=k>return</span> <span class=p>[</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=bp>self</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>                <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>units</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=p>]</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>def</span> <span class=nf>_get_relevant_tiles</span><span class=p>(</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=n>BaseGeometry</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=p>],</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>        Identify and return the S2 tiles that spatially intersect with the given geometry.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>            <span class=k>if</span> <span class=n>source</span><span class=o>.</span><span class=n>crs</span> <span class=o>!=</span> <span class=s2>&quot;EPSG:4326&quot;</span><span class=p>:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>                <span class=n>source</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>source</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>unary_union</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>BaseGeometry</span><span class=p>):</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>source</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>            <span class=nb>len</span><span class=p>(</span><span class=n>pt</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>pt</span><span class=p>,</span> <span class=n>Point</span><span class=p>)</span> <span class=k>for</span> <span class=n>pt</span> <span class=ow>in</span> <span class=n>source</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=p>):</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=n>points</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>                <span class=n>pt</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>pt</span><span class=p>,</span> <span class=n>Point</span><span class=p>)</span> <span class=k>else</span> <span class=n>Point</span><span class=p>(</span><span class=n>pt</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>pt</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=k>for</span> <span class=n>pt</span> <span class=ow>in</span> <span class=n>source</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=p>]</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=n>search_geom</span> <span class=o>=</span> <span class=n>MultiPoint</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                <span class=sa>f</span><span class=s2>&quot;Expected Geometry, GeoDataFrame or iterable object of Points got </span><span class=si>{</span><span class=n>source</span><span class=o>.</span><span class=vm>__class__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=n>tile_geom</span><span class=o>.</span><span class=n>intersects</span><span class=p>(</span><span class=n>search_geom</span><span class=p>)</span> <span class=k>for</span> <span class=n>tile_geom</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>tiles_gdf</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>mask</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;tile_id&quot;</span><span class=p>,</span> <span class=s2>&quot;tile_url&quot;</span><span class=p>,</span> <span class=s2>&quot;size_mb&quot;</span><span class=p>]]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>            <span class=s2>&quot;records&quot;</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_data_unit_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_data_unit_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given a tile row or tile_id, return the corresponding file path.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=n>unit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=n>data_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>    Given a tile row or tile_id, return the corresponding file path.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=n>tile_id</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>unit</span><span class=p>[</span><span class=s2>&quot;tile_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=nb>dict</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=k>else</span> <span class=n>unit</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>data_type</span><span class=si>}</span><span class=s2>_s2_level_4_</span><span class=si>{</span><span class=n>tile_id</span><span class=si>}</span><span class=s2>_buildings.csv.gz&quot;</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_data_unit_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_data_unit_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Given data unit identifiers, return the corresponding file paths.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=k>def</span> <span class=nf>get_data_unit_paths</span><span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>    <span class=n>units</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]],</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=n>data_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>    Given data unit identifiers, return the corresponding file paths.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>return</span> <span class=p>[</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=bp>self</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>units</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=p>]</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_relevant_data_units_by_geometry class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_relevant_data_units_by_geometry class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a given geometry or GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_relevant_data_units_by_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig.get_relevant_data_units_by_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a list of points.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>    Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader class="doc doc-heading"> <code>GoogleOpenBuildingsDownloader</code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerDownloader" href="#gigaspatial.handlers.base.BaseHandlerDownloader">BaseHandlerDownloader</a></code></p> <p>A class to handle downloads of Google's Open Buildings dataset.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=k>class</span> <span class=nc>GoogleOpenBuildingsDownloader</span><span class=p>(</span><span class=n>BaseHandlerDownloader</span><span class=p>):</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;A class to handle downloads of Google&#39;s Open Buildings dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=p>):</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>        Initialize the downloader.</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>        Args:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>            config: Optional configuration for file paths and download settings.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>                    If None, a default `GoogleOpenBuildingsConfig` is used.</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>            data_store: Optional instance of a `DataStore` for managing data</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>                        storage. If None, a `LocalDataStore` is used.</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>            logger: Optional custom logger instance. If None, a default logger</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>                    named after the module is created and used.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>        <span class=n>tile_info</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>        <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download data file for a single tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>        <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;tile_url&quot;</span><span class=p>]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>        <span class=k>if</span> <span class=n>data_type</span> <span class=o>==</span> <span class=s2>&quot;points&quot;</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>            <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_url</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>tile_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>            <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                    <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;tile_id&quot;</span><span class=p>],</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>            <span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                    <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                    <span class=sa>f</span><span class=s2>&quot;Successfully downloaded tile: </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;tile_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                <span class=k>return</span> <span class=n>file_path</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>                <span class=sa>f</span><span class=s2>&quot;Failed to download tile </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;tile_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=n>tiles</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]],</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download data files for multiple tiles.&quot;&quot;&quot;</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;There is no matching data&quot;</span><span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>            <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                <span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>            <span class=p>)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>            <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>                <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>                    <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>                        <span class=n>download_func</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>                        <span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>                            <span class=p>[</span><span class=n>row</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>tiles</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>                            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>                            <span class=k>else</span> <span class=n>tiles</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>                        <span class=p>),</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>                    <span class=p>),</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>                    <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>),</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>                    <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>data_type</span><span class=si>}</span><span class=s2> data&quot;</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>                <span class=p>)</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>            <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>return</span> <span class=p>[</span><span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>file_paths</span> <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>        <span class=p>],</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download Google Open Buildings data for a specified geographic region.</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>        The region can be defined by a country code/name, a list of points,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>        relevant S2 tiles intersecting the region and downloads the</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>        specified type of data (polygons or points) for those tiles in parallel.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        Args:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>            source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>                    Can be:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>                      - A string representing a country code or name.</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>                      - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>                      - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>                      - A GeoDataFrame with geometry column in EPSG:4326.</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>            data_type: The type of building data to download (&#39;polygons&#39; or &#39;points&#39;).</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>                       Defaults to &#39;polygons&#39;.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>            **kwargs: Additional keyword arguments that are passed to</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>                      `AdminBoundaries.create()` if `source` is a country code.</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>                      For example, `path` to a custom boundaries file.</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=sd>        Returns:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=sd>            A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>            Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><span class=sd>            all downloads fail.</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>data_type</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>    <span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><span class=sd>        Download Google Open Buildings data for a specific country.</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=sd>        This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>        using its code or name.</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>        Args:</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>            country: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>            data_type: The type of building data to download (&#39;polygons&#39; or &#39;points&#39;).</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=sd>                       Defaults to &#39;polygons&#39;.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=sd>            data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>                        `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>                        `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>            country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>                               country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>                               instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>        Returns:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>            A list of local file paths for the successfully downloaded tiles</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>            for the specified country.</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>            <span class=n>source</span><span class=o>=</span><span class=n>country</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>            <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>            <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>            <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span><span class=p>,</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig">GoogleOpenBuildingsConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional configuration for file paths and download settings. If None, a default <code>GoogleOpenBuildingsConfig</code> is used.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional instance of a <code>DataStore</code> for managing data storage. If None, a <code>LocalDataStore</code> is used.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional custom logger instance. If None, a default logger named after the module is created and used.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=p>):</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>    Initialize the downloader.</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>    Args:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        config: Optional configuration for file paths and download settings.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>                If None, a default `GoogleOpenBuildingsConfig` is used.</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>        data_store: Optional instance of a `DataStore` for managing data</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>                    storage. If None, a `LocalDataStore` is used.</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        logger: Optional custom logger instance. If None, a default logger</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>                named after the module is created and used.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download class="doc doc-heading"> <code class="highlight language-python"><span class=n>download</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download Google Open Buildings data for a specified geographic region.</p> <p>The region can be defined by a country code/name, a list of points, a Shapely geometry, or a GeoDataFrame. This method identifies the relevant S2 tiles intersecting the region and downloads the specified type of data (polygons or points) for those tiles in parallel.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[float, float], <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>Defines the geographic area for which to download data. Can be: - A string representing a country code or name. - A list of (latitude, longitude) tuples or Shapely Point objects. - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon). - A GeoDataFrame with geometry column in EPSG:4326.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_type</code></td> <td> <code><span title="typing.Literal">Literal</span>[&#39;polygons&#39;, &#39;points&#39;]</code> </td> <td> <div class=doc-md-description> <p>The type of building data to download ('polygons' or 'points'). Defaults to 'polygons'.</p> </div> </td> <td> <code>&#39;polygons&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments that are passed to <code>AdminBoundaries.create()</code> if <code>source</code> is a country code. For example, <code>path</code> to a custom boundaries file.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Returns an empty list if no data is found for the region or if</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>all downloads fail.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>    <span class=p>],</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download Google Open Buildings data for a specified geographic region.</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>    The region can be defined by a country code/name, a list of points,</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>    a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>    relevant S2 tiles intersecting the region and downloads the</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>    specified type of data (polygons or points) for those tiles in parallel.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>    Args:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>        source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>                Can be:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>                  - A string representing a country code or name.</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>                  - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>                  - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>                  - A GeoDataFrame with geometry column in EPSG:4326.</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>        data_type: The type of building data to download (&#39;polygons&#39; or &#39;points&#39;).</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>                   Defaults to &#39;polygons&#39;.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>        **kwargs: Additional keyword arguments that are passed to</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a><span class=sd>                  `AdminBoundaries.create()` if `source` is a country code.</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>                  For example, `path` to a custom boundaries file.</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=sd>    Returns:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=sd>        A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>        Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><span class=sd>        all downloads fail.</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>    <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>data_type</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>country_geom_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download Google Open Buildings data for a specific country.</p> <p>This is a convenience method to download data for an entire country using its code or name.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>country</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The country code (e.g., 'USA', 'GBR') or name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_type</code></td> <td> <code><span title="typing.Literal">Literal</span>[&#39;polygons&#39;, &#39;points&#39;]</code> </td> <td> <div class=doc-md-description> <p>The type of building data to download ('polygons' or 'points'). Defaults to 'polygons'.</p> </div> </td> <td> <code>&#39;polygons&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional instance of a <code>DataStore</code> to be used by <code>AdminBoundaries</code> for loading country boundaries. If None, <code>AdminBoundaries</code> will use its default data loading.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>country_geom_path</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]</code> </td> <td> <div class=doc-md-description> <p>Optional path to a GeoJSON file containing the country boundary. If provided, this boundary is used instead of the default from <code>AdminBoundaries</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>for the specified country.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><span class=sd>    Download Google Open Buildings data for a specific country.</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=sd>    This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>    using its code or name.</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>    Args:</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>        country: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>        data_type: The type of building data to download (&#39;polygons&#39; or &#39;points&#39;).</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=sd>                   Defaults to &#39;polygons&#39;.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=sd>        data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>                    `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>                    `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>        country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>                           country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>                           instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>    Returns:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>        A list of local file paths for the successfully downloaded tiles</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>        for the specified country.</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>        <span class=n>source</span><span class=o>=</span><span class=n>country</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>        <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>        <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>        <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span><span class=p>,</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_data_unit class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_unit</span><span class=p>(</span><span class=n>tile_info</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_data_unit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download data file for a single tile.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>    <span class=n>tile_info</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download data file for a single tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>    <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;tile_url&quot;</span><span class=p>]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>    <span class=k>if</span> <span class=n>data_type</span> <span class=o>==</span> <span class=s2>&quot;points&quot;</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_url</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>tile_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;tile_id&quot;</span><span class=p>],</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>            <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=p>)</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>            <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                <span class=sa>f</span><span class=s2>&quot;Successfully downloaded tile: </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;tile_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>            <span class=k>return</span> <span class=n>file_path</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=sa>f</span><span class=s2>&quot;Failed to download tile </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;tile_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_data_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s1>&#39;polygons&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader.download_data_units class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download data files for multiple tiles.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=n>tiles</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]],</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=s2>&quot;points&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download data files for multiple tiles.&quot;&quot;&quot;</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;There is no matching data&quot;</span><span class=p>)</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>    <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>            <span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=p>)</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>            <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>                <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>                    <span class=n>download_func</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>                    <span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>                        <span class=p>[</span><span class=n>row</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>tiles</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>                        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>                        <span class=k>else</span> <span class=n>tiles</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>                    <span class=p>),</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>                <span class=p>),</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>                <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>),</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>                <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>data_type</span><span class=si>}</span><span class=s2> data&quot;</span><span class=p>,</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>            <span class=p>)</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=k>return</span> <span class=p>[</span><span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>file_paths</span> <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler class="doc doc-heading"> <code>GoogleOpenBuildingsHandler</code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandler" href="#gigaspatial.handlers.base.BaseHandler">BaseHandler</a></code></p> <p>Handler for Google Open Buildings dataset.</p> <p>This class provides a unified interface for downloading and loading Google Open Buildings data. It manages the lifecycle of configuration, downloading, and reading components.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=k>class</span> <span class=nc>GoogleOpenBuildingsHandler</span><span class=p>(</span><span class=n>BaseHandler</span><span class=p>):</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>    Handler for Google Open Buildings dataset.</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>    This class provides a unified interface for downloading and loading Google Open Buildings data.</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>    It manages the lifecycle of configuration, downloading, and reading components.</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>:</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><span class=sd>        Create and return a GoogleOpenBuildingsConfig instance.</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>        Args:</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><span class=sd>            **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><span class=sd>        Returns:</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=sd>            Configured GoogleOpenBuildingsConfig instance</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>        <span class=k>return</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>    <span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>        <span class=n>config</span><span class=p>:</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsDownloader</span><span class=p>:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>        Create and return a GoogleOpenBuildingsDownloader instance.</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><span class=sd>        Args:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><span class=sd>            **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><span class=sd>        Returns:</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>            Configured GoogleOpenBuildingsDownloader instance</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=k>return</span> <span class=n>GoogleOpenBuildingsDownloader</span><span class=p>(</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>        <span class=p>)</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>    <span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>        <span class=n>config</span><span class=p>:</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsReader</span><span class=p>:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>        Create and return a GoogleOpenBuildingsReader instance.</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>        Args:</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            **kwargs: Additional reader parameters</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>        Returns:</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>            Configured GoogleOpenBuildingsReader instance</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>        <span class=k>return</span> <span class=n>GoogleOpenBuildingsReader</span><span class=p>(</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>        <span class=p>)</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>    <span class=k>def</span> <span class=nf>load_points</span><span class=p>(</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=p>],</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>        <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>        Load point data from Google Open Buildings dataset.</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>        Args:</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>            ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=sd>            **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>        Returns:</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>            GeoDataFrame containing building point data</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>            <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>            <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>            <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;points&quot;</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>        <span class=p>)</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>    <span class=k>def</span> <span class=nf>load_polygons</span><span class=p>(</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>            <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>        <span class=p>],</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>        <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>        Load polygon data from Google Open Buildings dataset.</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>        Args:</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>            source: The data source specification</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>            ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>            **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>        Returns:</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>            GeoDataFrame containing building polygon data</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>            <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>            <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>            <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_config</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GoogleOpenBuildingsConfig instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional configuration parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig">GoogleOpenBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configured GoogleOpenBuildingsConfig instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>:</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><span class=sd>    Create and return a GoogleOpenBuildingsConfig instance.</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>    Args:</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><span class=sd>        **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><span class=sd>    Returns:</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=sd>        Configured GoogleOpenBuildingsConfig instance</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>    <span class=k>return</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_downloader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_downloader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_downloader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GoogleOpenBuildingsDownloader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig">GoogleOpenBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional downloader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsDownloader">GoogleOpenBuildingsDownloader</a></code> </td> <td> <div class=doc-md-description> <p>Configured GoogleOpenBuildingsDownloader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>    <span class=n>config</span><span class=p>:</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsDownloader</span><span class=p>:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>    Create and return a GoogleOpenBuildingsDownloader instance.</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><span class=sd>    Args:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><span class=sd>        **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><span class=sd>    Returns:</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>        Configured GoogleOpenBuildingsDownloader instance</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>    <span class=k>return</span> <span class=n>GoogleOpenBuildingsDownloader</span><span class=p>(</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_reader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_reader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.create_reader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a GoogleOpenBuildingsReader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsConfig">GoogleOpenBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional reader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader" href="#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader">GoogleOpenBuildingsReader</a></code> </td> <td> <div class=doc-md-description> <p>Configured GoogleOpenBuildingsReader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>    <span class=n>config</span><span class=p>:</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>GoogleOpenBuildingsReader</span><span class=p>:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>    Create and return a GoogleOpenBuildingsReader instance.</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>    Args:</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        **kwargs: Additional reader parameters</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>    Returns:</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>        Configured GoogleOpenBuildingsReader instance</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>    <span class=k>return</span> <span class=n>GoogleOpenBuildingsReader</span><span class=p>(</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.load_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_points</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.load_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load point data from Google Open Buildings dataset.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>ensure_available</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, ensure data is downloaded before loading</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to load methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>GeoDataFrame containing building point data</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=k>def</span> <span class=nf>load_points</span><span class=p>(</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>    <span class=p>],</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>    Load point data from Google Open Buildings dataset.</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>    Args:</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>        ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=sd>        **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>    Returns:</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>        GeoDataFrame containing building point data</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>        <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;points&quot;</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.load_polygons class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_polygons</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsHandler.load_polygons class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load polygon data from Google Open Buildings dataset.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[tuple, <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>, <span title="pathlib.Path">Path</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]]</code> </td> <td> <div class=doc-md-description> <p>The data source specification</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>ensure_available</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>If True, ensure data is downloaded before loading</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to load methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>GeoDataFrame containing building polygon data</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=k>def</span> <span class=nf>load_polygons</span><span class=p>(</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>tuple</span><span class=p>,</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># geometry</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>  <span class=c1># geodataframe</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>        <span class=n>Path</span><span class=p>,</span>  <span class=c1># path</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span>  <span class=c1># list of paths</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>    <span class=p>],</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>    Load polygon data from Google Open Buildings dataset.</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>    Args:</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>        source: The data source specification</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>        ensure_available: If True, ensure data is downloaded before loading</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>        **kwargs: Additional parameters passed to load methods</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>    Returns:</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>        GeoDataFrame containing building polygon data</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>        <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>        <span class=n>ensure_available</span><span class=o>=</span><span class=n>ensure_available</span><span class=p>,</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader class="doc doc-heading"> <code>GoogleOpenBuildingsReader</code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerReader" href="#gigaspatial.handlers.base.BaseHandlerReader">BaseHandlerReader</a></code></p> <p>Reader for Google Open Buildings data, supporting country, points, and geometry-based resolution.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=k>class</span> <span class=nc>GoogleOpenBuildingsReader</span><span class=p>(</span><span class=n>BaseHandlerReader</span><span class=p>):</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>    Reader for Google Open Buildings data, supporting country, points, and geometry-based resolution.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=p>):</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>        Load building data from Google Open Buildings dataset.</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>        Args:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>            source_data_path: List of file paths to load</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>        Returns:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=sd>            GeoDataFrame containing building data</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_tabular_data</span><span class=p>(</span><span class=n>file_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>)</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>    <span class=k>def</span> <span class=nf>load</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>    <span class=k>def</span> <span class=nf>load_points</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;This is a convenience method to load points data&quot;&quot;&quot;</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;points&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>    <span class=k>def</span> <span class=nf>load_polygons</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;This is a convenience method to load polygons data&quot;&quot;&quot;</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_from_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_from_paths</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_from_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load building data from Google Open Buildings dataset. Args: source_data_path: List of file paths to load Returns: GeoDataFrame containing building data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>    Load building data from Google Open Buildings dataset.</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>    Args:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>        source_data_path: List of file paths to load</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>    Returns:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=sd>        GeoDataFrame containing building data</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>    <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_tabular_data</span><span class=p>(</span><span class=n>file_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>)</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_points</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>This is a convenience method to load points data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=k>def</span> <span class=nf>load_points</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;This is a convenience method to load points data&quot;&quot;&quot;</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;points&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_polygons class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_polygons</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.google_open_buildings.GoogleOpenBuildingsReader.load_polygons class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>This is a convenience method to load polygons data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/google_open_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=k>def</span> <span class=nf>load_polygons</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;This is a convenience method to load polygons data&quot;&quot;&quot;</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;polygons&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.hdx class="doc doc-heading"> <code>hdx</code> <a href=#gigaspatial.handlers.hdx class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.hdx.HDXConfig class="doc doc-heading"> <code>HDXConfig</code> <a href=#gigaspatial.handlers.hdx.HDXConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Configuration for HDX data access</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=k>class</span> <span class=nc>HDXConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for HDX data access&quot;&quot;&quot;</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=c1># User configuration</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>dataset_name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Name of the HDX dataset to download&quot;</span><span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;hdx&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>))</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>user_agent</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;gigaspatial&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;User agent for HDX API requests&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>hdx_site</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>&quot;prod&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;HDX site to use (prod or test)&quot;</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>resource_filter</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Filter to apply to resources&quot;</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=nd>@property</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=k>def</span> <span class=nf>output_dir_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Path to save the downloaded HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=sa>f</span><span class=s2>&quot;HDXConfig(</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=sa>f</span><span class=s2>&quot;  dataset_name=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=sa>f</span><span class=s2>&quot;  base_path=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_path</span><span class=si>}</span><span class=s2>&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>            <span class=sa>f</span><span class=s2>&quot;  hdx_site=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>hdx_site</span><span class=si>}</span><span class=s2>&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=sa>f</span><span class=s2>&quot;  user_agent=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>user_agent</span><span class=si>}</span><span class=s2>&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>            <span class=sa>f</span><span class=s2>&quot;)&quot;</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.hdx.HDXConfig.output_dir_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>output_dir_path</span><span class=p>:</span> <span class=n>Path</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.hdx.HDXConfig.output_dir_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Path to save the downloaded HDX dataset</p> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.hdx.HDXDownloader class="doc doc-heading"> <code>HDXDownloader</code> <a href=#gigaspatial.handlers.hdx.HDXDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Downloader for HDX datasets</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=k>class</span> <span class=nc>HDXDownloader</span><span class=p>:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Downloader for HDX datasets&quot;&quot;&quot;</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>HDXConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>HDXConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>            <span class=n>Configuration</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_hdx_configured</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_hdx_configured</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=k>def</span> <span class=nf>from_dataset_name</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>dataset_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Create a downloader for a specific HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>HDXConfig</span><span class=p>(</span><span class=n>dataset_name</span><span class=o>=</span><span class=n>dataset_name</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=k>def</span> <span class=nf>_configure_hdx</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Configure HDX API if not already configured&quot;&quot;&quot;</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_hdx_configured</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>                <span class=n>Configuration</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>                    <span class=n>hdx_site</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>hdx_site</span><span class=p>,</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                    <span class=n>user_agent</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>user_agent</span><span class=p>,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                    <span class=n>hdx_read_only</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>                <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>                <span class=bp>self</span><span class=o>.</span><span class=n>_hdx_configured</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error configuring HDX API: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>                <span class=k>raise</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=k>def</span> <span class=nf>get_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dataset</span><span class=p>:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_configure_hdx</span><span class=p>()</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching HDX dataset: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=n>dataset</span> <span class=o>=</span> <span class=n>Dataset</span><span class=o>.</span><span class=n>read_from_hdx</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>dataset</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>                    <span class=sa>f</span><span class=s2>&quot;Dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39; not found on HDX&quot;</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>return</span> <span class=n>dataset</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error fetching HDX dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=k>raise</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=k>def</span> <span class=nf>get_dataset_resources</span><span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>dataset</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dataset</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Resource</span><span class=p>]:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get resources from the HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset</span><span class=p>()</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>resources</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>get_resources</span><span class=p>()</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=c1># Apply resource filter if specified</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resource_filter</span><span class=p>:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>                <span class=n>filtered_resources</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>                <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>                    <span class=n>match</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resource_filter</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>                        <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>res</span><span class=o>.</span><span class=n>data</span> <span class=ow>and</span> <span class=n>res</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>!=</span> <span class=n>value</span><span class=p>:</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                            <span class=n>match</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                            <span class=k>break</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                    <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                        <span class=n>filtered_resources</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                <span class=n>resources</span> <span class=o>=</span> <span class=n>filtered_resources</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=k>return</span> <span class=n>resources</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error getting dataset resources: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=k>raise</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>    <span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download and save all resources from the HDX dataset into the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=n>dataset</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset</span><span class=p>()</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset_resources</span><span class=p>(</span><span class=n>dataset</span><span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                    <span class=sa>f</span><span class=s2>&quot;No resources found for dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                <span class=sa>f</span><span class=s2>&quot;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>resources</span><span class=p>)</span><span class=si>}</span><span class=s2> resource(s) for dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>            <span class=n>downloaded_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                    <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                    <span class=c1># Download to a temporary directory</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                    <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>TemporaryDirectory</span><span class=p>()</span> <span class=k>as</span> <span class=n>tmpdir</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                        <span class=n>url</span><span class=p>,</span> <span class=n>local_path</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>folder</span><span class=o>=</span><span class=n>tmpdir</span><span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                        <span class=c1># Read the file and write to the DataStore</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>local_path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                            <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                        <span class=c1># Compose the target path in the DataStore</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                        <span class=n>target_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                            <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_dir_path</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>local_path</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                        <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=n>target_path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                        <span class=n>downloaded_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>target_path</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                        <span class=sa>f</span><span class=s2>&quot;Downloaded resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                    <span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>                        <span class=sa>f</span><span class=s2>&quot;Error downloading resource </span><span class=si>{</span><span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                    <span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>            <span class=k>return</span> <span class=n>downloaded_paths</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXDownloader.download_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_dataset</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.hdx.HDXDownloader.download_dataset class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download and save all resources from the HDX dataset into the data_store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download and save all resources from the HDX dataset into the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>dataset</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset</span><span class=p>()</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset_resources</span><span class=p>(</span><span class=n>dataset</span><span class=p>)</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                <span class=sa>f</span><span class=s2>&quot;No resources found for dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>            <span class=sa>f</span><span class=s2>&quot;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>resources</span><span class=p>)</span><span class=si>}</span><span class=s2> resource(s) for dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=n>downloaded_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                <span class=c1># Download to a temporary directory</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>TemporaryDirectory</span><span class=p>()</span> <span class=k>as</span> <span class=n>tmpdir</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                    <span class=n>url</span><span class=p>,</span> <span class=n>local_path</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>folder</span><span class=o>=</span><span class=n>tmpdir</span><span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                    <span class=c1># Read the file and write to the DataStore</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>local_path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                    <span class=c1># Compose the target path in the DataStore</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                    <span class=n>target_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_dir_path</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>local_path</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                    <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=n>target_path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                    <span class=n>downloaded_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>target_path</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=sa>f</span><span class=s2>&quot;Downloaded resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                <span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>                    <span class=sa>f</span><span class=s2>&quot;Error downloading resource </span><span class=si>{</span><span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                <span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=k>return</span> <span class=n>downloaded_paths</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXDownloader.from_dataset_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_dataset_name</span><span class=p>(</span><span class=n>dataset_name</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.hdx.HDXDownloader.from_dataset_name class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create a downloader for a specific HDX dataset</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=nd>@classmethod</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=k>def</span> <span class=nf>from_dataset_name</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>dataset_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Create a downloader for a specific HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>HDXConfig</span><span class=p>(</span><span class=n>dataset_name</span><span class=o>=</span><span class=n>dataset_name</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>    <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXDownloader.get_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_dataset</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.hdx.HDXDownloader.get_dataset class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get the HDX dataset</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=k>def</span> <span class=nf>get_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dataset</span><span class=p>:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_configure_hdx</span><span class=p>()</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching HDX dataset: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=n>dataset</span> <span class=o>=</span> <span class=n>Dataset</span><span class=o>.</span><span class=n>read_from_hdx</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>dataset</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>                <span class=sa>f</span><span class=s2>&quot;Dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39; not found on HDX&quot;</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>return</span> <span class=n>dataset</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error fetching HDX dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXDownloader.get_dataset_resources class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_dataset_resources</span><span class=p>(</span><span class=n>dataset</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.hdx.HDXDownloader.get_dataset_resources class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get resources from the HDX dataset</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=k>def</span> <span class=nf>get_dataset_resources</span><span class=p>(</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>dataset</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dataset</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Resource</span><span class=p>]:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get resources from the HDX dataset&quot;&quot;&quot;</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>    <span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset</span><span class=p>()</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>resources</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>get_resources</span><span class=p>()</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=c1># Apply resource filter if specified</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resource_filter</span><span class=p>:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=n>filtered_resources</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>                <span class=n>match</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resource_filter</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>                    <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>res</span><span class=o>.</span><span class=n>data</span> <span class=ow>and</span> <span class=n>res</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>!=</span> <span class=n>value</span><span class=p>:</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                        <span class=n>match</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                        <span class=k>break</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                    <span class=n>filtered_resources</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>            <span class=n>resources</span> <span class=o>=</span> <span class=n>filtered_resources</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=k>return</span> <span class=n>resources</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error getting dataset resources: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.hdx.HDXReader class="doc doc-heading"> <code>HDXReader</code> <a href=#gigaspatial.handlers.hdx.HDXReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Reader for HDX datasets</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=k>class</span> <span class=nc>HDXReader</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Reader for HDX datasets&quot;&quot;&quot;</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=n>dataset_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=n>base_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>    <span class=p>):</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span> <span class=o>=</span> <span class=n>dataset_name</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>=</span> <span class=n>base_path</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;hdx&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=k>def</span> <span class=nf>list_resources</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;List all resources in the dataset directory using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=c1># Check if the dataset directory exists in the data_store</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>is_dir</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>            <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=p>):</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                <span class=sa>f</span><span class=s2>&quot;HDX dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39; not found at </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=si>}</span><span class=s2>. &quot;</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                <span class=s2>&quot;Download the data first using HDXDownloader.&quot;</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>            <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=c1># List files using the data_store</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=k>def</span> <span class=nf>read_resource</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>resource_file</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>]:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Read a specific resource file from the dataset using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span> <span class=o>/</span> <span class=n>resource_file</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>                <span class=sa>f</span><span class=s2>&quot;Resource file </span><span class=si>{</span><span class=n>resource_file</span><span class=si>}</span><span class=s2> not found in dataset </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>            <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>            <span class=k>return</span> <span class=n>read_dataset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not read file </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=k>def</span> <span class=nf>read_all_resources</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>]]:</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Read all resources in the dataset directory using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>list_resources</span><span class=p>()</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=n>result</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=k>for</span> <span class=n>resource</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>                <span class=n>result</span><span class=p>[</span><span class=n>resource</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>read_resource</span><span class=p>(</span><span class=n>resource</span><span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not read resource </span><span class=si>{</span><span class=n>resource</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>        <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXReader.list_resources class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_resources</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.hdx.HDXReader.list_resources class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List all resources in the dataset directory using the data_store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=k>def</span> <span class=nf>list_resources</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;List all resources in the dataset directory using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=c1># Check if the dataset directory exists in the data_store</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>is_dir</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>        <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>    <span class=p>):</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>            <span class=sa>f</span><span class=s2>&quot;HDX dataset &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&#39; not found at </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=si>}</span><span class=s2>. &quot;</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>            <span class=s2>&quot;Download the data first using HDXDownloader.&quot;</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>    <span class=c1># List files using the data_store</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXReader.read_all_resources class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_all_resources</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.hdx.HDXReader.read_all_resources class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Read all resources in the dataset directory using the data_store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><span class=k>def</span> <span class=nf>read_all_resources</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>]]:</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Read all resources in the dataset directory using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>list_resources</span><span class=p>()</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=n>result</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=k>for</span> <span class=n>resource</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>            <span class=n>result</span><span class=p>[</span><span class=n>resource</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>read_resource</span><span class=p>(</span><span class=n>resource</span><span class=p>)</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not read resource </span><span class=si>{</span><span class=n>resource</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.hdx.HDXReader.read_resource class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_resource</span><span class=p>(</span><span class=n>resource_file</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.hdx.HDXReader.read_resource class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Read a specific resource file from the dataset using the data_store.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/hdx.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=k>def</span> <span class=nf>read_resource</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>resource_file</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>]:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Read a specific resource file from the dataset using the data_store.&quot;&quot;&quot;</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span> <span class=o>/</span> <span class=n>resource_file</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>            <span class=sa>f</span><span class=s2>&quot;Resource file </span><span class=si>{</span><span class=n>resource_file</span><span class=si>}</span><span class=s2> not found in dataset </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_name</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=k>return</span> <span class=n>read_dataset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not read file </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.mapbox_image class="doc doc-heading"> <code>mapbox_image</code> <a href=#gigaspatial.handlers.mapbox_image class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.mapbox_image.MapboxImageDownloader class="doc doc-heading"> <code>MapboxImageDownloader</code> <a href=#gigaspatial.handlers.mapbox_image.MapboxImageDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Class to download images from Mapbox Static Images API using a specific style</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/mapbox_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=k>class</span> <span class=nc>MapboxImageDownloader</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Class to download images from Mapbox Static Images API using a specific style&quot;&quot;&quot;</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=n>BASE_URL</span> <span class=o>=</span> <span class=s2>&quot;https://api.mapbox.com/styles/v1&quot;</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>        <span class=n>access_token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>MAPBOX_ACCESS_TOKEN</span><span class=p>,</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>        <span class=n>style_id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=p>):</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>        Initialize the downloader with Mapbox credentials</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>        Args:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>            access_token: Mapbox access token</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>            style_id: Mapbox style ID to use for image download</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>            data_store: Instance of DataStore for accessing data storage</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>        <span class=bp>self</span><span class=o>.</span><span class=n>access_token</span> <span class=o>=</span> <span class=n>access_token</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=bp>self</span><span class=o>.</span><span class=n>style_id</span> <span class=o>=</span> <span class=n>style_id</span> <span class=k>if</span> <span class=n>style_id</span> <span class=k>else</span> <span class=s2>&quot;mapbox/satellite-v9&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>def</span> <span class=nf>_construct_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bounds</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>float</span><span class=p>],</span> <span class=n>image_size</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Construct the Mapbox Static Images API URL&quot;&quot;&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=n>bounds_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;[</span><span class=si>{</span><span class=s1>&#39;,&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span><span class=w> </span><span class=n>bounds</span><span class=p>))</span><span class=si>}</span><span class=s2>]&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>BASE_URL</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>style_id</span><span class=si>}</span><span class=s2>/static/</span><span class=si>{</span><span class=n>bounds_str</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>image_size</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>            <span class=sa>f</span><span class=s2>&quot;?access_token=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>access_token</span><span class=si>}</span><span class=s2>&amp;attribution=false&amp;logo=false&quot;</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=k>def</span> <span class=nf>_download_single_image</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>url</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download a single image from URL&quot;&quot;&quot;</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading </span><span class=si>{</span><span class=n>output_path</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>            <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=k>def</span> <span class=nf>download_images_by_tiles</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=n>mercator_tiles</span><span class=p>:</span> <span class=s2>&quot;MercatorTiles&quot;</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        Download images for given mercator tiles using the specified style</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        Args:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>            mercator_tiles: MercatorTiles instance containing quadkeys</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>            max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=c1># self.data_store.makedirs(str(output_dir), exist_ok=True)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>total_tiles</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> tiles with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=p>)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>def</span> <span class=nf>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=w>            </span><span class=sd>&quot;&quot;&quot;Get tile bounds from quadkey&quot;&quot;&quot;</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=n>tile</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>quadkey_to_tile</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>bounds</span><span class=p>(</span><span class=n>tile</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=k>return</span> <span class=p>[</span><span class=n>bounds</span><span class=o>.</span><span class=n>west</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>south</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>east</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>north</span><span class=p>]</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=n>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>quadkey</span><span class=si>}</span><span class=s2>.png&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_construct_url</span><span class=p>(</span><span class=n>bounds</span><span class=p>,</span> <span class=n>image_size_str</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>max_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=n>futures</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>                <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>download_image</span><span class=p>,</span> <span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>                <span class=k>for</span> <span class=n>quadkey</span> <span class=ow>in</span> <span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=p>]</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>            <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_tiles</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                    <span class=k>if</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>():</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>                        <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>                    <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=k>def</span> <span class=nf>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=n>gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        Download images for given points using the specified style</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        Args:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>            gdf_points: GeoDataFrame containing bounding box polygons</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>            max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=c1># self.data_store.makedirs(str(output_dir), exist_ok=True)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=n>total_images</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>gdf</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>        <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span><span class=n>idx</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>bounds</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>            <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>idx</span><span class=si>}</span><span class=s2>.png&quot;</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_construct_url</span><span class=p>(</span><span class=n>bounds</span><span class=p>,</span> <span class=n>image_size_str</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>            <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>            <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>max_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>            <span class=n>futures</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>download_image</span><span class=p>,</span> <span class=n>row</span><span class=o>.</span><span class=n>Index</span><span class=p>,</span> <span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>bounds</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>itertuples</span><span class=p>()</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>            <span class=p>]</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>            <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>            <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_images</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                    <span class=k>if</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>():</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                        <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                    <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>            <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>        <span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=k>def</span> <span class=nf>download_images_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=n>res_meters_pixel</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><span class=sd>        Download images for given coordinates by creating bounded boxes around points</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=sd>        Args:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=sd>            data: Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=sd>            res_meters_pixel: Size of the bounding box in meters (creates a square)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><span class=sd>            max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>data</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>            <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>])</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>coordinates_df</span><span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>            <span class=n>gdf</span><span class=p>,</span> <span class=n>res_meters_pixel</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;square&quot;</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=p>)</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=bp>self</span><span class=o>.</span><span class=n>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>            <span class=n>buffered_gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=p>,</span> <span class=n>max_workers</span><span class=p>,</span> <span class=n>image_prefix</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.mapbox_image.MapboxImageDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>access_token</span><span class=o>=</span><span class=n>config</span><span class=o>.</span><span class=n>MAPBOX_ACCESS_TOKEN</span><span class=p>,</span> <span class=n>style_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.mapbox_image.MapboxImageDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader with Mapbox credentials</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>access_token</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Mapbox access token</p> </div> </td> <td> <code><span title="gigaspatial.config.config.MAPBOX_ACCESS_TOKEN">MAPBOX_ACCESS_TOKEN</span></code> </td> </tr> <tr class=doc-section-item> <td><code>style_id</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Mapbox style ID to use for image download</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Instance of DataStore for accessing data storage</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/mapbox_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>access_token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>MAPBOX_ACCESS_TOKEN</span><span class=p>,</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>style_id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=p>):</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    Initialize the downloader with Mapbox credentials</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    Args:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>        access_token: Mapbox access token</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        style_id: Mapbox style ID to use for image download</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>        data_store: Instance of DataStore for accessing data storage</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=bp>self</span><span class=o>.</span><span class=n>access_token</span> <span class=o>=</span> <span class=n>access_token</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=bp>self</span><span class=o>.</span><span class=n>style_id</span> <span class=o>=</span> <span class=n>style_id</span> <span class=k>if</span> <span class=n>style_id</span> <span class=k>else</span> <span class=s2>&quot;mapbox/satellite-v9&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_bounds class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_bounds</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>max_workers</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_bounds class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given points using the specified style</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>gdf_points</code></td> <td> </td> <td> <div class=doc-md-description> <p>GeoDataFrame containing bounding box polygons</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>max_workers</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Maximum number of concurrent downloads</p> </div> </td> <td> <code>4</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/mapbox_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=k>def</span> <span class=nf>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=n>gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    Download images for given points using the specified style</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>    Args:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        gdf_points: GeoDataFrame containing bounding box polygons</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>        max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=c1># self.data_store.makedirs(str(output_dir), exist_ok=True)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=n>total_images</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>gdf</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>    <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span><span class=n>idx</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>bounds</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>idx</span><span class=si>}</span><span class=s2>.png&quot;</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_construct_url</span><span class=p>(</span><span class=n>bounds</span><span class=p>,</span> <span class=n>image_size_str</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>max_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>        <span class=n>futures</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>            <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>download_image</span><span class=p>,</span> <span class=n>row</span><span class=o>.</span><span class=n>Index</span><span class=p>,</span> <span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>bounds</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>            <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>itertuples</span><span class=p>()</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>        <span class=p>]</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>        <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>        <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_images</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>            <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                <span class=k>if</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>():</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                    <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_coordinates class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_coordinates</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>res_meters_pixel</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>max_workers</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_coordinates class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given coordinates by creating bounded boxes around points</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[float, float]]]</code> </td> <td> <div class=doc-md-description> <p>Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>res_meters_pixel</code></td> <td> <code>float</code> </td> <td> <div class=doc-md-description> <p>Size of the bounding box in meters (creates a square)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>max_workers</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Maximum number of concurrent downloads</p> </div> </td> <td> <code>4</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/mapbox_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><span class=k>def</span> <span class=nf>download_images_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>    <span class=n>res_meters_pixel</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>    <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a><span class=sd>    Download images for given coordinates by creating bounded boxes around points</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=sd>    Args:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=sd>        data: Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=sd>        res_meters_pixel: Size of the bounding box in meters (creates a square)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><span class=sd>        max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>data</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>])</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=n>gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>coordinates_df</span><span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=n>gdf</span><span class=p>,</span> <span class=n>res_meters_pixel</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;square&quot;</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>    <span class=p>)</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>    <span class=bp>self</span><span class=o>.</span><span class=n>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=n>buffered_gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=p>,</span> <span class=n>max_workers</span><span class=p>,</span> <span class=n>image_prefix</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_tiles class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_tiles</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>max_workers</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.mapbox_image.MapboxImageDownloader.download_images_by_tiles class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given mercator tiles using the specified style</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>mercator_tiles</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.grid.mercator_tiles.MercatorTiles" href="../grid/#gigaspatial.grid.mercator_tiles.MercatorTiles">MercatorTiles</a></code> </td> <td> <div class=doc-md-description> <p>MercatorTiles instance containing quadkeys</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>max_workers</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Maximum number of concurrent downloads</p> </div> </td> <td> <code>4</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/mapbox_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=k>def</span> <span class=nf>download_images_by_tiles</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=n>mercator_tiles</span><span class=p>:</span> <span class=s2>&quot;MercatorTiles&quot;</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=n>max_workers</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>    Download images for given mercator tiles using the specified style</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    Args:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        mercator_tiles: MercatorTiles instance containing quadkeys</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>        max_workers: Maximum number of concurrent downloads</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=c1># self.data_store.makedirs(str(output_dir), exist_ok=True)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>    <span class=n>total_tiles</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> tiles with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>    <span class=p>)</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>def</span> <span class=nf>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get tile bounds from quadkey&quot;&quot;&quot;</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=n>tile</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>quadkey_to_tile</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=n>bounds</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>bounds</span><span class=p>(</span><span class=n>tile</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>return</span> <span class=p>[</span><span class=n>bounds</span><span class=o>.</span><span class=n>west</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>south</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>east</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>north</span><span class=p>]</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=n>bounds</span> <span class=o>=</span> <span class=n>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>quadkey</span><span class=si>}</span><span class=s2>.png&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_construct_url</span><span class=p>(</span><span class=n>bounds</span><span class=p>,</span> <span class=n>image_size_str</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=n>max_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=n>futures</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=n>download_image</span><span class=p>,</span> <span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>            <span class=k>for</span> <span class=n>quadkey</span> <span class=ow>in</span> <span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=p>]</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_tiles</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>            <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                <span class=k>if</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>():</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>                    <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>                <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.maxar_image class="doc doc-heading"> <code>maxar_image</code> <a href=#gigaspatial.handlers.maxar_image class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.maxar_image.MaxarConfig class="doc doc-heading"> <code>MaxarConfig</code> <a href=#gigaspatial.handlers.maxar_image.MaxarConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Configuration for Maxar Image Downloader using Pydantic</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span>
<span class=normal><a href=#__codelineno-0-96>96</a></span>
<span class=normal><a href=#__codelineno-0-97>97</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=k>class</span> <span class=nc>MaxarConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for Maxar Image Downloader using Pydantic&quot;&quot;&quot;</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>username</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>        <span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>MAXAR_USERNAME</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Maxar API username&quot;</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>password</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>MAXAR_PASSWORD</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Maxar API password&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>connection_string</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>MAXAR_CONNECTION_STRING</span><span class=p>,</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Maxar WMS connection string&quot;</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>base_url</span><span class=p>:</span> <span class=n>HttpUrl</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://evwhs.digitalglobe.com/mapservice/wmsaccess?&quot;</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Base URL for Maxar WMS service&quot;</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=p>)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>layers</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;DigitalGlobe:ImageryFootprint&quot;</span><span class=p>,</span> <span class=s2>&quot;DigitalGlobe:Imagery&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=n>default</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;DigitalGlobe:Imagery&quot;</span><span class=p>],</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;List of layers to request from WMS&quot;</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=n>feature_profile</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;Most_Aesthetic_Mosaic_Profile&quot;</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Feature profile to use for WMS requests&quot;</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=p>)</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>    <span class=n>coverage_cql_filter</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;CQL filter for coverage selection&quot;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>    <span class=n>exceptions</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;application/vnd.ogc.se_xml&quot;</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Exception handling format for WMS&quot;</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=p>)</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=n>transparent</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Whether the requested images should have transparency&quot;</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=n>image_format</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;image/png&quot;</span><span class=p>,</span> <span class=s2>&quot;image/jpeg&quot;</span><span class=p>,</span> <span class=s2>&quot;image/geotiff&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;image/png&quot;</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=p>)</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=n>data_crs</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span> <span class=s2>&quot;EPSG:3395&quot;</span><span class=p>,</span> <span class=s2>&quot;EPSG:3857&quot;</span><span class=p>,</span> <span class=s2>&quot;CAR:42004&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=n>max_retries</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>default</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Number of retries for failed image downloads&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=n>retry_delay</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Delay in seconds between retries&quot;</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;username&quot;</span><span class=p>,</span> <span class=s2>&quot;password&quot;</span><span class=p>,</span> <span class=s2>&quot;connection_string&quot;</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=k>def</span> <span class=nf>validate_non_empty</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>field</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Ensure required credentials are provided&quot;&quot;&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>value</span> <span class=ow>or</span> <span class=n>value</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;&quot;</span><span class=p>:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>field</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> cannot be empty. Please provide a valid </span><span class=si>{</span><span class=n>field</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>.&quot;</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=k>return</span> <span class=n>value</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=nd>@property</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>def</span> <span class=nf>wms_url</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Generate the full WMS URL with connection string&quot;&quot;&quot;</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>connectid=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>connection_string</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=nd>@property</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=k>def</span> <span class=nf>suffix</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;.</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>image_format</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.maxar_image.MaxarConfig.wms_url class="doc doc-heading"> <code class="highlight language-python"><span class=n>wms_url</span><span class=p>:</span> <span class=nb>str</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.maxar_image.MaxarConfig.wms_url class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Generate the full WMS URL with connection string</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.maxar_image.MaxarConfig.validate_non_empty class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_non_empty</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>field</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.maxar_image.MaxarConfig.validate_non_empty class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Ensure required credentials are provided</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;username&quot;</span><span class=p>,</span> <span class=s2>&quot;password&quot;</span><span class=p>,</span> <span class=s2>&quot;connection_string&quot;</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=nd>@classmethod</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=k>def</span> <span class=nf>validate_non_empty</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>field</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Ensure required credentials are provided&quot;&quot;&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>value</span> <span class=ow>or</span> <span class=n>value</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;&quot;</span><span class=p>:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>field</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> cannot be empty. Please provide a valid </span><span class=si>{</span><span class=n>field</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>.&quot;</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>    <span class=k>return</span> <span class=n>value</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.maxar_image.MaxarImageDownloader class="doc doc-heading"> <code>MaxarImageDownloader</code> <a href=#gigaspatial.handlers.maxar_image.MaxarImageDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Class to download images from Maxar</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=k>class</span> <span class=nc>MaxarImageDownloader</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Class to download images from Maxar&quot;&quot;&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MaxarConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=p>):</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>        Initialize the downloader with Maxar config.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>        Args:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>            config: MaxarConfig instance containing credentials and settings</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>            data_store: Instance of DataStore for accessing data storage</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>MaxarConfig</span><span class=p>()</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=bp>self</span><span class=o>.</span><span class=n>wms</span> <span class=o>=</span> <span class=n>WebMapService</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>wms_url</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=n>username</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>username</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=n>password</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>password</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>    <span class=k>def</span> <span class=nf>_download_single_image</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bbox</span><span class=p>,</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Path</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=n>size</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download a single image from bbox and pixel size&quot;&quot;&quot;</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=k>for</span> <span class=n>attempt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>max_retries</span><span class=p>):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=n>img_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>wms</span><span class=o>.</span><span class=n>getmap</span><span class=p>(</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                    <span class=n>bbox</span><span class=o>=</span><span class=n>bbox</span><span class=p>,</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                    <span class=n>layers</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>layers</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                    <span class=n>srs</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data_crs</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                    <span class=n>size</span><span class=o>=</span><span class=n>size</span><span class=p>,</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                    <span class=n>featureProfile</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>feature_profile</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                    <span class=n>coverage_cql_filter</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>coverage_cql_filter</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>                    <span class=n>exceptions</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>exceptions</span><span class=p>,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                    <span class=n>transparent</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>transparent</span><span class=p>,</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                    <span class=nb>format</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>image_format</span><span class=p>,</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span> <span class=n>img_data</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                    <span class=sa>f</span><span class=s2>&quot;Attempt </span><span class=si>{</span><span class=n>attempt</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> of downloading </span><span class=si>{</span><span class=n>output_path</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=k>if</span> <span class=n>attempt</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_retries</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                    <span class=n>sleep</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>retry_delay</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                        <span class=sa>f</span><span class=s2>&quot;Failed to download </span><span class=si>{</span><span class=n>output_path</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> after </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>max_retries</span><span class=si>}</span><span class=s2> attemps: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                    <span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                    <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>    <span class=k>def</span> <span class=nf>download_images_by_tiles</span><span class=p>(</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=n>mercator_tiles</span><span class=p>:</span> <span class=s2>&quot;MercatorTiles&quot;</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        Download images for given mercator tiles using the specified style</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        Args:</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>            mercator_tiles: MercatorTiles instance containing quadkeys</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>        <span class=n>total_tiles</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>            <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> tiles with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=k>def</span> <span class=nf>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><span class=w>            </span><span class=sd>&quot;&quot;&quot;Get tile bounds from quadkey&quot;&quot;&quot;</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=n>tile</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>quadkey_to_tile</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>bounds</span><span class=p>(</span><span class=n>tile</span><span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=k>return</span> <span class=p>(</span><span class=n>bounds</span><span class=o>.</span><span class=n>west</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>south</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>east</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>north</span><span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>            <span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>suffix</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>bounds</span> <span class=o>=</span> <span class=n>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>quadkey</span><span class=si>}{</span><span class=n>suffix</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                <span class=n>bounds</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>,</span> <span class=n>image_size</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>            <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_tiles</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>            <span class=k>for</span> <span class=n>quadkey</span> <span class=ow>in</span> <span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>:</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>                <span class=k>if</span> <span class=n>download_image</span><span class=p>(</span><span class=n>quadkey</span><span class=p>,</span> <span class=n>image_size</span><span class=p>):</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                    <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>                <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>        <span class=p>)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>    <span class=k>def</span> <span class=nf>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=n>gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>        Download images for given points using the specified style</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>        Args:</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>            gdf_points: GeoDataFrame containing bounding box polygons</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=n>total_images</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>gdf</span><span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>            <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=n>idx</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>            <span class=n>bounds</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=n>image_size</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>            <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>suffix</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>idx</span><span class=si>}{</span><span class=n>suffix</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=n>bounds</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>,</span> <span class=n>image_size</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>            <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data_crs</span><span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>        <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>        <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_images</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>            <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>itertuples</span><span class=p>():</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>                <span class=k>if</span> <span class=n>download_image</span><span class=p>(</span><span class=n>row</span><span class=o>.</span><span class=n>Index</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>bounds</span><span class=p>),</span> <span class=n>image_size</span><span class=p>):</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                    <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>                <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>            <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=k>def</span> <span class=nf>download_images_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>res_meters_pixel</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=sd>        Download images for given coordinates by creating bounded boxes around points</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>        Args:</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>            data: Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><span class=sd>            res_meters_pixel: resolution in meters per pixel</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><span class=sd>            output_dir: Directory to save images</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><span class=sd>            image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=sd>            image_prefix: Prefix for output image names</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>            <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>data</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>            <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>])</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>coordinates_df</span><span class=p>)</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>            <span class=n>gdf</span><span class=p>,</span> <span class=n>res_meters_pixel</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;square&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>        <span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffered_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data_crs</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=bp>self</span><span class=o>.</span><span class=n>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>            <span class=n>buffered_gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=p>,</span> <span class=n>image_prefix</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.maxar_image.MaxarImageDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.maxar_image.MaxarImageDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader with Maxar config.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.maxar_image.MaxarConfig" href="#gigaspatial.handlers.maxar_image.MaxarConfig">MaxarConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>MaxarConfig instance containing credentials and settings</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Instance of DataStore for accessing data storage</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MaxarConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=p>):</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    Initialize the downloader with Maxar config.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    Args:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>        config: MaxarConfig instance containing credentials and settings</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>        data_store: Instance of DataStore for accessing data storage</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>MaxarConfig</span><span class=p>()</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>    <span class=bp>self</span><span class=o>.</span><span class=n>wms</span> <span class=o>=</span> <span class=n>WebMapService</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>wms_url</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>username</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>username</span><span class=p>,</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=n>password</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>password</span><span class=p>,</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_bounds class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_bounds</span><span class=p>(</span><span class=n>gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;maxar_image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_bounds class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given points using the specified style</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>gdf_points</code></td> <td> </td> <td> <div class=doc-md-description> <p>GeoDataFrame containing bounding box polygons</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;maxar_image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=k>def</span> <span class=nf>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>    <span class=n>gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>    Download images for given points using the specified style</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>    Args:</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>        gdf_points: GeoDataFrame containing bounding box polygons</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>    <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>    <span class=n>total_images</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>gdf</span><span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=n>idx</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>        <span class=n>bounds</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=n>image_size</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>suffix</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>idx</span><span class=si>}{</span><span class=n>suffix</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>            <span class=n>bounds</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>,</span> <span class=n>image_size</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>        <span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>        <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>    <span class=n>gdf</span> <span class=o>=</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data_crs</span><span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>    <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>    <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_images</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>gdf</span><span class=o>.</span><span class=n>itertuples</span><span class=p>():</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>            <span class=k>if</span> <span class=n>download_image</span><span class=p>(</span><span class=n>row</span><span class=o>.</span><span class=n>Index</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>bounds</span><span class=p>),</span> <span class=n>image_size</span><span class=p>):</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_images</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_coordinates class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_coordinates</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>res_meters_pixel</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;maxar_image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_coordinates class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given coordinates by creating bounded boxes around points</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[float, float]]]</code> </td> <td> <div class=doc-md-description> <p>Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>res_meters_pixel</code></td> <td> <code>float</code> </td> <td> <div class=doc-md-description> <p>resolution in meters per pixel</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;maxar_image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=k>def</span> <span class=nf>download_images_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>    <span class=n>res_meters_pixel</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=sd>    Download images for given coordinates by creating bounded boxes around points</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>    Args:</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>        data: Either a DataFrame with either latitude/longitude columns or a geometry column or a list of (lat, lon) tuples</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><span class=sd>        res_meters_pixel: resolution in meters per pixel</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>        <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>data</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=n>coordinates_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>])</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=n>gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>coordinates_df</span><span class=p>)</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>    <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=n>gdf</span><span class=p>,</span> <span class=n>res_meters_pixel</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;square&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=n>buffered_gdf</span> <span class=o>=</span> <span class=n>buffered_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data_crs</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>    <span class=bp>self</span><span class=o>.</span><span class=n>download_images_by_bounds</span><span class=p>(</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=n>buffered_gdf</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=p>,</span> <span class=n>image_prefix</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_tiles class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_images_by_tiles</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>,</span> <span class=n>image_size</span><span class=o>=</span><span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span> <span class=n>image_prefix</span><span class=o>=</span><span class=s1>&#39;maxar_image_&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.maxar_image.MaxarImageDownloader.download_images_by_tiles class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download images for given mercator tiles using the specified style</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>mercator_tiles</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.grid.mercator_tiles.MercatorTiles" href="../grid/#gigaspatial.grid.mercator_tiles.MercatorTiles">MercatorTiles</a></code> </td> <td> <div class=doc-md-description> <p>MercatorTiles instance containing quadkeys</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_dir</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code> </td> <td> <div class=doc-md-description> <p>Directory to save images</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>image_size</code></td> <td> <code><span title="typing.Tuple">Tuple</span>[int, int]</code> </td> <td> <div class=doc-md-description> <p>Tuple of (width, height) for output images</p> </div> </td> <td> <code>(512, 512)</code> </td> </tr> <tr class=doc-section-item> <td><code>image_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for output image names</p> </div> </td> <td> <code>&#39;maxar_image_&#39;</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/maxar_image.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=k>def</span> <span class=nf>download_images_by_tiles</span><span class=p>(</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>    <span class=n>mercator_tiles</span><span class=p>:</span> <span class=s2>&quot;MercatorTiles&quot;</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=n>output_dir</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>    <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>512</span><span class=p>,</span> <span class=mi>512</span><span class=p>),</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>    <span class=n>image_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;maxar_image_&quot;</span><span class=p>,</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    Download images for given mercator tiles using the specified style</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>    Args:</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        mercator_tiles: MercatorTiles instance containing quadkeys</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        output_dir: Directory to save images</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        image_size: Tuple of (width, height) for output images</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>        image_prefix: Prefix for output image names</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>    <span class=n>image_size_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>image_size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=n>total_tiles</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> tiles with size </span><span class=si>{</span><span class=n>image_size_str</span><span class=si>}</span><span class=s2>...&quot;</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=k>def</span> <span class=nf>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get tile bounds from quadkey&quot;&quot;&quot;</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>tile</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>quadkey_to_tile</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=n>bounds</span> <span class=o>=</span> <span class=n>mercantile</span><span class=o>.</span><span class=n>bounds</span><span class=p>(</span><span class=n>tile</span><span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=k>return</span> <span class=p>(</span><span class=n>bounds</span><span class=o>.</span><span class=n>west</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>south</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>east</span><span class=p>,</span> <span class=n>bounds</span><span class=o>.</span><span class=n>north</span><span class=p>)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=k>def</span> <span class=nf>download_image</span><span class=p>(</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=n>quadkey</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>image_size</span><span class=p>:</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>],</span> <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>suffix</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=n>bounds</span> <span class=o>=</span> <span class=n>_get_tile_bounds</span><span class=p>(</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=n>file_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>image_prefix</span><span class=si>}{</span><span class=n>quadkey</span><span class=si>}{</span><span class=n>suffix</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_download_single_image</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>            <span class=n>bounds</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=n>file_name</span><span class=p>,</span> <span class=n>image_size</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=k>return</span> <span class=n>success</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=n>successful_downloads</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>total</span><span class=o>=</span><span class=n>total_tiles</span><span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=k>for</span> <span class=n>quadkey</span> <span class=ow>in</span> <span class=n>mercator_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>:</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>            <span class=k>if</span> <span class=n>download_image</span><span class=p>(</span><span class=n>quadkey</span><span class=p>,</span> <span class=n>image_size</span><span class=p>):</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                <span class=n>successful_downloads</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>            <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=sa>f</span><span class=s2>&quot;Successfully downloaded </span><span class=si>{</span><span class=n>successful_downloads</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>total_tiles</span><span class=si>}</span><span class=s2> images!&quot;</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.microsoft_global_buildings class="doc doc-heading"> <code>microsoft_global_buildings</code> <a href=#gigaspatial.handlers.microsoft_global_buildings class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig class="doc doc-heading"> <code>MSBuildingsConfig</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerConfig" href="#gigaspatial.handlers.base.BaseHandlerConfig">BaseHandlerConfig</a></code></p> <p>Configuration for Microsoft Global Buildings dataset files.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>ConfigDict</span><span class=p>(</span><span class=n>arbitrary_types_allowed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=k>class</span> <span class=nc>MSBuildingsConfig</span><span class=p>(</span><span class=n>BaseHandlerConfig</span><span class=p>):</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for Microsoft Global Buildings dataset files.&quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>TILE_URLS</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=s2>&quot;https://minedbuildings.z5.web.core.windows.net/global-buildings/dataset-links.csv&quot;</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>MERCATOR_ZOOM_LEVEL</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>9</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;microsoft_global_buildings&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=n>LOCATION_MAPPING_FILE</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>base_path</span> <span class=o>/</span> <span class=s2>&quot;location_mapping.json&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>SIMILARITY_SCORE</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.8</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=n>DEFAULT_MAPPING</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=n>default_factory</span><span class=o>=</span><span class=k>lambda</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>            <span class=s2>&quot;Bonaire&quot;</span><span class=p>:</span> <span class=s2>&quot;BES&quot;</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>            <span class=s2>&quot;Brunei&quot;</span><span class=p>:</span> <span class=s2>&quot;BRN&quot;</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>            <span class=s2>&quot;IvoryCoast&quot;</span><span class=p>:</span> <span class=s2>&quot;CIV&quot;</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>            <span class=s2>&quot;CongoDRC&quot;</span><span class=p>:</span> <span class=s2>&quot;COD&quot;</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>            <span class=s2>&quot;DemocraticRepublicoftheCongo&quot;</span><span class=p>:</span> <span class=s2>&quot;COD&quot;</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>            <span class=s2>&quot;RepublicoftheCongo&quot;</span><span class=p>:</span> <span class=s2>&quot;COG&quot;</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=s2>&quot;TheGambia&quot;</span><span class=p>:</span> <span class=s2>&quot;GMB&quot;</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=s2>&quot;FYROMakedonija&quot;</span><span class=p>:</span> <span class=s2>&quot;MKD&quot;</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>            <span class=s2>&quot;SultanateofOman&quot;</span><span class=p>:</span> <span class=s2>&quot;OMN&quot;</span><span class=p>,</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=s2>&quot;StateofQatar&quot;</span><span class=p>:</span> <span class=s2>&quot;QAT&quot;</span><span class=p>,</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>            <span class=s2>&quot;Russia&quot;</span><span class=p>:</span> <span class=s2>&quot;RUS&quot;</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=s2>&quot;KingdomofSaudiArabia&quot;</span><span class=p>:</span> <span class=s2>&quot;SAU&quot;</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=s2>&quot;Svalbard&quot;</span><span class=p>:</span> <span class=s2>&quot;SJM&quot;</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=s2>&quot;Swaziland&quot;</span><span class=p>:</span> <span class=s2>&quot;SWZ&quot;</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>            <span class=s2>&quot;StMartin&quot;</span><span class=p>:</span> <span class=s2>&quot;SXM&quot;</span><span class=p>,</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=s2>&quot;leSaint-Martin&quot;</span><span class=p>:</span> <span class=s2>&quot;MAF&quot;</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>            <span class=s2>&quot;Turkey&quot;</span><span class=p>:</span> <span class=s2>&quot;TUR&quot;</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=s2>&quot;VaticanCity&quot;</span><span class=p>:</span> <span class=s2>&quot;VAT&quot;</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>            <span class=s2>&quot;BritishVirginIslands&quot;</span><span class=p>:</span> <span class=s2>&quot;VGB&quot;</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>            <span class=s2>&quot;USVirginIslands&quot;</span><span class=p>:</span> <span class=s2>&quot;VIR&quot;</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>            <span class=s2>&quot;RepublicofYemen&quot;</span><span class=p>:</span> <span class=s2>&quot;YEM&quot;</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>            <span class=s2>&quot;CzechRepublic&quot;</span><span class=p>:</span> <span class=s2>&quot;CZE&quot;</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=s2>&quot;French-Martinique&quot;</span><span class=p>:</span> <span class=s2>&quot;MTQ&quot;</span><span class=p>,</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>            <span class=s2>&quot;French-Guadeloupe&quot;</span><span class=p>:</span> <span class=s2>&quot;GLP&quot;</span><span class=p>,</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>            <span class=s2>&quot;UnitedStates&quot;</span><span class=p>:</span> <span class=s2>&quot;USA&quot;</span><span class=p>,</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=p>}</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=n>CUSTOM_MAPPING</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the configuration, load tile URLs, and set up location mapping.&quot;&quot;&quot;</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__post_init__</span><span class=p>()</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_load_tile_urls</span><span class=p>()</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=bp>self</span><span class=o>.</span><span class=n>upload_date</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>upload_date</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_setup_location_mapping</span><span class=p>()</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>    <span class=k>def</span> <span class=nf>_load_tile_urls</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load dataset links from csv file.&quot;&quot;&quot;</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=bp>self</span><span class=o>.</span><span class=n>TILE_URLS</span><span class=p>,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;location&quot;</span><span class=p>,</span> <span class=s2>&quot;quadkey&quot;</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>,</span> <span class=s2>&quot;size&quot;</span><span class=p>,</span> <span class=s2>&quot;upload_date&quot;</span><span class=p>],</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=n>dtype</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;quadkey&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>},</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=n>header</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=k>def</span> <span class=nf>_setup_location_mapping</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load or create the mapping between dataset locations and ISO country codes.&quot;&quot;&quot;</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=kn>from</span> <span class=nn>gigaspatial.core.io.readers</span> <span class=kn>import</span> <span class=n>read_json</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=kn>from</span> <span class=nn>gigaspatial.core.io.writers</span> <span class=kn>import</span> <span class=n>write_json</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>LOCATION_MAPPING_FILE</span><span class=p>)):</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span> <span class=o>=</span> <span class=n>read_json</span><span class=p>(</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>                <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>LOCATION_MAPPING_FILE</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_location_mapping</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=n>similarity_score_threshold</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>SIMILARITY_SCORE</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>DEFAULT_MAPPING</span><span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>            <span class=n>write_json</span><span class=p>(</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>                <span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>LOCATION_MAPPING_FILE</span><span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>CUSTOM_MAPPING</span> <span class=ow>or</span> <span class=p>{})</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_map_locations</span><span class=p>()</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>isnull</span><span class=p>(),</span> <span class=s2>&quot;country&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=k>def</span> <span class=nf>_map_locations</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map the &#39;location&#39; column in the tiles DataFrame to ISO country codes.&quot;&quot;&quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=p>[</span><span class=s2>&quot;country&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>location</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>location_mapping</span><span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=k>def</span> <span class=nf>create_location_mapping</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>similarity_score_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.8</span><span class=p>):</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        Create a mapping between the dataset&#39;s location names and ISO 3166-1 alpha-3 country codes.</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        This function iterates through known countries and attempts to find matching</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        locations in the dataset based on string similarity.</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        Args:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>            similarity_score_threshold: The minimum similarity score (between 0 and 1)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>                                        for a dataset location to be considered a match</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>                                        for a country. Defaults to 0.8.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        Returns:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>            A dictionary where keys are dataset location names and values are</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>            the corresponding ISO 3166-1 alpha-3 country codes.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>        <span class=k>def</span> <span class=nf>similar</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=k>return</span> <span class=n>SequenceMatcher</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span><span class=o>.</span><span class=n>ratio</span><span class=p>()</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=n>location_mapping</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=p>:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>            <span class=k>if</span> <span class=n>country</span><span class=o>.</span><span class=n>name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>location</span><span class=o>.</span><span class=n>unique</span><span class=p>():</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                    <span class=n>country_quadkey</span> <span class=o>=</span> <span class=n>CountryMercatorTiles</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                        <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>MERCATOR_ZOOM_LEVEL</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                    <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                    <span class=k>continue</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                <span class=n>country_datasets</span> <span class=o>=</span> <span class=n>country_quadkey</span><span class=o>.</span><span class=n>filter_quadkeys</span><span class=p>(</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                <span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                <span class=n>matching_locations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=p>[</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>country_datasets</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>                <span class=p>]</span><span class=o>.</span><span class=n>location</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                <span class=n>scores</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                    <span class=p>[</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                        <span class=p>(</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                            <span class=n>similar</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>common_name</span><span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=s2>&quot;common_name&quot;</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                            <span class=k>else</span> <span class=n>similar</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                        <span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>matching_locations</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                    <span class=p>]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                <span class=p>)</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>scores</span> <span class=o>&gt;</span> <span class=n>similarity_score_threshold</span><span class=p>):</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                    <span class=n>matched</span> <span class=o>=</span> <span class=n>matching_locations</span><span class=p>[</span><span class=n>scores</span> <span class=o>&gt;</span> <span class=n>similarity_score_threshold</span><span class=p>]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>matched</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                            <span class=sa>f</span><span class=s2>&quot;Multiple matches exist for </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                        <span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                    <span class=n>location_mapping</span><span class=p>[</span><span class=n>matched</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> matched with </span><span class=si>{</span><span class=n>matched</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                        <span class=sa>f</span><span class=s2>&quot;No direct matches for </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>                    <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Possible matches are: &quot;</span><span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                    <span class=k>for</span> <span class=n>c</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>matching_locations</span><span class=p>,</span> <span class=n>scores</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                <span class=n>location_mapping</span><span class=p>[</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=k>return</span> <span class=n>location_mapping</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>        Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>        Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>    <span class=k>def</span> <span class=nf>get_relevant_data_units_by_country</span><span class=p>(</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>        Return intersecting tiles for a given country.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>country</span><span class=p>)</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>    <span class=k>def</span> <span class=nf>get_data_unit_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=n>tile_location</span> <span class=o>=</span> <span class=n>unit</span><span class=p>[</span><span class=s2>&quot;country&quot;</span><span class=p>]</span> <span class=k>if</span> <span class=n>unit</span><span class=p>[</span><span class=s2>&quot;country&quot;</span><span class=p>]</span> <span class=k>else</span> <span class=n>unit</span><span class=p>[</span><span class=s2>&quot;location&quot;</span><span class=p>]</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>            <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>            <span class=o>/</span> <span class=n>tile_location</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>upload_date</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>            <span class=o>/</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>unit</span><span class=p>[</span><span class=s2>&quot;quadkey&quot;</span><span class=p>]</span><span class=si>}</span><span class=s1>.csv.gz&#39;</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>    <span class=k>def</span> <span class=nf>get_data_unit_paths</span><span class=p>(</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>units</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>dict</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>units</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>row</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>units</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>get_data_unit_paths</span><span class=p>(</span><span class=n>units</span><span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=k>def</span> <span class=nf>_get_relevant_tiles</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>  <span class=c1># points</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>        <span class=p>],</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>        Get the DataFrame of Microsoft Buildings tiles that intersect with a given source spatial geometry.</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>        In case country given, this method first tries to find tiles directly mapped to the given country.</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>        If no directly mapped tiles are found and the country is not in the location</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        mapping, it attempts to find overlapping tiles by creating Mercator tiles</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>        for the country and filtering the dataset&#39;s tiles.</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        Args:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>            source: A country code/name, a Shapely geometry, a GeoDataFrame, or a list of Point</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>                    objects or (lat, lon) tuples representing the area of interest.</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>                    The coordinates are assumed to be in EPSG:4326.</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>        Returns:</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>            A pandas DataFrame containing the rows from the tiles list that</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>            spatially intersect with the `source`. Returns an empty DataFrame</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>            if no intersecting tiles are found.</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>                <span class=n>country_code</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>source</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Invalid`country` value!&quot;</span><span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>            <span class=n>mask</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=p>[</span><span class=s2>&quot;country&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=n>country_code</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>            <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>mask</span><span class=p>):</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>                    <span class=n>mask</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;quadkey&quot;</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>,</span> <span class=s2>&quot;country&quot;</span><span class=p>,</span> <span class=s2>&quot;location&quot;</span><span class=p>]</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>                <span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>                <span class=sa>f</span><span class=s2>&quot;The country code &#39;</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>&#39; is not directly in the location mapping. &quot;</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>                <span class=s2>&quot;Manually checking for overlapping locations with the country boundary.&quot;</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>            <span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>            <span class=n>source_tiles</span> <span class=o>=</span> <span class=n>CountryMercatorTiles</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>                <span class=n>country_code</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>MERCATOR_ZOOM_LEVEL</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>            <span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>            <span class=n>source_tiles</span> <span class=o>=</span> <span class=n>MercatorTiles</span><span class=o>.</span><span class=n>from_spatial</span><span class=p>(</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>                <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>zoom_level</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>MERCATOR_ZOOM_LEVEL</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>            <span class=p>)</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=n>filtered_tiles</span> <span class=o>=</span> <span class=n>source_tiles</span><span class=o>.</span><span class=n>filter_quadkeys</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span><span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=n>mask</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>filtered_tiles</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>            <span class=n>mask</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;quadkey&quot;</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>,</span> <span class=s2>&quot;country&quot;</span><span class=p>,</span> <span class=s2>&quot;location&quot;</span><span class=p>]</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=s2>&quot;records&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.__post_init__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__post_init__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.__post_init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the configuration, load tile URLs, and set up location mapping.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the configuration, load tile URLs, and set up location mapping.&quot;&quot;&quot;</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>__post_init__</span><span class=p>()</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_load_tile_urls</span><span class=p>()</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=bp>self</span><span class=o>.</span><span class=n>upload_date</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>upload_date</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_setup_location_mapping</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.create_location_mapping class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_location_mapping</span><span class=p>(</span><span class=n>similarity_score_threshold</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.create_location_mapping class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create a mapping between the dataset's location names and ISO 3166-1 alpha-3 country codes.</p> <p>This function iterates through known countries and attempts to find matching locations in the dataset based on string similarity.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>similarity_score_threshold</code></td> <td> <code>float</code> </td> <td> <div class=doc-md-description> <p>The minimum similarity score (between 0 and 1) for a dataset location to be considered a match for a country. Defaults to 0.8.</p> </div> </td> <td> <code>0.8</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>A dictionary where keys are dataset location names and values are</p> </div> </td> </tr> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>the corresponding ISO 3166-1 alpha-3 country codes.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=k>def</span> <span class=nf>create_location_mapping</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>similarity_score_threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.8</span><span class=p>):</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    Create a mapping between the dataset&#39;s location names and ISO 3166-1 alpha-3 country codes.</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>    This function iterates through known countries and attempts to find matching</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    locations in the dataset based on string similarity.</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>    Args:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        similarity_score_threshold: The minimum similarity score (between 0 and 1)</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>                                    for a dataset location to be considered a match</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>                                    for a country. Defaults to 0.8.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    Returns:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        A dictionary where keys are dataset location names and values are</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        the corresponding ISO 3166-1 alpha-3 country codes.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>    <span class=k>def</span> <span class=nf>similar</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=k>return</span> <span class=n>SequenceMatcher</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span><span class=o>.</span><span class=n>ratio</span><span class=p>()</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=n>location_mapping</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=p>:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=k>if</span> <span class=n>country</span><span class=o>.</span><span class=n>name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>location</span><span class=o>.</span><span class=n>unique</span><span class=p>():</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=n>country_quadkey</span> <span class=o>=</span> <span class=n>CountryMercatorTiles</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                    <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>MERCATOR_ZOOM_LEVEL</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                <span class=k>continue</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>            <span class=n>country_datasets</span> <span class=o>=</span> <span class=n>country_quadkey</span><span class=o>.</span><span class=n>filter_quadkeys</span><span class=p>(</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>            <span class=p>)</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>            <span class=n>matching_locations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=p>[</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                <span class=bp>self</span><span class=o>.</span><span class=n>df_tiles</span><span class=o>.</span><span class=n>quadkey</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>country_datasets</span><span class=o>.</span><span class=n>quadkeys</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>            <span class=p>]</span><span class=o>.</span><span class=n>location</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>            <span class=n>scores</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                <span class=p>[</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                    <span class=p>(</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                        <span class=n>similar</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>common_name</span><span class=p>)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=s2>&quot;common_name&quot;</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                        <span class=k>else</span> <span class=n>similar</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                    <span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>matching_locations</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                <span class=p>]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>            <span class=p>)</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>            <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>scores</span> <span class=o>&gt;</span> <span class=n>similarity_score_threshold</span><span class=p>):</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                <span class=n>matched</span> <span class=o>=</span> <span class=n>matching_locations</span><span class=p>[</span><span class=n>scores</span> <span class=o>&gt;</span> <span class=n>similarity_score_threshold</span><span class=p>]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>matched</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                        <span class=sa>f</span><span class=s2>&quot;Multiple matches exist for </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                    <span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                <span class=n>location_mapping</span><span class=p>[</span><span class=n>matched</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> matched with </span><span class=si>{</span><span class=n>matched</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>!&quot;</span><span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                    <span class=sa>f</span><span class=s2>&quot;No direct matches for </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is not mapped.&quot;</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>                <span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Possible matches are: &quot;</span><span class=p>)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=k>for</span> <span class=n>c</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>matching_locations</span><span class=p>,</span> <span class=n>scores</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=n>location_mapping</span><span class=p>[</span><span class=n>country</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=k>return</span> <span class=n>location_mapping</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a given country.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_country</span><span class=p>(</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>    Return intersecting tiles for a given country.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>country</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_geometry class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_geometry</span><span class=p>(</span><span class=n>geometry</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_geometry class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a given geometry or GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_geometry</span><span class=p>(</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>geometry</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>    Return intersecting tiles for a given geometry or GeoDataFrame.</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>geometry</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_relevant_data_units_by_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig.get_relevant_data_units_by_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Return intersecting tiles for a list of points.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=k>def</span> <span class=nf>get_relevant_data_units_by_points</span><span class=p>(</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>    Return intersecting tiles for a list of points.</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_relevant_tiles</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader class="doc doc-heading"> <code>MSBuildingsDownloader</code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerDownloader" href="#gigaspatial.handlers.base.BaseHandlerDownloader">BaseHandlerDownloader</a></code></p> <p>A class to handle downloads of Microsoft's Global ML Building Footprints dataset.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=k>class</span> <span class=nc>MSBuildingsDownloader</span><span class=p>(</span><span class=n>BaseHandlerDownloader</span><span class=p>):</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;A class to handle downloads of Microsoft&#39;s Global ML Building Footprints dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>    <span class=p>):</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>        Initialize the downloader.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>        Args:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>            config: Optional configuration for customizing download behavior and file paths.</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>                    If None, a default `MSBuildingsConfig` is used.</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>            data_store: Optional instance of a `DataStore` for managing data storage.</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>                        If provided, it overrides the `data_store` in the `config`.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>                        If None, the `data_store` from the `config` is used.</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>            logger: Optional custom logger instance. If None, a default logger</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>                    named after the module is created and used.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>MSBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=n>tile_info</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download data file for a single tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>        <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;url&quot;</span><span class=p>]</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>tile_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>            <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>tile_info</span><span class=p>))</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>                    <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>                    <span class=sa>f</span><span class=s2>&quot;Successfully downloaded tile: </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;quadkey&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>                <span class=p>)</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>                <span class=k>return</span> <span class=n>file_path</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>                <span class=sa>f</span><span class=s2>&quot;Failed to download tile </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;quadkey&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>            <span class=p>)</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>    <span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>        <span class=n>tiles</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]],</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download data files for multiple tiles.&quot;&quot;&quot;</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;There is no matching data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>        <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>            <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>)</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>            <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>                <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>                    <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>                        <span class=n>download_func</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>                        <span class=p>(</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>                            <span class=p>[</span><span class=n>row</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>tiles</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>                            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>                            <span class=k>else</span> <span class=n>tiles</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>                        <span class=p>),</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>                    <span class=p>),</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>                    <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>),</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>                    <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading polygons data&quot;</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>                <span class=p>)</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>            <span class=p>)</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>        <span class=k>return</span> <span class=p>[</span><span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>file_paths</span> <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>    <span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>        <span class=p>],</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=sd>        Download Microsoft Global ML Building Footprints data for a specified geographic region.</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><span class=sd>        The region can be defined by a country, a list of points,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><span class=sd>        a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=sd>        relevant data tiles intersecting the region and downloads them in parallel.</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=sd>        Args:</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><span class=sd>            source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>                    Can be:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=sd>                      - A string representing a country code or name.</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>                      - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>                      - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>                      - A GeoDataFrame with a geometry column in EPSG:4326.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>            **kwargs: Additional parameters passed to data unit resolution methods</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>        Returns:</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>            Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>            all downloads fail.</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>        <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>    <span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>        <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>        Download Microsoft Global ML Building Footprints data for a specific country.</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>        This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>        using its code or name.</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>        Args:</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>            country: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>            data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>                `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><span class=sd>                `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>            country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>                country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>                instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>        Returns:</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>            A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>            Returns an empty list if no data is found for the country or if</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>            all downloads fail.</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>            <span class=n>source</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig">MSBuildingsConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional configuration for customizing download behavior and file paths. If None, a default <code>MSBuildingsConfig</code> is used.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional instance of a <code>DataStore</code> for managing data storage. If provided, it overrides the <code>data_store</code> in the <code>config</code>. If None, the <code>data_store</code> from the <code>config</code> is used.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional custom logger instance. If None, a default logger named after the module is created and used.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=p>):</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>    Initialize the downloader.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>    Args:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>        config: Optional configuration for customizing download behavior and file paths.</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>                If None, a default `MSBuildingsConfig` is used.</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>        data_store: Optional instance of a `DataStore` for managing data storage.</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>                    If provided, it overrides the `data_store` in the `config`.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>                    If None, the `data_store` from the `config` is used.</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>        logger: Optional custom logger instance. If None, a default logger</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>                named after the module is created and used.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>MSBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download class="doc doc-heading"> <code class="highlight language-python"><span class=n>download</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download Microsoft Global ML Building Footprints data for a specified geographic region.</p> <p>The region can be defined by a country, a list of points, a Shapely geometry, or a GeoDataFrame. This method identifies the relevant data tiles intersecting the region and downloads them in parallel.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>source</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[float, float], <span title="shapely.geometry.Point">Point</span>]], <span title="shapely.geometry.base.BaseGeometry">BaseGeometry</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>Defines the geographic area for which to download data. Can be: - A string representing a country code or name. - A list of (latitude, longitude) tuples or Shapely Point objects. - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon). - A GeoDataFrame with a geometry column in EPSG:4326.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters passed to data unit resolution methods</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Returns an empty list if no data is found for the region or if</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>all downloads fail.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><span class=k>def</span> <span class=nf>download</span><span class=p>(</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>    <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>        <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>        <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>],</span> <span class=n>Point</span><span class=p>]],</span>  <span class=c1># points</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>        <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geoms</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>        <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>    <span class=p>],</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=sd>    Download Microsoft Global ML Building Footprints data for a specified geographic region.</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><span class=sd>    The region can be defined by a country, a list of points,</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><span class=sd>    a Shapely geometry, or a GeoDataFrame. This method identifies the</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=sd>    relevant data tiles intersecting the region and downloads them in parallel.</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=sd>    Args:</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><span class=sd>        source: Defines the geographic area for which to download data.</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>                Can be:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=sd>                  - A string representing a country code or name.</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>                  - A list of (latitude, longitude) tuples or Shapely Point objects.</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>                  - A Shapely BaseGeometry object (e.g., Polygon, MultiPolygon).</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>                  - A GeoDataFrame with a geometry column in EPSG:4326.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>        **kwargs: Additional parameters passed to data unit resolution methods</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>    Returns:</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>        Returns an empty list if no data is found for the region or if</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>        all downloads fail.</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>    <span class=n>tiles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_relevant_data_units</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_by_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_by_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>country_geom_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_by_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download Microsoft Global ML Building Footprints data for a specific country.</p> <p>This is a convenience method to download data for an entire country using its code or name.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>country</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The country code (e.g., 'USA', 'GBR') or name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional instance of a <code>DataStore</code> to be used by <code>AdminBoundaries</code> for loading country boundaries. If None, <code>AdminBoundaries</code> will use its default data loading.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>country_geom_path</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]]</code> </td> <td> <div class=doc-md-description> <p>Optional path to a GeoJSON file containing the country boundary. If provided, this boundary is used instead of the default from <code>AdminBoundaries</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>A list of local file paths for the successfully downloaded tiles.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>Returns an empty list if no data is found for the country or if</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>all downloads fail.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=k>def</span> <span class=nf>download_by_country</span><span class=p>(</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>    <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>    Download Microsoft Global ML Building Footprints data for a specific country.</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>    This is a convenience method to download data for an entire country</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>    using its code or name.</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>    Args:</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>        country: The country code (e.g., &#39;USA&#39;, &#39;GBR&#39;) or name.</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>        data_store: Optional instance of a `DataStore` to be used by</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>            `AdminBoundaries` for loading country boundaries. If None,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><span class=sd>            `AdminBoundaries` will use its default data loading.</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=sd>        country_geom_path: Optional path to a GeoJSON file containing the</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>            country boundary. If provided, this boundary is used</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>            instead of the default from `AdminBoundaries`.</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>    Returns:</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>        A list of local file paths for the successfully downloaded tiles.</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>        Returns an empty list if no data is found for the country or if</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>        all downloads fail.</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>download</span><span class=p>(</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>        <span class=n>source</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=o>=</span><span class=n>country_geom_path</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_data_unit class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_unit</span><span class=p>(</span><span class=n>tile_info</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_data_unit class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download data file for a single tile.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a><span class=k>def</span> <span class=nf>download_data_unit</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>    <span class=n>tile_info</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download data file for a single tile.&quot;&quot;&quot;</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>    <span class=n>tile_url</span> <span class=o>=</span> <span class=n>tile_info</span><span class=p>[</span><span class=s2>&quot;url&quot;</span><span class=p>]</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>tile_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>        <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get_data_unit_path</span><span class=p>(</span><span class=n>tile_info</span><span class=p>))</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>        <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>            <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>                <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>                <span class=sa>f</span><span class=s2>&quot;Successfully downloaded tile: </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;quadkey&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>            <span class=p>)</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>            <span class=k>return</span> <span class=n>file_path</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>            <span class=sa>f</span><span class=s2>&quot;Failed to download tile </span><span class=si>{</span><span class=n>tile_info</span><span class=p>[</span><span class=s1>&#39;quadkey&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>        <span class=p>)</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_data_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_data_units</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader.download_data_units class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download data files for multiple tiles.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=k>def</span> <span class=nf>download_data_units</span><span class=p>(</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>    <span class=n>tiles</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>]],</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download data files for multiple tiles.&quot;&quot;&quot;</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;There is no matching data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>    <span class=k>with</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>n_workers</span><span class=p>)</span> <span class=k>as</span> <span class=n>pool</span><span class=p>:</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>        <span class=n>download_func</span> <span class=o>=</span> <span class=n>functools</span><span class=o>.</span><span class=n>partial</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>download_data_unit</span><span class=p>)</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=n>file_paths</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>            <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>                <span class=n>pool</span><span class=o>.</span><span class=n>imap</span><span class=p>(</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>                    <span class=n>download_func</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>                    <span class=p>(</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>                        <span class=p>[</span><span class=n>row</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>tiles</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>                        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tiles</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>                        <span class=k>else</span> <span class=n>tiles</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>                    <span class=p>),</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>                <span class=p>),</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>                <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>tiles</span><span class=p>),</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>                <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading polygons data&quot;</span><span class=p>,</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>            <span class=p>)</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>        <span class=p>)</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>    <span class=k>return</span> <span class=p>[</span><span class=n>path</span> <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>file_paths</span> <span class=k>if</span> <span class=n>path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler class="doc doc-heading"> <code>MSBuildingsHandler</code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandler" href="#gigaspatial.handlers.base.BaseHandler">BaseHandler</a></code></p> <p>Handler for Microsoft Global Buildings dataset.</p> <p>This class provides a unified interface for downloading and loading Microsoft Global Buildings data. It manages the lifecycle of configuration, downloading, and reading components.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a><span class=k>class</span> <span class=nc>MSBuildingsHandler</span><span class=p>(</span><span class=n>BaseHandler</span><span class=p>):</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a><span class=sd>    Handler for Microsoft Global Buildings dataset.</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a><span class=sd>    This class provides a unified interface for downloading and loading Microsoft Global Buildings data.</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=sd>    It manages the lifecycle of configuration, downloading, and reading components.</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a>    <span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsConfig</span><span class=p>:</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>        Create and return a MSBuildingsConfig instance.</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a><span class=sd>        Args:</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>            **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>        Returns:</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>            Configured MSBuildingsConfig instance</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>        <span class=k>return</span> <span class=n>MSBuildingsConfig</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a>    <span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a>        <span class=n>config</span><span class=p>:</span> <span class=n>MSBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsDownloader</span><span class=p>:</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a><span class=sd>        Create and return a MSBuildingsDownloader instance.</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=sd>        Args:</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a><span class=sd>            **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>        Returns:</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=sd>            Configured MSBuildingsDownloader instance</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a>        <span class=k>return</span> <span class=n>MSBuildingsDownloader</span><span class=p>(</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a>        <span class=p>)</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a>    <span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a>        <span class=n>config</span><span class=p>:</span> <span class=n>MSBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsReader</span><span class=p>:</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a><span class=sd>        Create and return a MSBuildingsReader instance.</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=sd>        Args:</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a><span class=sd>            config: The configuration object</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a><span class=sd>            data_store: The data store instance to use</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a><span class=sd>            logger: The logger instance to use</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a><span class=sd>            **kwargs: Additional reader parameters</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a><span class=sd>        Returns:</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=sd>            Configured MSBuildingsReader instance</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>        <span class=k>return</span> <span class=n>MSBuildingsReader</span><span class=p>(</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_config</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a MSBuildingsConfig instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional configuration parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig">MSBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configured MSBuildingsConfig instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=k>def</span> <span class=nf>create_config</span><span class=p>(</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsConfig</span><span class=p>:</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>    Create and return a MSBuildingsConfig instance.</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a><span class=sd>    Args:</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>        **kwargs: Additional configuration parameters</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>    Returns:</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>        Configured MSBuildingsConfig instance</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>    <span class=k>return</span> <span class=n>MSBuildingsConfig</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_downloader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_downloader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_downloader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a MSBuildingsDownloader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig">MSBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional downloader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsDownloader">MSBuildingsDownloader</a></code> </td> <td> <div class=doc-md-description> <p>Configured MSBuildingsDownloader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=k>def</span> <span class=nf>create_downloader</span><span class=p>(</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a>    <span class=n>config</span><span class=p>:</span> <span class=n>MSBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsDownloader</span><span class=p>:</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a><span class=sd>    Create and return a MSBuildingsDownloader instance.</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=sd>    Args:</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a><span class=sd>        **kwargs: Additional downloader parameters</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>    Returns:</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=sd>        Configured MSBuildingsDownloader instance</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a>    <span class=k>return</span> <span class=n>MSBuildingsDownloader</span><span class=p>(</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_reader class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_reader</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsHandler.create_reader class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create and return a MSBuildingsReader instance.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsConfig">MSBuildingsConfig</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="logging.Logger">Logger</span></code> </td> <td> <div class=doc-md-description> <p>The logger instance to use</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional reader parameters</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader" href="#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader">MSBuildingsReader</a></code> </td> <td> <div class=doc-md-description> <p>Configured MSBuildingsReader instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=k>def</span> <span class=nf>create_reader</span><span class=p>(</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a>    <span class=n>config</span><span class=p>:</span> <span class=n>MSBuildingsConfig</span><span class=p>,</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>,</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>MSBuildingsReader</span><span class=p>:</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a><span class=sd>    Create and return a MSBuildingsReader instance.</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=sd>    Args:</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a><span class=sd>        config: The configuration object</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a><span class=sd>        data_store: The data store instance to use</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a><span class=sd>        logger: The logger instance to use</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a><span class=sd>        **kwargs: Additional reader parameters</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a><span class=sd>    Returns:</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a><span class=sd>        Configured MSBuildingsReader instance</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>    <span class=k>return</span> <span class=n>MSBuildingsReader</span><span class=p>(</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>        <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader class="doc doc-heading"> <code>MSBuildingsReader</code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.base.BaseHandlerReader" href="#gigaspatial.handlers.base.BaseHandlerReader">BaseHandlerReader</a></code></p> <p>Reader for Microsoft Global Buildings data, supporting country, points, and geometry-based resolution.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><span class=k>class</span> <span class=nc>MSBuildingsReader</span><span class=p>(</span><span class=n>BaseHandlerReader</span><span class=p>):</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=sd>    Reader for Microsoft Global Buildings data, supporting country, points, and geometry-based resolution.</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>    <span class=p>):</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>MSBuildingsConfig</span><span class=p>()</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>    <span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>        Load building data from Microsoft Buildings dataset.</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>        Args:</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>            source_data_path: List of file paths to load</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><span class=sd>        Returns:</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>            GeoDataFrame containing building data</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>        <span class=kn>from</span> <span class=nn>gigaspatial.core.io.readers</span> <span class=kn>import</span> <span class=n>read_gzipped_json_or_csv</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>        <span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>shape</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>        <span class=k>def</span> <span class=nf>read_ms_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>            <span class=n>df</span> <span class=o>=</span> <span class=n>read_gzipped_json_or_csv</span><span class=p>(</span><span class=n>file_path</span><span class=o>=</span><span class=n>file_path</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>            <span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>            <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>)</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_tabular_data</span><span class=p>(</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>            <span class=n>file_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>,</span> <span class=n>read_function</span><span class=o>=</span><span class=n>read_ms_dataset</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>        <span class=p>)</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader.load_from_paths class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_from_paths</span><span class=p>(</span><span class=n>source_data_path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.microsoft_global_buildings.MSBuildingsReader.load_from_paths class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Load building data from Microsoft Buildings dataset. Args: source_data_path: List of file paths to load Returns: GeoDataFrame containing building data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/microsoft_global_buildings.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=k>def</span> <span class=nf>load_from_paths</span><span class=p>(</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>source_data_path</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]],</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>    Load building data from Microsoft Buildings dataset.</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>    Args:</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>        source_data_path: List of file paths to load</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><span class=sd>    Returns:</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a><span class=sd>        GeoDataFrame containing building data</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>    <span class=kn>from</span> <span class=nn>gigaspatial.core.io.readers</span> <span class=kn>import</span> <span class=n>read_gzipped_json_or_csv</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>    <span class=kn>from</span> <span class=nn>shapely.geometry</span> <span class=kn>import</span> <span class=n>shape</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>    <span class=k>def</span> <span class=nf>read_ms_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=n>df</span> <span class=o>=</span> <span class=n>read_gzipped_json_or_csv</span><span class=p>(</span><span class=n>file_path</span><span class=o>=</span><span class=n>file_path</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>        <span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>crs</span><span class=o>=</span><span class=mi>4326</span><span class=p>)</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>    <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_tabular_data</span><span class=p>(</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>        <span class=n>file_paths</span><span class=o>=</span><span class=n>source_data_path</span><span class=p>,</span> <span class=n>read_function</span><span class=o>=</span><span class=n>read_ms_dataset</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>    <span class=p>)</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.opencellid class="doc doc-heading"> <code>opencellid</code> <a href=#gigaspatial.handlers.opencellid class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.opencellid.OpenCellIDConfig class="doc doc-heading"> <code>OpenCellIDConfig</code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Configuration for OpenCellID data access</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=k>class</span> <span class=nc>OpenCellIDConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for OpenCellID data access&quot;&quot;&quot;</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=c1># Base URLs</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>BASE_URL</span><span class=p>:</span> <span class=n>HttpUrl</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://opencellid.org/&quot;</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>DOWNLOAD_URL</span><span class=p>:</span> <span class=n>HttpUrl</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://opencellid.org/downloads.php?token=&quot;</span><span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=c1># User configuration</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>api_token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>OPENCELLID_ACCESS_TOKEN</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;OpenCellID API Access Token&quot;</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;opencellid&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>))</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>created_newer</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=n>default</span><span class=o>=</span><span class=mi>2003</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Filter out cell towers added before this year&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=p>)</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>created_before</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Filter out cell towers added after this year&quot;</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=n>drop_duplicates</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=n>default</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Drop cells that are in the exact same location and radio technology&quot;</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;country&quot;</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=k>def</span> <span class=nf>validate_country</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>            <span class=k>return</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=nd>@property</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>    <span class=k>def</span> <span class=nf>output_file_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Path to save the downloaded OpenCellID data&quot;&quot;&quot;</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;opencellid_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=si>}</span><span class=s2>.csv.gz&quot;</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=sa>f</span><span class=s2>&quot;OpenCellIDConfig(</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>            <span class=sa>f</span><span class=s2>&quot;  country=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=sa>f</span><span class=s2>&quot;  created_newer=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>created_newer</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>            <span class=sa>f</span><span class=s2>&quot;  created_before=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>created_before</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>            <span class=sa>f</span><span class=s2>&quot;  drop_duplicates=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>            <span class=sa>f</span><span class=s2>&quot;)&quot;</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDConfig.output_file_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>output_file_path</span><span class=p>:</span> <span class=n>Path</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.opencellid.OpenCellIDConfig.output_file_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Path to save the downloaded OpenCellID data</p> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.opencellid.OpenCellIDDownloader class="doc doc-heading"> <code>OpenCellIDDownloader</code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Downloader for OpenCellID data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=k>class</span> <span class=nc>OpenCellIDDownloader</span><span class=p>:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Downloader for OpenCellID data&quot;&quot;&quot;</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>OpenCellIDConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>],</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=p>):</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>OpenCellIDConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>    <span class=k>def</span> <span class=nf>from_country</span><span class=p>(</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=n>api_token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>OPENCELLID_ACCESS_TOKEN</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>    <span class=p>):</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Create a downloader for a specific country&quot;&quot;&quot;</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>OpenCellIDConfig</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=n>api_token</span><span class=o>=</span><span class=n>api_token</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>    <span class=k>def</span> <span class=nf>get_download_links</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get download links for the country from OpenCellID website&quot;&quot;&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>DOWNLOAD_URL</span><span class=si>}{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>api_token</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=n>country_alpha2</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=n>alpha_3</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=c1># Find table with cell tower data links</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching download links for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>            <span class=n>html_content</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>html_content</span><span class=p>,</span> <span class=s2>&quot;lxml&quot;</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>            <span class=n>table</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s2>&quot;table&quot;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=s2>&quot;regions&quot;</span><span class=p>})</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>table</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                    <span class=s2>&quot;Could not find cell tower data table on OpenCellID website&quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>                <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=c1># Parse table headers</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=n>t_headers</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=k>for</span> <span class=n>th</span> <span class=ow>in</span> <span class=n>table</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;th&quot;</span><span class=p>):</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>                <span class=n>t_headers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>th</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot; &quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>            <span class=c1># Parse table data</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>table_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>            <span class=k>for</span> <span class=n>tr</span> <span class=ow>in</span> <span class=n>table</span><span class=o>.</span><span class=n>tbody</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;tr&quot;</span><span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                <span class=n>t_row</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=k>for</span> <span class=n>td</span><span class=p>,</span> <span class=n>th</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>tr</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;td&quot;</span><span class=p>),</span> <span class=n>t_headers</span><span class=p>):</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                    <span class=k>if</span> <span class=s2>&quot;Files&quot;</span> <span class=ow>in</span> <span class=n>th</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                        <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                        <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>td</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;a&quot;</span><span class=p>):</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                            <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;href&quot;</span><span class=p>))</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                        <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span> <span class=o>=</span> <span class=n>td</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                <span class=n>table_data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>t_row</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=n>cell_dict</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>table_data</span><span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=c1># Get links for the country code</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>            <span class=k>if</span> <span class=n>country_alpha2</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>cell_dict</span><span class=p>[</span><span class=s2>&quot;Country Code&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                    <span class=sa>f</span><span class=s2>&quot;Country code </span><span class=si>{</span><span class=n>country_alpha2</span><span class=si>}</span><span class=s2> not found in OpenCellID database&quot;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=n>links</span> <span class=o>=</span> <span class=n>cell_dict</span><span class=p>[</span><span class=n>cell_dict</span><span class=p>[</span><span class=s2>&quot;Country Code&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=n>country_alpha2</span><span class=p>][</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                    <span class=s2>&quot;Files (grouped by MCC)&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                <span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=k>return</span> <span class=n>links</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error fetching download links: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>            <span class=k>raise</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=k>def</span> <span class=nf>download_and_process</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download and process OpenCellID data for the configured country&quot;&quot;&quot;</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>            <span class=n>links</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_download_links</span><span class=p>()</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>links</span><span class=p>)</span><span class=si>}</span><span class=s2> data files for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>            <span class=n>dfs</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>            <span class=k>for</span> <span class=n>link</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading data from </span><span class=si>{</span><span class=n>link</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>link</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                <span class=c1># Use a temporary file for download</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s2>&quot;.gz&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>tmpfile</span><span class=p>:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1024</span><span class=p>):</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                        <span class=k>if</span> <span class=n>chunk</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                            <span class=n>tmpfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                    <span class=n>temp_file</span> <span class=o>=</span> <span class=n>tmpfile</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                    <span class=c1># Read the downloaded gzipped CSV data</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                    <span class=k>with</span> <span class=n>gzip</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>temp_file</span><span class=p>,</span> <span class=s2>&quot;rt&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>feed_data</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                        <span class=n>dfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                            <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                                <span class=n>feed_data</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                                <span class=n>names</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                                    <span class=s2>&quot;radio&quot;</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>                                    <span class=s2>&quot;mcc&quot;</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>                                    <span class=s2>&quot;net&quot;</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>                                    <span class=s2>&quot;area&quot;</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>                                    <span class=s2>&quot;cell&quot;</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>                                    <span class=s2>&quot;unit&quot;</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>                                    <span class=s2>&quot;lon&quot;</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                                    <span class=s2>&quot;lat&quot;</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>                                    <span class=s2>&quot;range&quot;</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>                                    <span class=s2>&quot;samples&quot;</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>                                    <span class=s2>&quot;changeable&quot;</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>                                    <span class=s2>&quot;created&quot;</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>                                    <span class=s2>&quot;updated&quot;</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>                                    <span class=s2>&quot;average_signal&quot;</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>                                <span class=p>],</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>                            <span class=p>)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                        <span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>                <span class=k>except</span> <span class=ne>IOError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>                    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>temp_file</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>error_file</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>                        <span class=n>contents</span> <span class=o>=</span> <span class=n>error_file</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>                    <span class=k>if</span> <span class=s2>&quot;RATE_LIMITED&quot;</span> <span class=ow>in</span> <span class=n>contents</span><span class=p>:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>                        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>                            <span class=s2>&quot;API rate limit exceeded. You&#39;re rate-limited!&quot;</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                        <span class=p>)</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                    <span class=k>elif</span> <span class=s2>&quot;INVALID_TOKEN&quot;</span> <span class=ow>in</span> <span class=n>contents</span><span class=p>:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>                        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;API token rejected by OpenCellID!&quot;</span><span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>                    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>                        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>                            <span class=sa>f</span><span class=s2>&quot;Error processing downloaded data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>                        <span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>                <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>                    <span class=c1># Clean up temporary file</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>                    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>temp_file</span><span class=p>):</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>                        <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>temp_file</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=n>df_cell</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>            <span class=c1># Process the data</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>df_cell</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>                <span class=c1># Convert timestamps to datetime</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>                <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;created&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>                    <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;created&quot;</span><span class=p>],</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s2>&quot;unix&quot;</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>                <span class=p>)</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>                <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;updated&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>                    <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;updated&quot;</span><span class=p>],</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s2>&quot;unix&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>                <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>                <span class=c1># Filter by year</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>                <span class=n>df_cell</span> <span class=o>=</span> <span class=n>df_cell</span><span class=p>[</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>                    <span class=p>(</span><span class=n>df_cell</span><span class=o>.</span><span class=n>created</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>created_newer</span><span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>df_cell</span><span class=o>.</span><span class=n>created</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>created_before</span><span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>                <span class=p>]</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>                <span class=c1># Drop duplicates if configured</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                    <span class=n>df_cell</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>                        <span class=n>df_cell</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s2>&quot;radio&quot;</span><span class=p>,</span> <span class=s2>&quot;lon&quot;</span><span class=p>,</span> <span class=s2>&quot;lat&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>first</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                    <span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                <span class=c1># Save processed data using data_store</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>                <span class=n>output_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_file_path</span><span class=p>)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving processed data to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>                <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>                    <span class=n>df_cell</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s2>&quot;gzip&quot;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                <span class=k>return</span> <span class=n>output_path</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data found for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading and processing data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDDownloader.download_and_process class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_and_process</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDDownloader.download_and_process class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download and process OpenCellID data for the configured country</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=k>def</span> <span class=nf>download_and_process</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download and process OpenCellID data for the configured country&quot;&quot;&quot;</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>        <span class=n>links</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_download_links</span><span class=p>()</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>links</span><span class=p>)</span><span class=si>}</span><span class=s2> data files for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>        <span class=n>dfs</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=k>for</span> <span class=n>link</span> <span class=ow>in</span> <span class=n>links</span><span class=p>:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading data from </span><span class=si>{</span><span class=n>link</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>link</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>            <span class=c1># Use a temporary file for download</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>            <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s2>&quot;.gz&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>tmpfile</span><span class=p>:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1024</span><span class=p>):</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                    <span class=k>if</span> <span class=n>chunk</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                        <span class=n>tmpfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                <span class=n>temp_file</span> <span class=o>=</span> <span class=n>tmpfile</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=c1># Read the downloaded gzipped CSV data</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                <span class=k>with</span> <span class=n>gzip</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>temp_file</span><span class=p>,</span> <span class=s2>&quot;rt&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>feed_data</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                    <span class=n>dfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                        <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                            <span class=n>feed_data</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                            <span class=n>names</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                                <span class=s2>&quot;radio&quot;</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>                                <span class=s2>&quot;mcc&quot;</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>                                <span class=s2>&quot;net&quot;</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>                                <span class=s2>&quot;area&quot;</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>                                <span class=s2>&quot;cell&quot;</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>                                <span class=s2>&quot;unit&quot;</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>                                <span class=s2>&quot;lon&quot;</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                                <span class=s2>&quot;lat&quot;</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>                                <span class=s2>&quot;range&quot;</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>                                <span class=s2>&quot;samples&quot;</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>                                <span class=s2>&quot;changeable&quot;</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>                                <span class=s2>&quot;created&quot;</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>                                <span class=s2>&quot;updated&quot;</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>                                <span class=s2>&quot;average_signal&quot;</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>                            <span class=p>],</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>                        <span class=p>)</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                    <span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>            <span class=k>except</span> <span class=ne>IOError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>                <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>temp_file</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>error_file</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>                    <span class=n>contents</span> <span class=o>=</span> <span class=n>error_file</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>                <span class=k>if</span> <span class=s2>&quot;RATE_LIMITED&quot;</span> <span class=ow>in</span> <span class=n>contents</span><span class=p>:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>                    <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>                        <span class=s2>&quot;API rate limit exceeded. You&#39;re rate-limited!&quot;</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                    <span class=p>)</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                <span class=k>elif</span> <span class=s2>&quot;INVALID_TOKEN&quot;</span> <span class=ow>in</span> <span class=n>contents</span><span class=p>:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>                    <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;API token rejected by OpenCellID!&quot;</span><span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>                    <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>                        <span class=sa>f</span><span class=s2>&quot;Error processing downloaded data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>                    <span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>            <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>                <span class=c1># Clean up temporary file</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>                <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>temp_file</span><span class=p>):</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>                    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>temp_file</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=n>df_cell</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>        <span class=c1># Process the data</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>df_cell</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=c1># Convert timestamps to datetime</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>            <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;created&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>                <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;created&quot;</span><span class=p>],</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s2>&quot;unix&quot;</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>            <span class=p>)</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>            <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;updated&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>                <span class=n>df_cell</span><span class=p>[</span><span class=s2>&quot;updated&quot;</span><span class=p>],</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;s&quot;</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s2>&quot;unix&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>            <span class=c1># Filter by year</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=n>df_cell</span> <span class=o>=</span> <span class=n>df_cell</span><span class=p>[</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>                <span class=p>(</span><span class=n>df_cell</span><span class=o>.</span><span class=n>created</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>created_newer</span><span class=p>)</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>                <span class=o>&amp;</span> <span class=p>(</span><span class=n>df_cell</span><span class=o>.</span><span class=n>created</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>created_before</span><span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>            <span class=p>]</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=c1># Drop duplicates if configured</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=n>df_cell</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>                    <span class=n>df_cell</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s2>&quot;radio&quot;</span><span class=p>,</span> <span class=s2>&quot;lon&quot;</span><span class=p>,</span> <span class=s2>&quot;lat&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>first</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                <span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>            <span class=c1># Save processed data using data_store</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=n>output_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_file_path</span><span class=p>)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving processed data to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>                <span class=n>df_cell</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s2>&quot;gzip&quot;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>            <span class=k>return</span> <span class=n>output_path</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No data found for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error downloading and processing data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDDownloader.from_country class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_country</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=n>api_token</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>OPENCELLID_ACCESS_TOKEN</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.opencellid.OpenCellIDDownloader.from_country class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create a downloader for a specific country</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span>
<span class=normal><a href=#__codelineno-0-96>96</a></span>
<span class=normal><a href=#__codelineno-0-97>97</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=nd>@classmethod</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=k>def</span> <span class=nf>from_country</span><span class=p>(</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=n>api_token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>global_config</span><span class=o>.</span><span class=n>OPENCELLID_ACCESS_TOKEN</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=p>):</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Create a downloader for a specific country&quot;&quot;&quot;</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>OpenCellIDConfig</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=n>api_token</span><span class=o>=</span><span class=n>api_token</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDDownloader.get_download_links class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_download_links</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDDownloader.get_download_links class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get download links for the country from OpenCellID website</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=k>def</span> <span class=nf>get_download_links</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get download links for the country from OpenCellID website&quot;&quot;&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>DOWNLOAD_URL</span><span class=si>}{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>api_token</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>    <span class=n>country_alpha2</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>        <span class=n>alpha_3</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=c1># Find table with cell tower data links</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching download links for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=n>html_content</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>html_content</span><span class=p>,</span> <span class=s2>&quot;lxml&quot;</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=n>table</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s2>&quot;table&quot;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;id&quot;</span><span class=p>:</span> <span class=s2>&quot;regions&quot;</span><span class=p>})</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>table</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                <span class=s2>&quot;Could not find cell tower data table on OpenCellID website&quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=p>)</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=c1># Parse table headers</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=n>t_headers</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=k>for</span> <span class=n>th</span> <span class=ow>in</span> <span class=n>table</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;th&quot;</span><span class=p>):</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=n>t_headers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>th</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot; &quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=c1># Parse table data</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=n>table_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=k>for</span> <span class=n>tr</span> <span class=ow>in</span> <span class=n>table</span><span class=o>.</span><span class=n>tbody</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;tr&quot;</span><span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=n>t_row</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>            <span class=k>for</span> <span class=n>td</span><span class=p>,</span> <span class=n>th</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>tr</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;td&quot;</span><span class=p>),</span> <span class=n>t_headers</span><span class=p>):</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                <span class=k>if</span> <span class=s2>&quot;Files&quot;</span> <span class=ow>in</span> <span class=n>th</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                    <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                    <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>td</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&quot;a&quot;</span><span class=p>):</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                        <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;href&quot;</span><span class=p>))</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                    <span class=n>t_row</span><span class=p>[</span><span class=n>th</span><span class=p>]</span> <span class=o>=</span> <span class=n>td</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=n>table_data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>t_row</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=n>cell_dict</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>table_data</span><span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=c1># Get links for the country code</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=k>if</span> <span class=n>country_alpha2</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>cell_dict</span><span class=p>[</span><span class=s2>&quot;Country Code&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=sa>f</span><span class=s2>&quot;Country code </span><span class=si>{</span><span class=n>country_alpha2</span><span class=si>}</span><span class=s2> not found in OpenCellID database&quot;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>            <span class=p>)</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=n>links</span> <span class=o>=</span> <span class=n>cell_dict</span><span class=p>[</span><span class=n>cell_dict</span><span class=p>[</span><span class=s2>&quot;Country Code&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=n>country_alpha2</span><span class=p>][</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                <span class=s2>&quot;Files (grouped by MCC)&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=k>return</span> <span class=n>links</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error fetching download links: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.opencellid.OpenCellIDReader class="doc doc-heading"> <code>OpenCellIDReader</code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDReader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Reader for OpenCellID data</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=k>class</span> <span class=nc>OpenCellIDReader</span><span class=p>:</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Reader for OpenCellID data&quot;&quot;&quot;</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>        <span class=n>base_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>    <span class=p>):</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>=</span> <span class=n>base_path</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;opencellid&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=k>def</span> <span class=nf>read_data</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Read OpenCellID data for the specified country&quot;&quot;&quot;</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;opencellid_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=si>}</span><span class=s2>.csv.gz&quot;</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>                <span class=sa>f</span><span class=s2>&quot;OpenCellID data for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2> not found at </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>. &quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>                <span class=s2>&quot;Download the data first using OpenCellIDDownloader.&quot;</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>            <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=k>return</span> <span class=n>read_dataset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>    <span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Convert OpenCellID data to a GeoDataFrame&quot;&quot;&quot;</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>read_data</span><span class=p>()</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>            <span class=n>df</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=n>gpd</span><span class=o>.</span><span class=n>points_from_xy</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>lon</span><span class=p>,</span> <span class=n>df</span><span class=o>.</span><span class=n>lat</span><span class=p>),</span> <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=k>return</span> <span class=n>gdf</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDReader.read_data class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_data</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDReader.read_data class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Read OpenCellID data for the specified country</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><span class=k>def</span> <span class=nf>read_data</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Read OpenCellID data for the specified country&quot;&quot;&quot;</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>    <span class=n>file_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;opencellid_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=si>}</span><span class=s2>.csv.gz&quot;</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>            <span class=sa>f</span><span class=s2>&quot;OpenCellID data for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2> not found at </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>. &quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>            <span class=s2>&quot;Download the data first using OpenCellIDDownloader.&quot;</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>    <span class=k>return</span> <span class=n>read_dataset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=n>file_path</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.opencellid.OpenCellIDReader.to_geodataframe class="doc doc-heading"> <code class="highlight language-python"><span class=n>to_geodataframe</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.opencellid.OpenCellIDReader.to_geodataframe class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Convert OpenCellID data to a GeoDataFrame</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/opencellid.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert OpenCellID data to a GeoDataFrame&quot;&quot;&quot;</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>    <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>read_data</span><span class=p>()</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=n>df</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=n>gpd</span><span class=o>.</span><span class=n>points_from_xy</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>lon</span><span class=p>,</span> <span class=n>df</span><span class=o>.</span><span class=n>lat</span><span class=p>),</span> <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>    <span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>    <span class=k>return</span> <span class=n>gdf</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.osm class="doc doc-heading"> <code>osm</code> <a href=#gigaspatial.handlers.osm class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.osm.OSMLocationFetcher class="doc doc-heading"> <code>OSMLocationFetcher</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> <a href=#gigaspatial.handlers.osm.OSMLocationFetcher class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A class to fetch and process location data from OpenStreetMap using the Overpass API.</p> <p>This class supports fetching various OSM location types including amenities, buildings, shops, and other POI categories.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/osm.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=nd>@dataclass</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=k>class</span> <span class=nc>OSMLocationFetcher</span><span class=p>:</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    A class to fetch and process location data from OpenStreetMap using the Overpass API.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    This class supports fetching various OSM location types including amenities, buildings,</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    shops, and other POI categories.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>location_types</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>base_url</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;http://overpass-api.de/api/interpreter&quot;</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>600</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>max_retries</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=n>retry_delay</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Validate inputs, normalize location_types, and set up logging.&quot;&quot;&quot;</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>            <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=c1># Normalize location_types to always be a dictionary</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>            <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;amenity&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>}</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=k>elif</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>                <span class=s2>&quot;location_types must be a list of strings or a dictionary mapping categories to type lists&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=k>def</span> <span class=nf>_build_queries</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>since_year</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>        Construct separate Overpass QL queries for different element types and categories.</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>        Returns list of [nodes_relations_query, ways_query]</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=k>if</span> <span class=n>since_year</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=n>date_filter</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;(newer:&quot;</span><span class=si>{</span><span class=n>since_year</span><span class=si>}</span><span class=s1>-01-01T00:00:00Z&quot;)&#39;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>            <span class=n>date_filter</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=c1># Query for nodes and relations (with center output)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=n>nodes_relations_queries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>types</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=n>nodes_relations_queries</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>                <span class=p>[</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>                    <span class=sa>f</span><span class=s2>&quot;&quot;&quot;node[&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>&quot;~&quot;^(</span><span class=si>{</span><span class=s2>&quot;|&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>types</span><span class=p>)</span><span class=si>}</span><span class=s2>)&quot;]</span><span class=si>{</span><span class=n>date_filter</span><span class=si>}</span><span class=s2>(area.searchArea);&quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>                    <span class=sa>f</span><span class=s2>&quot;&quot;&quot;relation[&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>&quot;~&quot;^(</span><span class=si>{</span><span class=s2>&quot;|&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>types</span><span class=p>)</span><span class=si>}</span><span class=s2>)&quot;]</span><span class=si>{</span><span class=n>date_filter</span><span class=si>}</span><span class=s2>(area.searchArea);&quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>                <span class=p>]</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>            <span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>nodes_relations_queries</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>nodes_relations_queries</span><span class=p>)</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=n>nodes_relations_query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=s2>        [out:json][timeout:</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span><span class=si>}</span><span class=s2>];</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=s2>        area[&quot;ISO3166-1&quot;=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>]-&gt;.searchArea;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=s2>        (</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=s2>            </span><span class=si>{</span><span class=n>nodes_relations_queries</span><span class=si>}</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=s2>        );</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=s2>        out center;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=c1># Query for ways (with geometry output)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=n>ways_queries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>types</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=n>ways_queries</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>                <span class=sa>f</span><span class=s2>&quot;&quot;&quot;way[&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>&quot;~&quot;^(</span><span class=si>{</span><span class=s2>&quot;|&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>types</span><span class=p>)</span><span class=si>}</span><span class=s2>)&quot;]</span><span class=si>{</span><span class=n>date_filter</span><span class=si>}</span><span class=s2>(area.searchArea);&quot;&quot;&quot;</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=n>ways_queries</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>ways_queries</span><span class=p>)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>ways_query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=s2>        [out:json][timeout:</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span><span class=si>}</span><span class=s2>];</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=s2>        area[&quot;ISO3166-1&quot;=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>]-&gt;.searchArea;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=s2>        (</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=s2>            </span><span class=si>{</span><span class=n>ways_queries</span><span class=si>}</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=s2>        );</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=s2>        out geom;</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=k>return</span> <span class=p>[</span><span class=n>nodes_relations_query</span><span class=p>,</span> <span class=n>ways_query</span><span class=p>]</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>    <span class=k>def</span> <span class=nf>_make_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Make HTTP request to Overpass API with retry mechanism.&quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=k>for</span> <span class=n>attempt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>max_retries</span><span class=p>):</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Executing query:</span><span class=se>\n</span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;data&quot;</span><span class=p>:</span> <span class=n>query</span><span class=p>},</span> <span class=n>timeout</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>                <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>                <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=k>except</span> <span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Attempt </span><span class=si>{</span><span class=n>attempt</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>                <span class=k>if</span> <span class=n>attempt</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_retries</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>                    <span class=n>sleep</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>retry_delay</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>                    <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                        <span class=sa>f</span><span class=s2>&quot;Failed to fetch data after </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>max_retries</span><span class=si>}</span><span class=s2> attempts&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                    <span class=p>)</span> <span class=kn>from</span> <span class=nn>e</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=k>def</span> <span class=nf>_extract_matching_categories</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tags</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        Extract all matching categories and their values from the tags.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        Returns:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>            Dict mapping each matching category to its value</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=n>matches</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>types</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>            <span class=k>if</span> <span class=n>category</span> <span class=ow>in</span> <span class=n>tags</span> <span class=ow>and</span> <span class=n>tags</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=ow>in</span> <span class=n>types</span><span class=p>:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                <span class=n>matches</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>=</span> <span class=n>tags</span><span class=p>[</span><span class=n>category</span><span class=p>]</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=k>return</span> <span class=n>matches</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>    <span class=k>def</span> <span class=nf>_process_node_relation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>any</span><span class=p>]]:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        Process a node or relation element.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        May return multiple processed elements if the element matches multiple categories.</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=n>tags</span> <span class=o>=</span> <span class=n>element</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;tags&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=n>matching_categories</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_matching_categories</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>matching_categories</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                    <span class=sa>f</span><span class=s2>&quot;Element </span><span class=si>{</span><span class=n>element</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> missing or not matching specified category tags&quot;</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                <span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>            <span class=n>_lat</span> <span class=o>=</span> <span class=n>element</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;lat&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;center&quot;</span><span class=p>][</span><span class=s2>&quot;lat&quot;</span><span class=p>]</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=n>_lon</span> <span class=o>=</span> <span class=n>element</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;lon&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;center&quot;</span><span class=p>][</span><span class=s2>&quot;lon&quot;</span><span class=p>]</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=n>point_geom</span> <span class=o>=</span> <span class=n>Point</span><span class=p>(</span><span class=n>_lon</span><span class=p>,</span> <span class=n>_lat</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=c1># for each matching category, create a separate element</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>            <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>matching_categories</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                    <span class=p>{</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                        <span class=s2>&quot;source_id&quot;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>],</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>                        <span class=s2>&quot;category&quot;</span><span class=p>:</span> <span class=n>category</span><span class=p>,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                        <span class=s2>&quot;category_value&quot;</span><span class=p>:</span> <span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                        <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>tags</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                        <span class=s2>&quot;name_en&quot;</span><span class=p>:</span> <span class=n>tags</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name:en&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                        <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>],</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                        <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=n>point_geom</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                        <span class=s2>&quot;latitude&quot;</span><span class=p>:</span> <span class=n>_lat</span><span class=p>,</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                        <span class=s2>&quot;longitude&quot;</span><span class=p>:</span> <span class=n>_lon</span><span class=p>,</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                        <span class=s2>&quot;matching_categories&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>matching_categories</span><span class=o>.</span><span class=n>keys</span><span class=p>()),</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                    <span class=p>}</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                <span class=p>)</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>            <span class=k>return</span> <span class=n>results</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>        <span class=k>except</span> <span class=ne>KeyError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Corrupt data received for node/relation: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=k>def</span> <span class=nf>_process_way</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>any</span><span class=p>]]:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><span class=sd>        Process a way element with geometry.</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=sd>        May return multiple processed elements if the element matches multiple categories.</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>            <span class=n>tags</span> <span class=o>=</span> <span class=n>element</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;tags&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>            <span class=n>matching_categories</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_matching_categories</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>matching_categories</span><span class=p>:</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                    <span class=sa>f</span><span class=s2>&quot;Element </span><span class=si>{</span><span class=n>element</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> missing or not matching specified category tags&quot;</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                <span class=p>)</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=c1># Create polygon from geometry points</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=n>polygon</span> <span class=o>=</span> <span class=n>Polygon</span><span class=p>([(</span><span class=n>p</span><span class=p>[</span><span class=s2>&quot;lon&quot;</span><span class=p>],</span> <span class=n>p</span><span class=p>[</span><span class=s2>&quot;lat&quot;</span><span class=p>])</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]])</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=n>centroid</span> <span class=o>=</span> <span class=n>polygon</span><span class=o>.</span><span class=n>centroid</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>            <span class=c1># For each matching category, create a separate element</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>matching_categories</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>                <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>                    <span class=p>{</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>                        <span class=s2>&quot;source_id&quot;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>],</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>                        <span class=s2>&quot;category&quot;</span><span class=p>:</span> <span class=n>category</span><span class=p>,</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>                        <span class=s2>&quot;category_value&quot;</span><span class=p>:</span> <span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>                        <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>tags</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                        <span class=s2>&quot;name_en&quot;</span><span class=p>:</span> <span class=n>tags</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name:en&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>),</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>                        <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>],</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>                        <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=n>polygon</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>                        <span class=s2>&quot;latitude&quot;</span><span class=p>:</span> <span class=n>centroid</span><span class=o>.</span><span class=n>y</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>                        <span class=s2>&quot;longitude&quot;</span><span class=p>:</span> <span class=n>centroid</span><span class=o>.</span><span class=n>x</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>                        <span class=s2>&quot;matching_categories&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>matching_categories</span><span class=o>.</span><span class=n>keys</span><span class=p>()),</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>                    <span class=p>}</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>                <span class=p>)</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>            <span class=k>return</span> <span class=n>results</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>KeyError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error processing way geometry: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=n>since_year</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=n>handle_duplicates</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;separate&quot;</span><span class=p>,</span> <span class=s2>&quot;combine&quot;</span><span class=p>,</span> <span class=s2>&quot;primary&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;separate&quot;</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>        Fetch and process OSM locations.</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>        Args:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>            since_year (int, optional): Filter for locations added/modified since this year.</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><span class=sd>            handle_duplicates (str): How to handle objects matching multiple categories:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>                - &#39;separate&#39;: Create separate entries for each category (default)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>                - &#39;combine&#39;: Use a single entry with a list of matching categories</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>                - &#39;primary&#39;: Keep only the first matching category</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>        Returns:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><span class=sd>            pd.DataFrame: Processed OSM locations</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;separate&quot;</span><span class=p>,</span> <span class=s2>&quot;combine&quot;</span><span class=p>,</span> <span class=s2>&quot;primary&quot;</span><span class=p>):</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>                <span class=s2>&quot;handle_duplicates must be one of: &#39;separate&#39;, &#39;combine&#39;, &#39;primary&#39;&quot;</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=sa>f</span><span class=s2>&quot;Fetching OSM locations from Overpass API for country: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Location types: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Handling duplicate category matches as: </span><span class=si>{</span><span class=n>handle_duplicates</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>        <span class=c1># Get queries for different element types</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>        <span class=n>nodes_relations_query</span><span class=p>,</span> <span class=n>ways_query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_queries</span><span class=p>(</span><span class=n>since_year</span><span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>        <span class=c1># Fetch nodes and relations</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>        <span class=n>nodes_relations_response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=n>nodes_relations_query</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=n>nodes_relations</span> <span class=o>=</span> <span class=n>nodes_relations_response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;elements&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>        <span class=c1># Fetch ways</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>        <span class=n>ways_response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=n>ways_query</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=n>ways</span> <span class=o>=</span> <span class=n>ways_response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;elements&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>nodes_relations</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>ways</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No locations found for the specified criteria&quot;</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=sa>f</span><span class=s2>&quot;Processing </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>nodes_relations</span><span class=p>)</span><span class=si>}</span><span class=s2> nodes/relations and </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>ways</span><span class=p>)</span><span class=si>}</span><span class=s2> ways...&quot;</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=c1># Process nodes and relations</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=n>processed_nodes_relations</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>                <span class=n>item</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>                <span class=k>for</span> <span class=n>sublist</span> <span class=ow>in</span> <span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>_process_node_relation</span><span class=p>,</span> <span class=n>nodes_relations</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>                <span class=p>)</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>                <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>sublist</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>            <span class=p>]</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=c1># Process ways</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>            <span class=n>processed_ways</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>                <span class=n>item</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>                <span class=k>for</span> <span class=n>sublist</span> <span class=ow>in</span> <span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_process_way</span><span class=p>,</span> <span class=n>ways</span><span class=p>)</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>                <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>sublist</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>            <span class=p>]</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=c1># Combine all processed elements</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=n>all_elements</span> <span class=o>=</span> <span class=n>processed_nodes_relations</span> <span class=o>+</span> <span class=n>processed_ways</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>all_elements</span><span class=p>:</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No matching elements found after processing&quot;</span><span class=p>)</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=c1># Handle duplicates based on the specified strategy</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=o>!=</span> <span class=s2>&quot;separate&quot;</span><span class=p>:</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>            <span class=c1># Group by source_id</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>            <span class=n>grouped_elements</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>            <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>all_elements</span><span class=p>:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>                <span class=n>source_id</span> <span class=o>=</span> <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;source_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>                <span class=k>if</span> <span class=n>source_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>grouped_elements</span><span class=p>:</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>                    <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>elem</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>                <span class=k>elif</span> <span class=n>handle_duplicates</span> <span class=o>==</span> <span class=s2>&quot;combine&quot;</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>                    <span class=c1># Combine matching categories</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>                    <span class=k>if</span> <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>                        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>],</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                                <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>                            <span class=p>]</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>                                <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>                            <span class=p>]</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>                        <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>                            <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>                            <span class=ow>not</span> <span class=ow>in</span> <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>                        <span class=p>):</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>                                <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>                            <span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>                                <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>                            <span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>                <span class=c1># For &#39;primary&#39;, just keep the first one we encountered</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=n>all_elements</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>grouped_elements</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>        <span class=n>locations</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>all_elements</span><span class=p>)</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>        <span class=c1># Log element type distribution</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>        <span class=n>type_counts</span> <span class=o>=</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Element type distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>        <span class=k>for</span> <span class=n>element_type</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>type_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>element_type</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>        <span class=c1># Log category distribution</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>        <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=o>==</span> <span class=s2>&quot;combine&quot;</span><span class=p>:</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>            <span class=c1># Count each category separately when they&#39;re in lists</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>            <span class=n>category_counts</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>            <span class=k>for</span> <span class=n>cats</span> <span class=ow>in</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>cats</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>                    <span class=k>for</span> <span class=n>cat</span> <span class=ow>in</span> <span class=n>cats</span><span class=p>:</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>                        <span class=n>category_counts</span><span class=p>[</span><span class=n>cat</span><span class=p>]</span> <span class=o>=</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cat</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>                    <span class=n>category_counts</span><span class=p>[</span><span class=n>cats</span><span class=p>]</span> <span class=o>=</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cats</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Category distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>            <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>            <span class=n>category_counts</span> <span class=o>=</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Category distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>            <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>        <span class=c1># Log elements with multiple matching categories</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=n>multi_category</span> <span class=o>=</span> <span class=p>[</span><span class=n>e</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>all_elements</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>e</span><span class=p>[</span><span class=s2>&quot;matching_categories&quot;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>        <span class=k>if</span> <span class=n>multi_category</span><span class=p>:</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>multi_category</span><span class=p>)</span><span class=si>}</span><span class=s2> elements matched multiple categories&quot;</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>            <span class=p>)</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully processed </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>locations</span><span class=p>)</span><span class=si>}</span><span class=s2> locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>        <span class=k>return</span> <span class=n>locations</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.osm.OSMLocationFetcher.__post_init__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__post_init__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.osm.OSMLocationFetcher.__post_init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Validate inputs, normalize location_types, and set up logging.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/osm.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate inputs, normalize location_types, and set up logging.&quot;&quot;&quot;</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=c1># Normalize location_types to always be a dictionary</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;amenity&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>}</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=k>elif</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=s2>&quot;location_types must be a list of strings or a dictionary mapping categories to type lists&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.osm.OSMLocationFetcher.fetch_locations class="doc doc-heading"> <code class="highlight language-python"><span class=n>fetch_locations</span><span class=p>(</span><span class=n>since_year</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>handle_duplicates</span><span class=o>=</span><span class=s1>&#39;separate&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.osm.OSMLocationFetcher.fetch_locations class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Fetch and process OSM locations.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>since_year</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Filter for locations added/modified since this year.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>handle_duplicates</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>How to handle objects matching multiple categories: - 'separate': Create separate entries for each category (default) - 'combine': Use a single entry with a list of matching categories - 'primary': Keep only the first matching category</p> </div> </td> <td> <code>&#39;separate&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: Processed OSM locations</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/osm.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=n>since_year</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>    <span class=n>handle_duplicates</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;separate&quot;</span><span class=p>,</span> <span class=s2>&quot;combine&quot;</span><span class=p>,</span> <span class=s2>&quot;primary&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;separate&quot;</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>    Fetch and process OSM locations.</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>    Args:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>        since_year (int, optional): Filter for locations added/modified since this year.</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><span class=sd>        handle_duplicates (str): How to handle objects matching multiple categories:</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>            - &#39;separate&#39;: Create separate entries for each category (default)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>            - &#39;combine&#39;: Use a single entry with a list of matching categories</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>            - &#39;primary&#39;: Keep only the first matching category</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>    Returns:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><span class=sd>        pd.DataFrame: Processed OSM locations</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;separate&quot;</span><span class=p>,</span> <span class=s2>&quot;combine&quot;</span><span class=p>,</span> <span class=s2>&quot;primary&quot;</span><span class=p>):</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>            <span class=s2>&quot;handle_duplicates must be one of: &#39;separate&#39;, &#39;combine&#39;, &#39;primary&#39;&quot;</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=sa>f</span><span class=s2>&quot;Fetching OSM locations from Overpass API for country: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>    <span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Location types: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>location_types</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Handling duplicate category matches as: </span><span class=si>{</span><span class=n>handle_duplicates</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>    <span class=c1># Get queries for different element types</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>    <span class=n>nodes_relations_query</span><span class=p>,</span> <span class=n>ways_query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_queries</span><span class=p>(</span><span class=n>since_year</span><span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>    <span class=c1># Fetch nodes and relations</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>    <span class=n>nodes_relations_response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=n>nodes_relations_query</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>    <span class=n>nodes_relations</span> <span class=o>=</span> <span class=n>nodes_relations_response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;elements&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>    <span class=c1># Fetch ways</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>    <span class=n>ways_response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=n>ways_query</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=n>ways</span> <span class=o>=</span> <span class=n>ways_response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;elements&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>nodes_relations</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>ways</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No locations found for the specified criteria&quot;</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=sa>f</span><span class=s2>&quot;Processing </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>nodes_relations</span><span class=p>)</span><span class=si>}</span><span class=s2> nodes/relations and </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>ways</span><span class=p>)</span><span class=si>}</span><span class=s2> ways...&quot;</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>    <span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>    <span class=c1># Process nodes and relations</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=n>processed_nodes_relations</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>            <span class=n>item</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>            <span class=k>for</span> <span class=n>sublist</span> <span class=ow>in</span> <span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>                <span class=bp>self</span><span class=o>.</span><span class=n>_process_node_relation</span><span class=p>,</span> <span class=n>nodes_relations</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>            <span class=p>)</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>sublist</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=p>]</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=c1># Process ways</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=n>processed_ways</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>            <span class=n>item</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>            <span class=k>for</span> <span class=n>sublist</span> <span class=ow>in</span> <span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_process_way</span><span class=p>,</span> <span class=n>ways</span><span class=p>)</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>sublist</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=p>]</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>    <span class=c1># Combine all processed elements</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=n>all_elements</span> <span class=o>=</span> <span class=n>processed_nodes_relations</span> <span class=o>+</span> <span class=n>processed_ways</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>all_elements</span><span class=p>:</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No matching elements found after processing&quot;</span><span class=p>)</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=c1># Handle duplicates based on the specified strategy</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>    <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=o>!=</span> <span class=s2>&quot;separate&quot;</span><span class=p>:</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=c1># Group by source_id</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=n>grouped_elements</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>        <span class=k>for</span> <span class=n>elem</span> <span class=ow>in</span> <span class=n>all_elements</span><span class=p>:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>            <span class=n>source_id</span> <span class=o>=</span> <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;source_id&quot;</span><span class=p>]</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>            <span class=k>if</span> <span class=n>source_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>grouped_elements</span><span class=p>:</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>                <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>elem</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>            <span class=k>elif</span> <span class=n>handle_duplicates</span> <span class=o>==</span> <span class=s2>&quot;combine&quot;</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>                <span class=c1># Combine matching categories</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>                <span class=k>if</span> <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>                    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>],</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>                        <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>                        <span class=p>]</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>                        <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>                            <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>                        <span class=p>]</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>                    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>                        <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>                        <span class=ow>not</span> <span class=ow>in</span> <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>                    <span class=p>):</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>                        <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>                            <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>                        <span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>                        <span class=n>grouped_elements</span><span class=p>[</span><span class=n>source_id</span><span class=p>][</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>                            <span class=n>elem</span><span class=p>[</span><span class=s2>&quot;category_value&quot;</span><span class=p>]</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>                        <span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>            <span class=c1># For &#39;primary&#39;, just keep the first one we encountered</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=n>all_elements</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>grouped_elements</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>    <span class=n>locations</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>all_elements</span><span class=p>)</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>    <span class=c1># Log element type distribution</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>    <span class=n>type_counts</span> <span class=o>=</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Element type distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>    <span class=k>for</span> <span class=n>element_type</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>type_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>element_type</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>    <span class=c1># Log category distribution</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>    <span class=k>if</span> <span class=n>handle_duplicates</span> <span class=o>==</span> <span class=s2>&quot;combine&quot;</span><span class=p>:</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>        <span class=c1># Count each category separately when they&#39;re in lists</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=n>category_counts</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>        <span class=k>for</span> <span class=n>cats</span> <span class=ow>in</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>cats</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>                <span class=k>for</span> <span class=n>cat</span> <span class=ow>in</span> <span class=n>cats</span><span class=p>:</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>                    <span class=n>category_counts</span><span class=p>[</span><span class=n>cat</span><span class=p>]</span> <span class=o>=</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cat</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>                <span class=n>category_counts</span><span class=p>[</span><span class=n>cats</span><span class=p>]</span> <span class=o>=</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cats</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Category distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>        <span class=n>category_counts</span> <span class=o>=</span> <span class=n>locations</span><span class=p>[</span><span class=s2>&quot;category&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Category distribution:&quot;</span><span class=p>)</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>category_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>category</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>    <span class=c1># Log elements with multiple matching categories</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=n>multi_category</span> <span class=o>=</span> <span class=p>[</span><span class=n>e</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>all_elements</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>e</span><span class=p>[</span><span class=s2>&quot;matching_categories&quot;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=k>if</span> <span class=n>multi_category</span><span class=p>:</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>multi_category</span><span class=p>)</span><span class=si>}</span><span class=s2> elements matched multiple categories&quot;</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>        <span class=p>)</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully processed </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>locations</span><span class=p>)</span><span class=si>}</span><span class=s2> locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>    <span class=k>return</span> <span class=n>locations</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.overture class="doc doc-heading"> <code>overture</code> <a href=#gigaspatial.handlers.overture class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.overture.OvertureAmenityFetcher class="doc doc-heading"> <code>OvertureAmenityFetcher</code> <a href=#gigaspatial.handlers.overture.OvertureAmenityFetcher class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A class to fetch and process amenity locations from Overture.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/overture.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=nd>@dataclass</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>ConfigDict</span><span class=p>(</span><span class=n>arbitrary_types_allowed</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=k>class</span> <span class=nc>OvertureAmenityFetcher</span><span class=p>:</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    A class to fetch and process amenity locations from Overture.</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=c1># constants</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>release</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;2024-12-18.0&quot;</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>base_url</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>        <span class=s2>&quot;s3://overturemaps-us-west-2/release/</span><span class=si>{release}</span><span class=s2>/theme=places/*/*&quot;</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=c1># user config</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>    <span class=n>amenity_types</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;List of amenity types to fetch&quot;</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>geom</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Polygon</span><span class=p>,</span> <span class=n>MultiPolygon</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=c1># config for country boundary access from data storage</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=c1># if None GADM boundaries will be used</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>country_geom_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Validate inputs and set up logging.&quot;&quot;&quot;</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>release</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=bp>self</span><span class=o>.</span><span class=n>connection</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_set_connection</span><span class=p>()</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=k>def</span> <span class=nf>_set_connection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set the connection to the DB&quot;&quot;&quot;</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=n>db</span> <span class=o>=</span> <span class=n>duckdb</span><span class=o>.</span><span class=n>connect</span><span class=p>()</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=n>db</span><span class=o>.</span><span class=n>install_extension</span><span class=p>(</span><span class=s2>&quot;spatial&quot;</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=n>db</span><span class=o>.</span><span class=n>load_extension</span><span class=p>(</span><span class=s2>&quot;spatial&quot;</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=k>return</span> <span class=n>db</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=k>def</span> <span class=nf>_load_country_geometry</span><span class=p>(</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Polygon</span><span class=p>,</span> <span class=n>MultiPolygon</span><span class=p>]:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load country boundary geometry from DataStore or GADM.&quot;&quot;&quot;</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>gdf_admin0</span> <span class=o>=</span> <span class=n>AdminBoundaries</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=n>country_code</span><span class=o>=</span><span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>            <span class=n>admin_level</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>            <span class=n>path</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>country_geom_path</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=p>)</span><span class=o>.</span><span class=n>to_geodataframe</span><span class=p>()</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=k>return</span> <span class=n>gdf_admin0</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>    <span class=k>def</span> <span class=nf>_build_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>match_pattern</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Constructs and returns the query&quot;&quot;&quot;</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=k>if</span> <span class=n>match_pattern</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=n>amenity_query</span> <span class=o>=</span> <span class=s2>&quot; OR &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>                <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;category ilike &#39;%</span><span class=si>{</span><span class=n>amenity</span><span class=si>}</span><span class=s2>%&#39;&quot;</span> <span class=k>for</span> <span class=n>amenity</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>amenity_types</span><span class=p>]</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=n>amenity_query</span> <span class=o>=</span> <span class=s2>&quot; OR &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>                <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;category == &#39;</span><span class=si>{</span><span class=n>amenity</span><span class=si>}</span><span class=s2>&#39;&quot;</span> <span class=k>for</span> <span class=n>amenity</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>amenity_types</span><span class=p>]</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=n>query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=s2>        SELECT id,</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=s2>            names.primary AS name,</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=s2>            ROUND(confidence,2) as confidence,</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=s2>            categories.primary AS category,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=s2>            ST_AsText(geometry) as geometry,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=s2>        FROM read_parquet(&#39;s3://overturemaps-us-west-2/release/2024-12-18.0/theme=places/type=place/*&#39;,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=s2>            hive_partitioning=1)</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=s2>        WHERE bbox.xmin &gt; </span><span class=si>{}</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=s2>            AND bbox.ymin &gt; </span><span class=si>{}</span><span class=s2> </span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=s2>            AND bbox.xmax &lt;  </span><span class=si>{}</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=s2>            AND bbox.ymax &lt; </span><span class=si>{}</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><span class=s2>            AND (</span><span class=si>{}</span><span class=s2>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=s2>        &quot;&quot;&quot;</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>geom</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=bp>self</span><span class=o>.</span><span class=n>geom</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_country_geometry</span><span class=p>()</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=k>return</span> <span class=n>query</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>geom</span><span class=o>.</span><span class=n>bounds</span><span class=p>,</span> <span class=n>amenity_query</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>match_pattern</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Fetch and process amenity locations.&quot;&quot;&quot;</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Fetching amenity locations from Overture DB...&quot;</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=n>query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_query</span><span class=p>(</span><span class=n>match_pattern</span><span class=o>=</span><span class=n>match_pattern</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>connection</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Processing geometries&quot;</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>df</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=n>gpd</span><span class=o>.</span><span class=n>GeoSeries</span><span class=o>.</span><span class=n>from_wkt</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]),</span> <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=c1># filter by geometry boundary</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=n>s</span> <span class=o>=</span> <span class=n>STRtree</span><span class=p>(</span><span class=n>gdf</span><span class=o>.</span><span class=n>geometry</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>geom</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;intersects&quot;</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=n>locations</span> <span class=o>=</span> <span class=n>gdf</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>result</span><span class=p>]</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully processed </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>locations</span><span class=p>)</span><span class=si>}</span><span class=s2> amenity locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=k>return</span> <span class=n>locations</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.overture.OvertureAmenityFetcher.__post_init__ class="doc doc-heading"> <code class="highlight language-python"><span class=n>__post_init__</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.overture.OvertureAmenityFetcher.__post_init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Validate inputs and set up logging.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/overture.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate inputs and set up logging.&quot;&quot;&quot;</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>release</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>release</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=bp>self</span><span class=o>.</span><span class=n>connection</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_set_connection</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.overture.OvertureAmenityFetcher.fetch_locations class="doc doc-heading"> <code class="highlight language-python"><span class=n>fetch_locations</span><span class=p>(</span><span class=n>match_pattern</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.overture.OvertureAmenityFetcher.fetch_locations class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Fetch and process amenity locations.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/overture.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=k>def</span> <span class=nf>fetch_locations</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>match_pattern</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Fetch and process amenity locations.&quot;&quot;&quot;</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Fetching amenity locations from Overture DB...&quot;</span><span class=p>)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=n>query</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_query</span><span class=p>(</span><span class=n>match_pattern</span><span class=o>=</span><span class=n>match_pattern</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>connection</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Processing geometries&quot;</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>df</span><span class=p>,</span> <span class=n>geometry</span><span class=o>=</span><span class=n>gpd</span><span class=o>.</span><span class=n>GeoSeries</span><span class=o>.</span><span class=n>from_wkt</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>]),</span> <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>    <span class=c1># filter by geometry boundary</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=n>s</span> <span class=o>=</span> <span class=n>STRtree</span><span class=p>(</span><span class=n>gdf</span><span class=o>.</span><span class=n>geometry</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>geom</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;intersects&quot;</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=n>locations</span> <span class=o>=</span> <span class=n>gdf</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>result</span><span class=p>]</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully processed </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>locations</span><span class=p>)</span><span class=si>}</span><span class=s2> amenity locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=k>return</span> <span class=n>locations</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.rwi class="doc doc-heading"> <code>rwi</code> <a href=#gigaspatial.handlers.rwi class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.rwi.RWIConfig class="doc doc-heading"> <code>RWIConfig</code> <a href=#gigaspatial.handlers.rwi.RWIConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.hdx.HDXConfig" href="#gigaspatial.handlers.hdx.HDXConfig">HDXConfig</a></code></p> <p>Configuration for Relative Wealth Index data access</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/rwi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=k>class</span> <span class=nc>RWIConfig</span><span class=p>(</span><span class=n>HDXConfig</span><span class=p>):</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for Relative Wealth Index data access&quot;&quot;&quot;</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=c1># Override dataset_name to be fixed for RWI</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>dataset_name</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;relative-wealth-index&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;relative-wealth-index&quot;</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=c1># Additional RWI-specific configurations</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>country</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>        <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Country ISO code to filter data for&quot;</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=p>)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;country&quot;</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=k>def</span> <span class=nf>validate_country</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>            <span class=k>return</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.rwi.RelativeWealthIndexDownloader class="doc doc-heading"> <code>RelativeWealthIndexDownloader</code> <a href=#gigaspatial.handlers.rwi.RelativeWealthIndexDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.handlers.hdx.HDXDownloader" href="#gigaspatial.handlers.hdx.HDXDownloader">HDXDownloader</a></code></p> <p>Specialized downloader for the Relative Wealth Index dataset from HDX</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/rwi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=k>class</span> <span class=nc>RelativeWealthIndexDownloader</span><span class=p>(</span><span class=n>HDXDownloader</span><span class=p>):</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Specialized downloader for the Relative Wealth Index dataset from HDX&quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>RWIConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=p>):</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=k>if</span> <span class=n>config</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=n>config</span> <span class=o>=</span> <span class=n>RWIConfig</span><span class=p>()</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=n>config</span> <span class=o>=</span> <span class=n>RWIConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=k>def</span> <span class=nf>from_config</span><span class=p>(</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=n>country</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=p>):</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Create a downloader with RWI-specific configurations&quot;&quot;&quot;</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>RWIConfig</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Download RWI dataset, optionally filtering for a specific country.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        If country is specified, attempts to find and download only the resources</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>        relevant to that country. Otherwise, downloads all RWI resources.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>        Returns:</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>            List of paths to the downloaded files</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>        <span class=c1># If no country specified, download all resources</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>            <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>download_dataset</span><span class=p>()</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=c1># Get all resources from the dataset</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>            <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset_resources</span><span class=p>()</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No resources found for RWI dataset&quot;</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=c1># Prepare country identifiers for matching</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=n>country_code</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=n>country_name</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>name</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=n>country_alpha2</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>                <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=c1># Try different matching patterns</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=n>country_patterns</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>                <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL path with ISO3 prefix</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>                <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>,</span>  <span class=c1># URL path with ISO3 followed by extension</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>                <span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># Filename with ISO3 in middle</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>,</span>  <span class=c1># Filename with ISO3 at end</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>                <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with no spaces</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>                <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with hyphens</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>                <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_alpha2</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with ISO2 code</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>                <span class=n>country_name</span><span class=p>,</span>  <span class=c1># Country name anywhere in URL</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=p>]</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=c1># Find matching resources</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=n>matching_resources</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=k>for</span> <span class=n>resource</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>                <span class=c1># Get the URL safely</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=n>resource_url</span> <span class=o>=</span> <span class=n>resource</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;url&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                <span class=k>if</span> <span class=ow>not</span> <span class=n>resource_url</span><span class=p>:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                    <span class=k>continue</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>                <span class=n>resource_url</span> <span class=o>=</span> <span class=n>resource_url</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>                <span class=c1># Check for matches with our patterns</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>                <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>pattern</span> <span class=ow>in</span> <span class=n>resource_url</span> <span class=k>for</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>country_patterns</span><span class=p>):</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>                    <span class=n>matching_resources</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>resource</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>matching_resources</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                    <span class=sa>f</span><span class=s2>&quot;No resources matching country &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&#39; were found. &quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>                    <span class=sa>f</span><span class=s2>&quot;Consider downloading the full dataset with country=None and filtering afterwards.&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>                <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=c1># Download the matching resources</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=n>downloaded_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>matching_resources</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>                    <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                    <span class=c1># Download to a temporary directory</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                    <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>TemporaryDirectory</span><span class=p>()</span> <span class=k>as</span> <span class=n>tmpdir</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                        <span class=n>url</span><span class=p>,</span> <span class=n>local_path</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>folder</span><span class=o>=</span><span class=n>tmpdir</span><span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                        <span class=c1># Read the file and write to the DataStore</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>local_path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                            <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                        <span class=c1># Compose the target path in the DataStore</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                        <span class=n>target_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>                            <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_dir_path</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>local_path</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                        <span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=n>target_path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                        <span class=n>downloaded_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>target_path</span><span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                        <span class=sa>f</span><span class=s2>&quot;Downloaded resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                    <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                    <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                        <span class=sa>f</span><span class=s2>&quot;Error downloading resource </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                    <span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=k>return</span> <span class=n>downloaded_paths</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error during country-filtered download: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>            <span class=c1># Fall back to downloading all resources</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Falling back to downloading all RWI resources&quot;</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>            <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>download_dataset</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.rwi.RelativeWealthIndexDownloader.download_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_dataset</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.rwi.RelativeWealthIndexDownloader.download_dataset class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download RWI dataset, optionally filtering for a specific country.</p> <p>If country is specified, attempts to find and download only the resources relevant to that country. Otherwise, downloads all RWI resources.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[str]</code> </td> <td> <div class=doc-md-description> <p>List of paths to the downloaded files</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/rwi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Download RWI dataset, optionally filtering for a specific country.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>    If country is specified, attempts to find and download only the resources</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    relevant to that country. Otherwise, downloads all RWI resources.</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>    Returns:</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        List of paths to the downloaded files</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=c1># If no country specified, download all resources</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>download_dataset</span><span class=p>()</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>    <span class=c1># Get all resources from the dataset</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>resources</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_dataset_resources</span><span class=p>()</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No resources found for RWI dataset&quot;</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=c1># Prepare country identifiers for matching</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=n>country_code</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=n>country_name</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=p>)</span><span class=o>.</span><span class=n>name</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=n>country_alpha2</span> <span class=o>=</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>        <span class=p>)</span><span class=o>.</span><span class=n>alpha_2</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=c1># Try different matching patterns</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=n>country_patterns</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL path with ISO3 prefix</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>            <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>,</span>  <span class=c1># URL path with ISO3 followed by extension</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># Filename with ISO3 in middle</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>country_code</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>,</span>  <span class=c1># Filename with ISO3 at end</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with no spaces</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with hyphens</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>country_alpha2</span><span class=si>}</span><span class=s2>_&quot;</span><span class=p>,</span>  <span class=c1># URL with ISO2 code</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=n>country_name</span><span class=p>,</span>  <span class=c1># Country name anywhere in URL</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=p>]</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=c1># Find matching resources</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=n>matching_resources</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=k>for</span> <span class=n>resource</span> <span class=ow>in</span> <span class=n>resources</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=c1># Get the URL safely</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=n>resource_url</span> <span class=o>=</span> <span class=n>resource</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;url&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>resource_url</span><span class=p>:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                <span class=k>continue</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=n>resource_url</span> <span class=o>=</span> <span class=n>resource_url</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>            <span class=c1># Check for matches with our patterns</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>pattern</span> <span class=ow>in</span> <span class=n>resource_url</span> <span class=k>for</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>country_patterns</span><span class=p>):</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>                <span class=n>matching_resources</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>resource</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>matching_resources</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                <span class=sa>f</span><span class=s2>&quot;No resources matching country &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&#39; were found. &quot;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>                <span class=sa>f</span><span class=s2>&quot;Consider downloading the full dataset with country=None and filtering afterwards.&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=c1># Download the matching resources</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>downloaded_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=k>for</span> <span class=n>res</span> <span class=ow>in</span> <span class=n>matching_resources</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>                <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Downloading resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=c1># Download to a temporary directory</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>TemporaryDirectory</span><span class=p>()</span> <span class=k>as</span> <span class=n>tmpdir</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                    <span class=n>url</span><span class=p>,</span> <span class=n>local_path</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>folder</span><span class=o>=</span><span class=n>tmpdir</span><span class=p>)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                    <span class=c1># Read the file and write to the DataStore</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>local_path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                        <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                    <span class=c1># Compose the target path in the DataStore</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                    <span class=n>target_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>                        <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_dir_path</span> <span class=o>/</span> <span class=n>Path</span><span class=p>(</span><span class=n>local_path</span><span class=p>)</span><span class=o>.</span><span class=n>name</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                    <span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>write_file</span><span class=p>(</span><span class=n>target_path</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                    <span class=n>downloaded_paths</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>target_path</span><span class=p>)</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                    <span class=sa>f</span><span class=s2>&quot;Downloaded resource: </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                <span class=p>)</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=n>resource_name</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;Unknown&quot;</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                    <span class=sa>f</span><span class=s2>&quot;Error downloading resource </span><span class=si>{</span><span class=n>resource_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                <span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=k>return</span> <span class=n>downloaded_paths</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error during country-filtered download: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=c1># Fall back to downloading all resources</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Falling back to downloading all RWI resources&quot;</span><span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>download_dataset</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.rwi.RelativeWealthIndexDownloader.from_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_config</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.rwi.RelativeWealthIndexDownloader.from_config class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create a downloader with RWI-specific configurations</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/rwi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=nd>@classmethod</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=k>def</span> <span class=nf>from_config</span><span class=p>(</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=n>country</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=p>):</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Create a downloader with RWI-specific configurations&quot;&quot;&quot;</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>RWIConfig</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=n>country</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=k>return</span> <span class=bp>cls</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.unicef_georepo class="doc doc-heading"> <code>unicef_georepo</code> <a href=#gigaspatial.handlers.unicef_georepo class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient class="doc doc-heading"> <code>GeoRepoClient</code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A client for interacting with the GeoRepo API.</p> <p>GeoRepo is a platform for managing and accessing geospatial administrative boundary data. This client provides methods to search, retrieve, and work with modules, datasets, views, and administrative entities.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.handlers.unicef_georepo.GeoRepoClient.base_url">base_url</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The base URL for the GeoRepo API</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.handlers.unicef_georepo.GeoRepoClient.api_key">api_key</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The API key for authentication</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.handlers.unicef_georepo.GeoRepoClient.email">email</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The email address associated with the API key</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.handlers.unicef_georepo.GeoRepoClient.headers">headers</span></code></td> <td> <code>dict</code> </td> <td> <div class=doc-md-description> <p>HTTP headers used for API requests</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-6>  6</a></span>
<span class=normal><a href=#__codelineno-0-7>  7</a></span>
<span class=normal><a href=#__codelineno-0-8>  8</a></span>
<span class=normal><a href=#__codelineno-0-9>  9</a></span>
<span class=normal><a href=#__codelineno-0-10> 10</a></span>
<span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=k>class</span> <span class=nc>GeoRepoClient</span><span class=p>:</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=sd>    A client for interacting with the GeoRepo API.</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=sd>    GeoRepo is a platform for managing and accessing geospatial administrative</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=sd>    boundary data. This client provides methods to search, retrieve, and work</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=sd>    with modules, datasets, views, and administrative entities.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>        base_url (str): The base URL for the GeoRepo API</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=sd>        api_key (str): The API key for authentication</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>        email (str): The email address associated with the API key</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>        headers (dict): HTTP headers used for API requests</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>api_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>        Initialize the GeoRepo client.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>        Args:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>            api_key (str, optional): GeoRepo API key. If not provided, will use</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>                the GEOREPO_API_KEY environment variable from config.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>            email (str, optional): Email address associated with the API key.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>                If not provided, will use the GEOREPO_USER_EMAIL environment</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>                variable from config.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>        Raises:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>            ValueError: If api_key or email is not provided and cannot be found</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>                in environment variables.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>        <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span> <span class=o>=</span> <span class=s2>&quot;https://georepo.unicef.org/api/v1&quot;</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>api_key</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>GEOREPO_API_KEY</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>email</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>GEOREPO_USER_EMAIL</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>                <span class=s2>&quot;API Key is required. Provide it as a parameter or set GEOREPO_API_KEY environment variable.&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=p>:</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>                <span class=s2>&quot;Email is required. Provide it as a parameter or set GEOREPO_USER_EMAIL environment variable.&quot;</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>            <span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=bp>self</span><span class=o>.</span><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>            <span class=s2>&quot;Accept&quot;</span><span class=p>:</span> <span class=s2>&quot;application/json&quot;</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=s2>&quot;Authorization&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Token </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=s2>&quot;GeoRepo-User-Key&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=p>}</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>    <span class=k>def</span> <span class=nf>_make_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Internal method to handle making HTTP requests.&quot;&quot;&quot;</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>request</span><span class=p>(</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>                <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>headers</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=k>return</span> <span class=n>response</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>            <span class=k>raise</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>HTTPError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;API request failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=k>def</span> <span class=nf>check_connection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>        Checks if the API connection is valid by making a simple request.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        Returns:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>            bool: True if the connection is valid, False otherwise.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/list/&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>HTTPError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=k>raise</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>                <span class=sa>f</span><span class=s2>&quot;Connection check encountered a network error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>    <span class=k>def</span> <span class=nf>list_modules</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        List all available modules in GeoRepo.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        A module is a top-level organizational unit that contains datasets.</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>        Examples include &quot;Admin Boundaries&quot;, &quot;Health Facilities&quot;, etc.</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>        Returns:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=sd>            dict: JSON response containing a list of modules with their metadata.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>                Each module includes &#39;uuid&#39;, &#39;name&#39;, &#39;description&#39;, and other properties.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>        Raises:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>            requests.HTTPError: If the API request fails.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/list/&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=k>def</span> <span class=nf>list_datasets_by_module</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>module_uuid</span><span class=p>):</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>        List all datasets within a specific module.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>        A dataset represents a collection of related geographic entities,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>        such as administrative boundaries for a specific country or region.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>        Args:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>            module_uuid (str): The UUID of the module to query.</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>        Returns:</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>            dict: JSON response containing a list of datasets with their metadata.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>                Each dataset includes &#39;uuid&#39;, &#39;name&#39;, &#39;description&#39;, creation date, etc.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>        Raises:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>            requests.HTTPError: If the API request fails or module_uuid is invalid.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/</span><span class=si>{</span><span class=n>module_uuid</span><span class=si>}</span><span class=s2>/dataset/list/&quot;</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=k>def</span> <span class=nf>get_dataset_details</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>dataset_uuid</span><span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        Get detailed information about a specific dataset.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        This includes metadata about the dataset and information about</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        available administrative levels (e.g., country, province, district).</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        Args:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>            dataset_uuid (str): The UUID of the dataset to query.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        Returns:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>            dict: JSON response containing dataset details including:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>                - Basic metadata (name, description, etc.)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>                - Available administrative levels and their properties</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>                - Temporal information and data sources</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>        Raises:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>            requests.HTTPError: If the API request fails or dataset_uuid is invalid.</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/dataset/</span><span class=si>{</span><span class=n>dataset_uuid</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>    <span class=k>def</span> <span class=nf>list_views_by_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>dataset_uuid</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        List views for a dataset with pagination support.</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        A view represents a specific version or subset of a dataset.</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        Views may be tagged as &#39;latest&#39; or represent different time periods.</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        Args:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>            dataset_uuid (str): The UUID of the dataset to query.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>            page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>            page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        Returns:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>            dict: JSON response containing paginated list of views with metadata.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>                Includes &#39;results&#39;, &#39;total_page&#39;, &#39;current_page&#39;, and &#39;count&#39; fields.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>                Each view includes &#39;uuid&#39;, &#39;name&#39;, &#39;tags&#39;, and other properties.</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        Raises:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>            requests.HTTPError: If the API request fails or dataset_uuid is invalid.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/dataset/</span><span class=si>{</span><span class=n>dataset_uuid</span><span class=si>}</span><span class=s2>/view/list/&quot;</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>    <span class=k>def</span> <span class=nf>list_entities_by_admin_level</span><span class=p>(</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=n>view_uuid</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;no_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;json&quot;</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=p>):</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=sd>        List entities at a specific administrative level within a view.</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><span class=sd>        Administrative levels typically follow a hierarchy:</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=sd>        - Level 0: Countries</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=sd>        - Level 1: States/Provinces/Regions</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=sd>        - Level 2: Districts/Counties</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>        - Level 3: Sub-districts/Municipalities</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>        - And so on...</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=sd>        Args:</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>            view_uuid (str): The UUID of the view to query.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><span class=sd>            admin_level (int): The administrative level to retrieve (0, 1, 2, etc.).</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=sd>            geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=sd>                - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>                - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>                - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=sd>                Defaults to &quot;no_geom&quot;.</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>            format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>                Defaults to &quot;json&quot;.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>            page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>            page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>        Returns:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>            tuple: A tuple containing:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>                - dict: JSON/GeoJSON response with entity data</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>                - dict: Metadata with pagination info (page, total_page, total_count)</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        Raises:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>            requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>,</span> <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=n>metadata</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=s2>&quot;total_page&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>            <span class=s2>&quot;total_count&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)),</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=p>}</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>(),</span> <span class=n>metadata</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=k>def</span> <span class=nf>get_entity_by_ucode</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span><span class=p>):</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>        Get detailed information about a specific entity using its Ucode.</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>        A Ucode (Universal Code) is a unique identifier for geographic entities</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>        within the GeoRepo system, typically in the format &quot;ISO3_LEVEL_NAME&quot;.</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>        Args:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=sd>            ucode (str): The unique code identifier for the entity.</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>            geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>                - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=sd>                - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>                - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>                Defaults to &quot;full_geom&quot;.</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>            format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>                Defaults to &quot;geojson&quot;.</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        Returns:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>            dict: JSON/GeoJSON response containing entity details including</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>                geometry, properties, administrative level, and metadata.</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>        Raises:</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>            requests.HTTPError: If the API request fails or ucode is invalid.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/entity/ucode/</span><span class=si>{</span><span class=n>ucode</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>    <span class=k>def</span> <span class=nf>list_entity_children</span><span class=p>(</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>entity_ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;no_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;json&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=p>):</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>        List direct children of an entity in the administrative hierarchy.</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>        For example, if given a country entity, this will return its states/provinces.</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><span class=sd>        If given a state entity, this will return its districts/counties.</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=sd>        Args:</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=sd>            view_uuid (str): The UUID of the view containing the entity.</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=sd>            entity_ucode (str): The Ucode of the parent entity.</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>            geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>                - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><span class=sd>                - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><span class=sd>                - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><span class=sd>                Defaults to &quot;no_geom&quot;.</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=sd>            format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=sd>                Defaults to &quot;json&quot;.</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><span class=sd>        Returns:</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=sd>            dict: JSON/GeoJSON response containing list of child entities</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>                with their properties and optional geometry data.</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>        Raises:</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>            requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/</span><span class=si>{</span><span class=n>entity_ucode</span><span class=si>}</span><span class=s2>/children/&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>        <span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>    <span class=k>def</span> <span class=nf>search_entities_by_name</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>        Search for entities by name using fuzzy matching.</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>        This performs a similarity-based search to find entities whose names</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>        match or are similar to the provided search term.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>        Args:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>            view_uuid (str): The UUID of the view to search within.</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>            name (str): The name or partial name to search for.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>            page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>            page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>        Returns:</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>            dict: JSON response containing paginated search results with</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>                matching entities and their similarity scores.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>        Raises:</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>            requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>    <span class=k>def</span> <span class=nf>get_admin_boundaries</span><span class=p>(</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=p>):</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=sd>        Get administrative boundaries for a specific level or all levels.</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>        This is a convenience method that can retrieve boundaries for a single</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>        administrative level or attempt to fetch all available levels.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>        Args:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=sd>            view_uuid (str): The UUID of the view to query.</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>            admin_level (int, optional): Administrative level to retrieve</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>                (0=country, 1=region, etc.). If None, attempts to fetch all levels.</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>            geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><span class=sd>                - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>                - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>                - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>                Defaults to &quot;full_geom&quot;.</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>            format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>                Defaults to &quot;geojson&quot;.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>        Returns:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>            dict: JSON/GeoJSON response containing administrative boundaries</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>                in the specified format. For GeoJSON, returns a FeatureCollection.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>        Raises:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>            requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>        <span class=c1># Construct the endpoint based on whether admin_level is provided</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>            <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>            <span class=p>)</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>            <span class=c1># For all levels, we need to fetch level 0 and then get children for each entity</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>            <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/list/&quot;</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>            <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>            <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>        <span class=p>}</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>    <span class=k>def</span> <span class=nf>get_vector_tiles_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_info</span><span class=p>):</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=sd>        Generate an authenticated URL for accessing vector tiles.</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><span class=sd>        Vector tiles are used for efficient map rendering and can be consumed</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=sd>        by mapping libraries like Mapbox GL JS or OpenLayers.</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><span class=sd>        Args:</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><span class=sd>            view_info (dict): Dictionary containing view information that must</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=sd>                include a &#39;vector_tiles&#39; key with the base vector tiles URL.</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=sd>        Returns:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=sd>            str: Fully authenticated vector tiles URL with API key and user email</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>                parameters appended for access control.</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><span class=sd>        Raises:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>            ValueError: If &#39;vector_tiles&#39; key is not found in view_info.</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>        <span class=k>if</span> <span class=s2>&quot;vector_tiles&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>view_info</span><span class=p>:</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Vector tiles URL not found in view information&quot;</span><span class=p>)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>        <span class=n>vector_tiles_url</span> <span class=o>=</span> <span class=n>view_info</span><span class=p>[</span><span class=s2>&quot;vector_tiles&quot;</span><span class=p>]</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=c1># Parse out the timestamp parameter if it exists</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=k>if</span> <span class=s2>&quot;?t=&quot;</span> <span class=ow>in</span> <span class=n>vector_tiles_url</span><span class=p>:</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>            <span class=n>base_url</span><span class=p>,</span> <span class=n>timestamp</span> <span class=o>=</span> <span class=n>vector_tiles_url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;?t=&quot;</span><span class=p>)</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>            <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>?t=</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>&amp;token=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&amp;georepo_user_key=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>            <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>vector_tiles_url</span><span class=si>}</span><span class=s2>?token=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&amp;georepo_user_key=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>            <span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>    <span class=k>def</span> <span class=nf>find_country_by_iso3</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>iso3_code</span><span class=p>):</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>        Find a country entity using its ISO3 country code.</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>        This method searches through all level-0 (country) entities to find</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>        one that matches the provided ISO3 code. It checks both the entity&#39;s</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>        Ucode and any external codes stored in the ext_codes field.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>        Args:</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>            view_uuid (str): The UUID of the view to search within.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            iso3_code (str): The ISO3 country code to search for (e.g., &#39;USA&#39;, &#39;KEN&#39;, &#39;BRA&#39;).</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>        Returns:</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>            dict or None: Entity information dictionary for the matching country</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>                if found, including properties like name, ucode, admin_level, etc.</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>                Returns None if no matching country is found.</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>        Note:</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>            This method handles pagination automatically to search through all</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>            available countries in the dataset, which may involve multiple API calls.</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>        Raises:</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>            requests.HTTPError: If the API request fails or view_uuid is invalid.</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=c1># Admin level 0 represents countries</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/0/&quot;</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>            <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>            <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=s2>&quot;no_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>        <span class=p>}</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>        <span class=c1># need to paginate since it can be a large dataset</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>        <span class=n>all_countries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>        <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>            <span class=n>params</span><span class=p>[</span><span class=s2>&quot;page&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>page</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>            <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>            <span class=n>countries</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>            <span class=n>all_countries</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>countries</span><span class=p>)</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>            <span class=c1># check if there are more pages</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>            <span class=k>if</span> <span class=n>page</span> <span class=o>&gt;=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>                <span class=k>break</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>            <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>        <span class=c1># Search by ISO3 code</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>        <span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>all_countries</span><span class=p>:</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>            <span class=c1># Check if ISO3 code is in the ucode (typically at the beginning)</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>            <span class=k>if</span> <span class=n>country</span><span class=p>[</span><span class=s2>&quot;ucode&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>iso3_code</span> <span class=o>+</span> <span class=s2>&quot;_&quot;</span><span class=p>):</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>                <span class=k>return</span> <span class=n>country</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>            <span class=c1># Also check in ext_codes which may contain the ISO3 code</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>            <span class=n>ext_codes</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ext_codes&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>            <span class=k>if</span> <span class=n>ext_codes</span><span class=p>:</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>                <span class=c1># Check if ISO3 is directly in ext_codes</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>                <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>                    <span class=n>ext_codes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;PCode&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>iso3_code</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>                    <span class=ow>or</span> <span class=n>ext_codes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;default&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>iso3_code</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>                <span class=p>):</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>                    <span class=k>return</span> <span class=n>country</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>api_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the GeoRepo client.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>api_key</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>GeoRepo API key. If not provided, will use the GEOREPO_API_KEY environment variable from config.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>email</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Email address associated with the API key. If not provided, will use the GEOREPO_USER_EMAIL environment variable from config.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If api_key or email is not provided and cannot be found in environment variables.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>api_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    Initialize the GeoRepo client.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    Args:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>        api_key (str, optional): GeoRepo API key. If not provided, will use</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>            the GEOREPO_API_KEY environment variable from config.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>        email (str, optional): Email address associated with the API key.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>            If not provided, will use the GEOREPO_USER_EMAIL environment</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>            variable from config.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    Raises:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        ValueError: If api_key or email is not provided and cannot be found</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>            in environment variables.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=bp>self</span><span class=o>.</span><span class=n>base_url</span> <span class=o>=</span> <span class=s2>&quot;https://georepo.unicef.org/api/v1&quot;</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>api_key</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>GEOREPO_API_KEY</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>email</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>GEOREPO_USER_EMAIL</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=s2>&quot;API Key is required. Provide it as a parameter or set GEOREPO_API_KEY environment variable.&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=p>:</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>            <span class=s2>&quot;Email is required. Provide it as a parameter or set GEOREPO_USER_EMAIL environment variable.&quot;</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=p>)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=bp>self</span><span class=o>.</span><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=s2>&quot;Accept&quot;</span><span class=p>:</span> <span class=s2>&quot;application/json&quot;</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=s2>&quot;Authorization&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;Token </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>        <span class=s2>&quot;GeoRepo-User-Key&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=p>,</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.check_connection class="doc doc-heading"> <code class="highlight language-python"><span class=n>check_connection</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.check_connection class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Checks if the API connection is valid by making a simple request.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>True if the connection is valid, False otherwise.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=k>def</span> <span class=nf>check_connection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>    Checks if the API connection is valid by making a simple request.</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>    Returns:</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        bool: True if the connection is valid, False otherwise.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/list/&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>HTTPError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=k>raise</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span><span class=p>(</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=sa>f</span><span class=s2>&quot;Connection check encountered a network error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.find_country_by_iso3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>find_country_by_iso3</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>iso3_code</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.find_country_by_iso3 class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Find a country entity using its ISO3 country code.</p> <p>This method searches through all level-0 (country) entities to find one that matches the provided ISO3 code. It checks both the entity's Ucode and any external codes stored in the ext_codes field.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the view to search within.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>iso3_code</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The ISO3 country code to search for (e.g., 'USA', 'KEN', 'BRA').</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>dict or None: Entity information dictionary for the matching country if found, including properties like name, ucode, admin_level, etc. Returns None if no matching country is found.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>This method handles pagination automatically to search through all available countries in the dataset, which may involve multiple API calls.</p> </details> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or view_uuid is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=k>def</span> <span class=nf>find_country_by_iso3</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>iso3_code</span><span class=p>):</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>    Find a country entity using its ISO3 country code.</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>    This method searches through all level-0 (country) entities to find</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>    one that matches the provided ISO3 code. It checks both the entity&#39;s</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>    Ucode and any external codes stored in the ext_codes field.</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>    Args:</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>        view_uuid (str): The UUID of the view to search within.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        iso3_code (str): The ISO3 country code to search for (e.g., &#39;USA&#39;, &#39;KEN&#39;, &#39;BRA&#39;).</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>    Returns:</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>        dict or None: Entity information dictionary for the matching country</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>            if found, including properties like name, ucode, admin_level, etc.</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>            Returns None if no matching country is found.</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>    Note:</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>        This method handles pagination automatically to search through all</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>        available countries in the dataset, which may involve multiple API calls.</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>    Raises:</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>        requests.HTTPError: If the API request fails or view_uuid is invalid.</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>    <span class=c1># Admin level 0 represents countries</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/0/&quot;</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>        <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=s2>&quot;no_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>    <span class=p>}</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>    <span class=c1># need to paginate since it can be a large dataset</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>    <span class=n>all_countries</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>    <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>        <span class=n>params</span><span class=p>[</span><span class=s2>&quot;page&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>page</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>        <span class=n>countries</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>        <span class=n>all_countries</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>countries</span><span class=p>)</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>        <span class=c1># check if there are more pages</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=k>if</span> <span class=n>page</span> <span class=o>&gt;=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>            <span class=k>break</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>        <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>    <span class=c1># Search by ISO3 code</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>    <span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>all_countries</span><span class=p>:</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>        <span class=c1># Check if ISO3 code is in the ucode (typically at the beginning)</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>        <span class=k>if</span> <span class=n>country</span><span class=p>[</span><span class=s2>&quot;ucode&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>iso3_code</span> <span class=o>+</span> <span class=s2>&quot;_&quot;</span><span class=p>):</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>            <span class=k>return</span> <span class=n>country</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=c1># Also check in ext_codes which may contain the ISO3 code</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>        <span class=n>ext_codes</span> <span class=o>=</span> <span class=n>country</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ext_codes&quot;</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>        <span class=k>if</span> <span class=n>ext_codes</span><span class=p>:</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>            <span class=c1># Check if ISO3 is directly in ext_codes</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>            <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>                <span class=n>ext_codes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;PCode&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>iso3_code</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>                <span class=ow>or</span> <span class=n>ext_codes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;default&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>iso3_code</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>            <span class=p>):</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>                <span class=k>return</span> <span class=n>country</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>    <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_admin_boundaries class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_admin_boundaries</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s1>&#39;full_geom&#39;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;geojson&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_admin_boundaries class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get administrative boundaries for a specific level or all levels.</p> <p>This is a convenience method that can retrieve boundaries for a single administrative level or attempt to fetch all available levels.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the view to query.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>admin_level</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Administrative level to retrieve (0=country, 1=region, etc.). If None, attempts to fetch all levels.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>geom</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Geometry inclusion level. Options: - "no_geom": No geometry data - "centroid": Only centroid points - "full_geom": Complete boundary geometries Defaults to "full_geom".</p> </div> </td> <td> <code>&#39;full_geom&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>format</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Response format ("json" or "geojson"). Defaults to "geojson".</p> </div> </td> <td> <code>&#39;geojson&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON/GeoJSON response containing administrative boundaries in the specified format. For GeoJSON, returns a FeatureCollection.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or parameters are invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><span class=k>def</span> <span class=nf>get_admin_boundaries</span><span class=p>(</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=p>):</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=sd>    Get administrative boundaries for a specific level or all levels.</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>    This is a convenience method that can retrieve boundaries for a single</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>    administrative level or attempt to fetch all available levels.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>    Args:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=sd>        view_uuid (str): The UUID of the view to query.</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>        admin_level (int, optional): Administrative level to retrieve</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>            (0=country, 1=region, etc.). If None, attempts to fetch all levels.</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>        geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><span class=sd>            - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>            - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>            - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>            Defaults to &quot;full_geom&quot;.</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>        format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>            Defaults to &quot;geojson&quot;.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>    Returns:</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>        dict: JSON/GeoJSON response containing administrative boundaries</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>            in the specified format. For GeoJSON, returns a FeatureCollection.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>    Raises:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>    <span class=c1># Construct the endpoint based on whether admin_level is provided</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>    <span class=k>if</span> <span class=n>admin_level</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>        <span class=p>)</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=c1># For all levels, we need to fetch level 0 and then get children for each entity</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>        <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/list/&quot;</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>        <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>    <span class=p>}</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_dataset_details class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_dataset_details</span><span class=p>(</span><span class=n>dataset_uuid</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_dataset_details class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get detailed information about a specific dataset.</p> <p>This includes metadata about the dataset and information about available administrative levels (e.g., country, province, district).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dataset_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the dataset to query.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON response containing dataset details including: - Basic metadata (name, description, etc.) - Available administrative levels and their properties - Temporal information and data sources</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or dataset_uuid is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=k>def</span> <span class=nf>get_dataset_details</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>dataset_uuid</span><span class=p>):</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    Get detailed information about a specific dataset.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    This includes metadata about the dataset and information about</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>    available administrative levels (e.g., country, province, district).</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    Args:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        dataset_uuid (str): The UUID of the dataset to query.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>    Returns:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        dict: JSON response containing dataset details including:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>            - Basic metadata (name, description, etc.)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>            - Available administrative levels and their properties</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>            - Temporal information and data sources</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>    Raises:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>        requests.HTTPError: If the API request fails or dataset_uuid is invalid.</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/dataset/</span><span class=si>{</span><span class=n>dataset_uuid</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_entity_by_ucode class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_entity_by_ucode</span><span class=p>(</span><span class=n>ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s1>&#39;full_geom&#39;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;geojson&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_entity_by_ucode class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get detailed information about a specific entity using its Ucode.</p> <p>A Ucode (Universal Code) is a unique identifier for geographic entities within the GeoRepo system, typically in the format "ISO3_LEVEL_NAME".</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ucode</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The unique code identifier for the entity.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>geom</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Geometry inclusion level. Options: - "no_geom": No geometry data - "centroid": Only centroid points - "full_geom": Complete boundary geometries Defaults to "full_geom".</p> </div> </td> <td> <code>&#39;full_geom&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>format</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Response format ("json" or "geojson"). Defaults to "geojson".</p> </div> </td> <td> <code>&#39;geojson&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON/GeoJSON response containing entity details including geometry, properties, administrative level, and metadata.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or ucode is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=k>def</span> <span class=nf>get_entity_by_ucode</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span><span class=p>):</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>    Get detailed information about a specific entity using its Ucode.</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>    A Ucode (Universal Code) is a unique identifier for geographic entities</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>    within the GeoRepo system, typically in the format &quot;ISO3_LEVEL_NAME&quot;.</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>    Args:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=sd>        ucode (str): The unique code identifier for the entity.</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>        geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>            - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=sd>            - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>            - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>            Defaults to &quot;full_geom&quot;.</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>            Defaults to &quot;geojson&quot;.</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>    Returns:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        dict: JSON/GeoJSON response containing entity details including</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>            geometry, properties, administrative level, and metadata.</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>    Raises:</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>        requests.HTTPError: If the API request fails or ucode is invalid.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/entity/ucode/</span><span class=si>{</span><span class=n>ucode</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_vector_tiles_url class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_vector_tiles_url</span><span class=p>(</span><span class=n>view_info</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.get_vector_tiles_url class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Generate an authenticated URL for accessing vector tiles.</p> <p>Vector tiles are used for efficient map rendering and can be consumed by mapping libraries like Mapbox GL JS or OpenLayers.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_info</code></td> <td> <code>dict</code> </td> <td> <div class=doc-md-description> <p>Dictionary containing view information that must include a 'vector_tiles' key with the base vector tiles URL.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>Fully authenticated vector tiles URL with API key and user email parameters appended for access control.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If 'vector_tiles' key is not found in view_info.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><span class=k>def</span> <span class=nf>get_vector_tiles_url</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_info</span><span class=p>):</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=sd>    Generate an authenticated URL for accessing vector tiles.</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><span class=sd>    Vector tiles are used for efficient map rendering and can be consumed</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=sd>    by mapping libraries like Mapbox GL JS or OpenLayers.</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><span class=sd>    Args:</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><span class=sd>        view_info (dict): Dictionary containing view information that must</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=sd>            include a &#39;vector_tiles&#39; key with the base vector tiles URL.</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=sd>    Returns:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=sd>        str: Fully authenticated vector tiles URL with API key and user email</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>            parameters appended for access control.</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a><span class=sd>    Raises:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>        ValueError: If &#39;vector_tiles&#39; key is not found in view_info.</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>    <span class=k>if</span> <span class=s2>&quot;vector_tiles&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>view_info</span><span class=p>:</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Vector tiles URL not found in view information&quot;</span><span class=p>)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>    <span class=n>vector_tiles_url</span> <span class=o>=</span> <span class=n>view_info</span><span class=p>[</span><span class=s2>&quot;vector_tiles&quot;</span><span class=p>]</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>    <span class=c1># Parse out the timestamp parameter if it exists</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>    <span class=k>if</span> <span class=s2>&quot;?t=&quot;</span> <span class=ow>in</span> <span class=n>vector_tiles_url</span><span class=p>:</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>        <span class=n>base_url</span><span class=p>,</span> <span class=n>timestamp</span> <span class=o>=</span> <span class=n>vector_tiles_url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;?t=&quot;</span><span class=p>)</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>base_url</span><span class=si>}</span><span class=s2>?t=</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>&amp;token=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&amp;georepo_user_key=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>        <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>vector_tiles_url</span><span class=si>}</span><span class=s2>?token=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&amp;georepo_user_key=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>        <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_datasets_by_module class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_datasets_by_module</span><span class=p>(</span><span class=n>module_uuid</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_datasets_by_module class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List all datasets within a specific module.</p> <p>A dataset represents a collection of related geographic entities, such as administrative boundaries for a specific country or region.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>module_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the module to query.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON response containing a list of datasets with their metadata. Each dataset includes 'uuid', 'name', 'description', creation date, etc.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or module_uuid is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=k>def</span> <span class=nf>list_datasets_by_module</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>module_uuid</span><span class=p>):</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>    List all datasets within a specific module.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>    A dataset represents a collection of related geographic entities,</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    such as administrative boundaries for a specific country or region.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    Args:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>        module_uuid (str): The UUID of the module to query.</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    Returns:</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>        dict: JSON response containing a list of datasets with their metadata.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>            Each dataset includes &#39;uuid&#39;, &#39;name&#39;, &#39;description&#39;, creation date, etc.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    Raises:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        requests.HTTPError: If the API request fails or module_uuid is invalid.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/</span><span class=si>{</span><span class=n>module_uuid</span><span class=si>}</span><span class=s2>/dataset/list/&quot;</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_entities_by_admin_level class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_entities_by_admin_level</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>admin_level</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s1>&#39;no_geom&#39;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;json&#39;</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_entities_by_admin_level class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List entities at a specific administrative level within a view.</p> <p>Administrative levels typically follow a hierarchy: - Level 0: Countries - Level 1: States/Provinces/Regions - Level 2: Districts/Counties - Level 3: Sub-districts/Municipalities - And so on...</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the view to query.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>admin_level</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The administrative level to retrieve (0, 1, 2, etc.).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>geom</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Geometry inclusion level. Options: - "no_geom": No geometry data - "centroid": Only centroid points - "full_geom": Complete boundary geometries Defaults to "no_geom".</p> </div> </td> <td> <code>&#39;no_geom&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>format</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Response format ("json" or "geojson"). Defaults to "json".</p> </div> </td> <td> <code>&#39;json&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>page</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Page number for pagination. Defaults to 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td><code>page_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Number of results per page. Defaults to 50.</p> </div> </td> <td> <code>50</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tuple</code></td> <td> </td> <td> <div class=doc-md-description> <p>A tuple containing: - dict: JSON/GeoJSON response with entity data - dict: Metadata with pagination info (page, total_page, total_count)</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or parameters are invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=k>def</span> <span class=nf>list_entities_by_admin_level</span><span class=p>(</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>    <span class=n>view_uuid</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>    <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;no_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;json&quot;</span><span class=p>,</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>    <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>    <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a><span class=p>):</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=sd>    List entities at a specific administrative level within a view.</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><span class=sd>    Administrative levels typically follow a hierarchy:</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=sd>    - Level 0: Countries</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a><span class=sd>    - Level 1: States/Provinces/Regions</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=sd>    - Level 2: Districts/Counties</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=sd>    - Level 3: Sub-districts/Municipalities</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>    - And so on...</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=sd>    Args:</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>        view_uuid (str): The UUID of the view to query.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><span class=sd>        admin_level (int): The administrative level to retrieve (0, 1, 2, etc.).</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=sd>        geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=sd>            - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>            - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>            - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=sd>            Defaults to &quot;no_geom&quot;.</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>        format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>            Defaults to &quot;json&quot;.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>        page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>        page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>    Returns:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>        tuple: A tuple containing:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>            - dict: JSON/GeoJSON response with entity data</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>            - dict: Metadata with pagination info (page, total_page, total_count)</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>    Raises:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>        requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>        <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/level/</span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>,</span> <span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=s2>&quot;total_page&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)),</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>        <span class=s2>&quot;total_count&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)),</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>    <span class=p>}</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>(),</span> <span class=n>metadata</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_entity_children class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_entity_children</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>entity_ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s1>&#39;no_geom&#39;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;json&#39;</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_entity_children class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List direct children of an entity in the administrative hierarchy.</p> <p>For example, if given a country entity, this will return its states/provinces. If given a state entity, this will return its districts/counties.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the view containing the entity.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>entity_ucode</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The Ucode of the parent entity.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>geom</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Geometry inclusion level. Options: - "no_geom": No geometry data - "centroid": Only centroid points - "full_geom": Complete boundary geometries Defaults to "no_geom".</p> </div> </td> <td> <code>&#39;no_geom&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>format</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Response format ("json" or "geojson"). Defaults to "json".</p> </div> </td> <td> <code>&#39;json&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON/GeoJSON response containing list of child entities with their properties and optional geometry data.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or parameters are invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=k>def</span> <span class=nf>list_entity_children</span><span class=p>(</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>entity_ucode</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;no_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;json&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=p>):</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>    List direct children of an entity in the administrative hierarchy.</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a><span class=sd>    For example, if given a country entity, this will return its states/provinces.</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><span class=sd>    If given a state entity, this will return its districts/counties.</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=sd>    Args:</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a><span class=sd>        view_uuid (str): The UUID of the view containing the entity.</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=sd>        entity_ucode (str): The Ucode of the parent entity.</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>        geom (str, optional): Geometry inclusion level. Options:</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>            - &quot;no_geom&quot;: No geometry data</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a><span class=sd>            - &quot;centroid&quot;: Only centroid points</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><span class=sd>            - &quot;full_geom&quot;: Complete boundary geometries</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a><span class=sd>            Defaults to &quot;no_geom&quot;.</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=sd>        format (str, optional): Response format (&quot;json&quot; or &quot;geojson&quot;).</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=sd>            Defaults to &quot;json&quot;.</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><span class=sd>    Returns:</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=sd>        dict: JSON/GeoJSON response containing list of child entities</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>            with their properties and optional geometry data.</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>    Raises:</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>        requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/</span><span class=si>{</span><span class=n>entity_ucode</span><span class=si>}</span><span class=s2>/children/&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=p>)</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;geom&quot;</span><span class=p>:</span> <span class=n>geom</span><span class=p>,</span> <span class=s2>&quot;format&quot;</span><span class=p>:</span> <span class=nb>format</span><span class=p>}</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_modules class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_modules</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_modules class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List all available modules in GeoRepo.</p> <p>A module is a top-level organizational unit that contains datasets. Examples include "Admin Boundaries", "Health Facilities", etc.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON response containing a list of modules with their metadata. Each module includes 'uuid', 'name', 'description', and other properties.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=k>def</span> <span class=nf>list_modules</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>    List all available modules in GeoRepo.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>    A module is a top-level organizational unit that contains datasets.</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>    Examples include &quot;Admin Boundaries&quot;, &quot;Health Facilities&quot;, etc.</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>    Returns:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=sd>        dict: JSON response containing a list of modules with their metadata.</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>            Each module includes &#39;uuid&#39;, &#39;name&#39;, &#39;description&#39;, and other properties.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>    Raises:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        requests.HTTPError: If the API request fails.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/module/list/&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_views_by_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_views_by_dataset</span><span class=p>(</span><span class=n>dataset_uuid</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.list_views_by_dataset class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>List views for a dataset with pagination support.</p> <p>A view represents a specific version or subset of a dataset. Views may be tagged as 'latest' or represent different time periods.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dataset_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the dataset to query.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>page</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Page number for pagination. Defaults to 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td><code>page_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Number of results per page. Defaults to 50.</p> </div> </td> <td> <code>50</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON response containing paginated list of views with metadata. Includes 'results', 'total_page', 'current_page', and 'count' fields. Each view includes 'uuid', 'name', 'tags', and other properties.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or dataset_uuid is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=k>def</span> <span class=nf>list_views_by_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>dataset_uuid</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>    List views for a dataset with pagination support.</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    A view represents a specific version or subset of a dataset.</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    Views may be tagged as &#39;latest&#39; or represent different time periods.</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>    Args:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>        dataset_uuid (str): The UUID of the dataset to query.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>    Returns:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        dict: JSON response containing paginated list of views with metadata.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>            Includes &#39;results&#39;, &#39;total_page&#39;, &#39;current_page&#39;, and &#39;count&#39; fields.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>            Each view includes &#39;uuid&#39;, &#39;name&#39;, &#39;tags&#39;, and other properties.</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>    Raises:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        requests.HTTPError: If the API request fails or dataset_uuid is invalid.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/dataset/</span><span class=si>{</span><span class=n>dataset_uuid</span><span class=si>}</span><span class=s2>/view/list/&quot;</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.unicef_georepo.GeoRepoClient.search_entities_by_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>search_entities_by_name</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.GeoRepoClient.search_entities_by_name class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Search for entities by name using fuzzy matching.</p> <p>This performs a similarity-based search to find entities whose names match or are similar to the provided search term.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_uuid</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The UUID of the view to search within.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>name</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The name or partial name to search for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>page</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Page number for pagination. Defaults to 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td><code>page_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Number of results per page. Defaults to 50.</p> </div> </td> <td> <code>50</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>JSON response containing paginated search results with matching entities and their similarity scores.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If the API request fails or parameters are invalid.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=k>def</span> <span class=nf>search_entities_by_name</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>    Search for entities by name using fuzzy matching.</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>    This performs a similarity-based search to find entities whose names</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>    match or are similar to the provided search term.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>    Args:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>        view_uuid (str): The UUID of the view to search within.</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>        name (str): The name or partial name to search for.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>        page (int, optional): Page number for pagination. Defaults to 1.</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>        page_size (int, optional): Number of results per page. Defaults to 50.</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>    Returns:</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>        dict: JSON response containing paginated search results with</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>            matching entities and their similarity scores.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>    Raises:</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>        requests.HTTPError: If the API request fails or parameters are invalid.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>    <span class=n>endpoint</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>base_url</span><span class=si>}</span><span class=s2>/search/view/</span><span class=si>{</span><span class=n>view_uuid</span><span class=si>}</span><span class=s2>/entity/</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>/&quot;</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;page&quot;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&quot;page_size&quot;</span><span class=p>:</span> <span class=n>page_size</span><span class=p>}</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>    <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_make_request</span><span class=p>(</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.unicef_georepo.find_admin_boundaries_module class="doc doc-heading"> <code class="highlight language-python"><span class=n>find_admin_boundaries_module</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.unicef_georepo.find_admin_boundaries_module class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Find and return the UUID of the Admin Boundaries module.</p> <p>This is a convenience function that searches through all available modules to locate the one named "Admin Boundaries", which typically contains administrative boundary datasets.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>The UUID of the Admin Boundaries module.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If the Admin Boundaries module is not found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=k>def</span> <span class=nf>find_admin_boundaries_module</span><span class=p>():</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a><span class=sd>    Find and return the UUID of the Admin Boundaries module.</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a><span class=sd>    This is a convenience function that searches through all available modules</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a><span class=sd>    to locate the one named &quot;Admin Boundaries&quot;, which typically contains</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a><span class=sd>    administrative boundary datasets.</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a><span class=sd>    Returns:</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a><span class=sd>        str: The UUID of the Admin Boundaries module.</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a><span class=sd>    Raises:</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a><span class=sd>        ValueError: If the Admin Boundaries module is not found.</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>    <span class=n>client</span> <span class=o>=</span> <span class=n>GeoRepoClient</span><span class=p>()</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>    <span class=n>modules</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_modules</span><span class=p>()</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>    <span class=k>for</span> <span class=n>module</span> <span class=ow>in</span> <span class=n>modules</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>        <span class=k>if</span> <span class=n>module</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;Admin Boundaries&quot;</span><span class=p>:</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>            <span class=k>return</span> <span class=n>module</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Admin Boundaries module not found&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3 class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_country_boundaries_by_iso3</span><span class=p>(</span><span class=n>iso3_code</span><span class=p>,</span> <span class=n>client</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3 class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Get administrative boundaries for a specific country using its ISO3 code.</p> <p>This function provides a high-level interface to retrieve country boundaries by automatically finding the appropriate module, dataset, and view, then fetching the requested administrative boundaries.</p> <p>The function will: 1. Find the Admin Boundaries module 2. Locate a global dataset within that module 3. Find the latest view of that dataset 4. Search for the country using the ISO3 code 5. Look for a country-specific view if available 6. Retrieve boundaries at the specified admin level or all levels</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>iso3_code</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The ISO3 country code (e.g., 'USA', 'KEN', 'BRA').</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>admin_level</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The administrative level to retrieve: - 0: Country level - 1: State/Province/Region level - 2: District/County level - 3: Sub-district/Municipality level - etc. If None, retrieves all available administrative levels.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>A GeoJSON FeatureCollection containing the requested boundaries. Each feature includes geometry and properties for the administrative unit.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If the Admin Boundaries module, datasets, views, or country cannot be found.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title="requests.HTTPError">HTTPError</span></code> </td> <td> <div class=doc-md-description> <p>If any API requests fail.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>This function may make multiple API calls and can take some time for countries with many administrative units. It handles pagination automatically and attempts to use country-specific views when available for better performance.</p> </details> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <h5 id=gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3--get-all-administrative-levels-for-kenya>Get all administrative levels for Kenya<a class=headerlink href=#gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3--get-all-administrative-levels-for-kenya title="Permanent link">&para;</a></h5> <p>boundaries = get_country_boundaries_by_iso3('KEN')</p> <h5 id=gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3--get-only-province-level-boundaries-for-kenya>Get only province-level boundaries for Kenya<a class=headerlink href=#gigaspatial.handlers.unicef_georepo.get_country_boundaries_by_iso3--get-only-province-level-boundaries-for-kenya title="Permanent link">&para;</a></h5> <p>provinces = get_country_boundaries_by_iso3('KEN', admin_level=1)</p> </blockquote> </blockquote> </blockquote> </details> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/unicef_georepo.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span>
<span class=normal><a href=#__codelineno-0-772>772</a></span>
<span class=normal><a href=#__codelineno-0-773>773</a></span>
<span class=normal><a href=#__codelineno-0-774>774</a></span>
<span class=normal><a href=#__codelineno-0-775>775</a></span>
<span class=normal><a href=#__codelineno-0-776>776</a></span>
<span class=normal><a href=#__codelineno-0-777>777</a></span>
<span class=normal><a href=#__codelineno-0-778>778</a></span>
<span class=normal><a href=#__codelineno-0-779>779</a></span>
<span class=normal><a href=#__codelineno-0-780>780</a></span>
<span class=normal><a href=#__codelineno-0-781>781</a></span>
<span class=normal><a href=#__codelineno-0-782>782</a></span>
<span class=normal><a href=#__codelineno-0-783>783</a></span>
<span class=normal><a href=#__codelineno-0-784>784</a></span>
<span class=normal><a href=#__codelineno-0-785>785</a></span>
<span class=normal><a href=#__codelineno-0-786>786</a></span>
<span class=normal><a href=#__codelineno-0-787>787</a></span>
<span class=normal><a href=#__codelineno-0-788>788</a></span>
<span class=normal><a href=#__codelineno-0-789>789</a></span>
<span class=normal><a href=#__codelineno-0-790>790</a></span>
<span class=normal><a href=#__codelineno-0-791>791</a></span>
<span class=normal><a href=#__codelineno-0-792>792</a></span>
<span class=normal><a href=#__codelineno-0-793>793</a></span>
<span class=normal><a href=#__codelineno-0-794>794</a></span>
<span class=normal><a href=#__codelineno-0-795>795</a></span>
<span class=normal><a href=#__codelineno-0-796>796</a></span>
<span class=normal><a href=#__codelineno-0-797>797</a></span>
<span class=normal><a href=#__codelineno-0-798>798</a></span>
<span class=normal><a href=#__codelineno-0-799>799</a></span>
<span class=normal><a href=#__codelineno-0-800>800</a></span>
<span class=normal><a href=#__codelineno-0-801>801</a></span>
<span class=normal><a href=#__codelineno-0-802>802</a></span>
<span class=normal><a href=#__codelineno-0-803>803</a></span>
<span class=normal><a href=#__codelineno-0-804>804</a></span>
<span class=normal><a href=#__codelineno-0-805>805</a></span>
<span class=normal><a href=#__codelineno-0-806>806</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a><span class=k>def</span> <span class=nf>get_country_boundaries_by_iso3</span><span class=p>(</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>    <span class=n>iso3_code</span><span class=p>,</span> <span class=n>client</span><span class=p>:</span> <span class=n>GeoRepoClient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>admin_level</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a><span class=p>):</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a><span class=sd>    Get administrative boundaries for a specific country using its ISO3 code.</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a><span class=sd>    This function provides a high-level interface to retrieve country boundaries</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a><span class=sd>    by automatically finding the appropriate module, dataset, and view, then</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a><span class=sd>    fetching the requested administrative boundaries.</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a><span class=sd>    The function will:</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=sd>    1. Find the Admin Boundaries module</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a><span class=sd>    2. Locate a global dataset within that module</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=sd>    3. Find the latest view of that dataset</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=sd>    4. Search for the country using the ISO3 code</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>    5. Look for a country-specific view if available</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>    6. Retrieve boundaries at the specified admin level or all levels</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>    Args:</span>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>        iso3_code (str): The ISO3 country code (e.g., &#39;USA&#39;, &#39;KEN&#39;, &#39;BRA&#39;).</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a><span class=sd>        admin_level (int, optional): The administrative level to retrieve:</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a><span class=sd>            - 0: Country level</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a><span class=sd>            - 1: State/Province/Region level</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a><span class=sd>            - 2: District/County level</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a><span class=sd>            - 3: Sub-district/Municipality level</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a><span class=sd>            - etc.</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a><span class=sd>            If None, retrieves all available administrative levels.</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a><span class=sd>    Returns:</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=sd>        dict: A GeoJSON FeatureCollection containing the requested boundaries.</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a><span class=sd>            Each feature includes geometry and properties for the administrative unit.</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=sd>    Raises:</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a><span class=sd>        ValueError: If the Admin Boundaries module, datasets, views, or country</span>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a><span class=sd>            cannot be found.</span>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>        requests.HTTPError: If any API requests fail.</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>    Note:</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>        This function may make multiple API calls and can take some time for</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>        countries with many administrative units. It handles pagination</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>        automatically and attempts to use country-specific views when available</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        for better performance.</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a><span class=sd>    Example:</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>        &gt;&gt;&gt; # Get all administrative levels for Kenya</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a><span class=sd>        &gt;&gt;&gt; boundaries = get_country_boundaries_by_iso3(&#39;KEN&#39;)</span>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>        &gt;&gt;&gt;</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>        &gt;&gt;&gt; # Get only province-level boundaries for Kenya</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>        &gt;&gt;&gt; provinces = get_country_boundaries_by_iso3(&#39;KEN&#39;, admin_level=1)</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>    <span class=n>client</span> <span class=o>=</span> <span class=n>client</span> <span class=ow>or</span> <span class=n>GeoRepoClient</span><span class=p>()</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Finding Admin Boundaries module...&quot;</span><span class=p>)</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>    <span class=n>modules</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_modules</span><span class=p>()</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>    <span class=n>admin_module_uuid</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>    <span class=k>for</span> <span class=n>module</span> <span class=ow>in</span> <span class=n>modules</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>        <span class=k>if</span> <span class=s2>&quot;Admin Boundaries&quot;</span> <span class=ow>in</span> <span class=n>module</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]:</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>            <span class=n>admin_module_uuid</span> <span class=o>=</span> <span class=n>module</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a>                <span class=sa>f</span><span class=s2>&quot;Found Admin Boundaries module: </span><span class=si>{</span><span class=n>module</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>admin_module_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>            <span class=p>)</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>            <span class=k>break</span>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>admin_module_uuid</span><span class=p>:</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Admin Boundaries module not found&quot;</span><span class=p>)</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Finding datasets in the Admin Boundaries module...&quot;</span><span class=p>)</span>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a>    <span class=n>datasets</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_datasets_by_module</span><span class=p>(</span><span class=n>admin_module_uuid</span><span class=p>)</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a>    <span class=n>global_dataset_uuid</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-555><a id=__codelineno-0-555 name=__codelineno-0-555></a>
</span><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a>    <span class=k>for</span> <span class=n>dataset</span> <span class=ow>in</span> <span class=n>datasets</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a>        <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>keyword</span> <span class=ow>in</span> <span class=n>dataset</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>keyword</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;global&quot;</span><span class=p>]):</span>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>            <span class=n>global_dataset_uuid</span> <span class=o>=</span> <span class=n>dataset</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>                <span class=sa>f</span><span class=s2>&quot;Found global dataset: </span><span class=si>{</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>global_dataset_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>            <span class=p>)</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>            <span class=k>break</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>global_dataset_uuid</span><span class=p>:</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a>        <span class=k>if</span> <span class=n>datasets</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>):</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>            <span class=n>global_dataset_uuid</span> <span class=o>=</span> <span class=n>datasets</span><span class=p>[</span><span class=s2>&quot;results&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a>                <span class=sa>f</span><span class=s2>&quot;Using first available dataset: </span><span class=si>{</span><span class=n>datasets</span><span class=p>[</span><span class=s1>&#39;results&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>global_dataset_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a>            <span class=p>)</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;No datasets found in the Admin Boundaries module&quot;</span><span class=p>)</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Finding views in the dataset...&quot;</span><span class=p>)</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a>    <span class=n>views</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_views_by_dataset</span><span class=p>(</span><span class=n>global_dataset_uuid</span><span class=p>)</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a>    <span class=n>latest_view_uuid</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a>    <span class=k>for</span> <span class=n>view</span> <span class=ow>in</span> <span class=n>views</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a>        <span class=k>if</span> <span class=s2>&quot;tags&quot;</span> <span class=ow>in</span> <span class=n>view</span> <span class=ow>and</span> <span class=s2>&quot;latest&quot;</span> <span class=ow>in</span> <span class=n>view</span><span class=p>[</span><span class=s2>&quot;tags&quot;</span><span class=p>]:</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a>            <span class=n>latest_view_uuid</span> <span class=o>=</span> <span class=n>view</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a>                <span class=sa>f</span><span class=s2>&quot;Found latest view: </span><span class=si>{</span><span class=n>view</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>latest_view_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>            <span class=p>)</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a>            <span class=k>break</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>latest_view_uuid</span><span class=p>:</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>        <span class=k>if</span> <span class=n>views</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>):</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>            <span class=n>latest_view_uuid</span> <span class=o>=</span> <span class=n>views</span><span class=p>[</span><span class=s2>&quot;results&quot;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>                <span class=sa>f</span><span class=s2>&quot;Using first available view: </span><span class=si>{</span><span class=n>views</span><span class=p>[</span><span class=s1>&#39;results&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>latest_view_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>            <span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;No views found in the dataset&quot;</span><span class=p>)</span>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>    <span class=c1># Search for the country by ISO3 code</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Searching for country with ISO3 code: </span><span class=si>{</span><span class=n>iso3_code</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>    <span class=n>country_entity</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>find_country_by_iso3</span><span class=p>(</span><span class=n>latest_view_uuid</span><span class=p>,</span> <span class=n>iso3_code</span><span class=p>)</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>country_entity</span><span class=p>:</span>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Country with ISO3 code &#39;</span><span class=si>{</span><span class=n>iso3_code</span><span class=si>}</span><span class=s2>&#39; not found&quot;</span><span class=p>)</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>    <span class=n>country_ucode</span> <span class=o>=</span> <span class=n>country_entity</span><span class=p>[</span><span class=s2>&quot;ucode&quot;</span><span class=p>]</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>    <span class=n>country_name</span> <span class=o>=</span> <span class=n>country_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Found country: </span><span class=si>{</span><span class=n>country_name</span><span class=si>}</span><span class=s2> (Ucode: </span><span class=si>{</span><span class=n>country_ucode</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>)</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>    <span class=c1># Search for country-specific view</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Checking for country-specific view...&quot;</span><span class=p>)</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>    <span class=n>country_view_uuid</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>    <span class=n>all_views</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>    <span class=c1># Need to fetch all pages of views</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a>    <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a>        <span class=n>views_page</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_views_by_dataset</span><span class=p>(</span><span class=n>global_dataset_uuid</span><span class=p>,</span> <span class=n>page</span><span class=o>=</span><span class=n>page</span><span class=p>)</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a>        <span class=n>all_views</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>views_page</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]))</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>        <span class=k>if</span> <span class=n>page</span> <span class=o>&gt;=</span> <span class=n>views_page</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_page&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a>            <span class=k>break</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a>        <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a>    <span class=c1># Look for a view specifically for this country</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a>    <span class=k>for</span> <span class=n>view</span> <span class=ow>in</span> <span class=n>all_views</span><span class=p>:</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>        <span class=k>if</span> <span class=n>country_name</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=n>view</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>and</span> <span class=s2>&quot;latest&quot;</span> <span class=ow>in</span> <span class=n>view</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a>            <span class=s2>&quot;tags&quot;</span><span class=p>,</span> <span class=p>[]</span>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a>        <span class=p>):</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a>            <span class=n>country_view_uuid</span> <span class=o>=</span> <span class=n>view</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>                <span class=sa>f</span><span class=s2>&quot;Found country-specific view: </span><span class=si>{</span><span class=n>view</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>country_view_uuid</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>            <span class=p>)</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>            <span class=k>break</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a>    <span class=c1># Get boundaries based on admin level</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>    <span class=k>if</span> <span class=n>country_view_uuid</span><span class=p>:</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>        <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>country_view_uuid</span><span class=p>)</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>        <span class=c1># If we found a view specific to this country, use it</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>        <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Getting admin boundaries from country-specific view...&quot;</span><span class=p>)</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching admin level </span><span class=si>{</span><span class=n>admin_level</span><span class=si>}</span><span class=s2> boundaries...&quot;</span><span class=p>)</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>            <span class=c1># Handle pagination for large datasets</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a>            <span class=n>all_features</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>            <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>                <span class=n>result</span><span class=p>,</span> <span class=n>meta</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_entities_by_admin_level</span><span class=p>(</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>                    <span class=n>country_view_uuid</span><span class=p>,</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>                    <span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>                    <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>                    <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span><span class=p>,</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>                    <span class=n>page</span><span class=o>=</span><span class=n>page</span><span class=p>,</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>                    <span class=n>page_size</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>                <span class=p>)</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>                <span class=c1># Add features to our collection</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>                <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a>                    <span class=n>all_features</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a>                <span class=k>elif</span> <span class=s2>&quot;results&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a>                    <span class=c1># Convert entities to GeoJSON features if needed</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>                    <span class=k>for</span> <span class=n>entity</span> <span class=ow>in</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;results&quot;</span><span class=p>]:</span>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a>                        <span class=k>if</span> <span class=s2>&quot;geometry&quot;</span> <span class=ow>in</span> <span class=n>entity</span><span class=p>:</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a>                            <span class=n>feature</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>                                <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;Feature&quot;</span><span class=p>,</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a>                                <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>                                    <span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>entity</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> <span class=k>if</span> <span class=n>k</span> <span class=o>!=</span> <span class=s2>&quot;geometry&quot;</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a>                                <span class=p>},</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>                                <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=n>entity</span><span class=p>[</span><span class=s2>&quot;geometry&quot;</span><span class=p>],</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a>                            <span class=p>}</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>                            <span class=n>all_features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>feature</span><span class=p>)</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a>                <span class=c1># Check if there are more pages</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>                <span class=k>if</span> <span class=n>page</span> <span class=o>&gt;=</span> <span class=n>meta</span><span class=p>[</span><span class=s2>&quot;total_page&quot;</span><span class=p>]:</span>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>                    <span class=k>break</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a>                <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>            <span class=n>boundaries</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;FeatureCollection&quot;</span><span class=p>,</span> <span class=s2>&quot;features&quot;</span><span class=p>:</span> <span class=n>all_features</span><span class=p>}</span>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a>            <span class=c1># Get all admin levels by fetching each level separately</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a>            <span class=n>boundaries</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;FeatureCollection&quot;</span><span class=p>,</span> <span class=s2>&quot;features&quot;</span><span class=p>:</span> <span class=p>[]}</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>            <span class=c1># Get dataset details to find available admin levels</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>            <span class=n>dataset_details</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_dataset_details</span><span class=p>(</span><span class=n>global_dataset_uuid</span><span class=p>)</span>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a>            <span class=n>max_level</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a>            <span class=k>for</span> <span class=n>level_info</span> <span class=ow>in</span> <span class=n>dataset_details</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;dataset_levels&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a>                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>level_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;level&quot;</span><span class=p>),</span> <span class=nb>int</span><span class=p>):</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a>                    <span class=n>max_level</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>max_level</span><span class=p>,</span> <span class=n>level_info</span><span class=p>[</span><span class=s2>&quot;level&quot;</span><span class=p>])</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a>            <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Dataset has admin levels from 0 to </span><span class=si>{</span><span class=n>max_level</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a>            <span class=c1># Fetch each admin level</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>            <span class=k>for</span> <span class=n>level</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>max_level</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a>                <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fetching admin level </span><span class=si>{</span><span class=n>level</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a>                    <span class=n>level_data</span><span class=p>,</span> <span class=n>meta</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_entities_by_admin_level</span><span class=p>(</span>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a>                        <span class=n>country_view_uuid</span><span class=p>,</span> <span class=n>level</span><span class=p>,</span> <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a>                    <span class=p>)</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a>
</span><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a>                    <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>level_data</span><span class=p>:</span>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a>                        <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>level_data</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a>                    <span class=k>elif</span> <span class=s2>&quot;results&quot;</span> <span class=ow>in</span> <span class=n>level_data</span><span class=p>:</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a>                        <span class=c1># Process each page of results</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>                        <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a>                        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a>                            <span class=n>result</span><span class=p>,</span> <span class=n>meta</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_entities_by_admin_level</span><span class=p>(</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a>                                <span class=n>country_view_uuid</span><span class=p>,</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a>                                <span class=n>level</span><span class=p>,</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a>                                <span class=n>geom</span><span class=o>=</span><span class=s2>&quot;full_geom&quot;</span><span class=p>,</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a>                                <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;geojson&quot;</span><span class=p>,</span>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a>                                <span class=n>page</span><span class=o>=</span><span class=n>page</span><span class=p>,</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a>                            <span class=p>)</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a>                            <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a>                                <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a>                            <span class=c1># Check for more pages</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a>                            <span class=k>if</span> <span class=n>page</span> <span class=o>&gt;=</span> <span class=n>meta</span><span class=p>[</span><span class=s2>&quot;total_page&quot;</span><span class=p>]:</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a>                                <span class=k>break</span>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>                            <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a>                    <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error fetching admin level </span><span class=si>{</span><span class=n>level</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a>        <span class=c1># Use the global view with filtering</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a>        <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Using global view and filtering by country...&quot;</span><span class=p>)</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a>        <span class=c1># Function to recursively get all descendants</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a>        <span class=k>def</span> <span class=nf>get_all_children</span><span class=p>(</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a>            <span class=n>parent_ucode</span><span class=p>,</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>admin_level_filter</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a>        <span class=p>):</span>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a><span class=w>            </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-730><a id=__codelineno-0-730 name=__codelineno-0-730></a><span class=sd>            Recursively retrieve all child entities of a parent entity.</span>
</span><span id=__span-0-731><a id=__codelineno-0-731 name=__codelineno-0-731></a>
</span><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a><span class=sd>            Args:</span>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a><span class=sd>                parent_ucode (str): The Ucode of the parent entity.</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a><span class=sd>                view_uuid (str): The UUID of the view to query.</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a><span class=sd>                level (int): Current recursion level (for depth limiting).</span>
</span><span id=__span-0-736><a id=__codelineno-0-736 name=__codelineno-0-736></a><span class=sd>                max_depth (int): Maximum recursion depth to prevent infinite loops.</span>
</span><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a><span class=sd>                admin_level_filter (int, optional): If specified, only return</span>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=sd>                    entities at this specific administrative level.</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a><span class=sd>            Returns:</span>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a><span class=sd>                list: List of GeoJSON features for all child entities.</span>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>            &quot;&quot;&quot;</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a>            <span class=k>if</span> <span class=n>level</span> <span class=o>&gt;</span> <span class=n>max_depth</span><span class=p>:</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a>                <span class=n>children</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_entity_children</span><span class=p>(</span><span class=n>view_uuid</span><span class=p>,</span> <span class=n>parent_ucode</span><span class=p>)</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a>                <span class=n>features</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a>                <span class=k>for</span> <span class=n>child</span> <span class=ow>in</span> <span class=n>children</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;results&quot;</span><span class=p>,</span> <span class=p>[]):</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a>                    <span class=c1># Skip if we&#39;re filtering by admin level and this doesn&#39;t match</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>                    <span class=k>if</span> <span class=p>(</span>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a>                        <span class=n>admin_level_filter</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a>                        <span class=ow>and</span> <span class=n>child</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;admin_level&quot;</span><span class=p>)</span> <span class=o>!=</span> <span class=n>admin_level_filter</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a>                    <span class=p>):</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a>                        <span class=k>continue</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a>                    <span class=c1># Get the child with full geometry</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a>                    <span class=n>child_entity</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_entity_by_ucode</span><span class=p>(</span><span class=n>child</span><span class=p>[</span><span class=s2>&quot;ucode&quot;</span><span class=p>])</span>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a>                    <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>child_entity</span><span class=p>:</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a>                        <span class=n>features</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>child_entity</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-762><a id=__codelineno-0-762 name=__codelineno-0-762></a>
</span><span id=__span-0-763><a id=__codelineno-0-763 name=__codelineno-0-763></a>                    <span class=c1># Recursively get grandchildren if not filtering by admin level</span>
</span><span id=__span-0-764><a id=__codelineno-0-764 name=__codelineno-0-764></a>                    <span class=k>if</span> <span class=n>admin_level_filter</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-765><a id=__codelineno-0-765 name=__codelineno-0-765></a>                        <span class=n>features</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span>
</span><span id=__span-0-766><a id=__codelineno-0-766 name=__codelineno-0-766></a>                            <span class=n>get_all_children</span><span class=p>(</span>
</span><span id=__span-0-767><a id=__codelineno-0-767 name=__codelineno-0-767></a>                                <span class=n>child</span><span class=p>[</span><span class=s2>&quot;ucode&quot;</span><span class=p>],</span> <span class=n>view_uuid</span><span class=p>,</span> <span class=n>level</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>max_depth</span>
</span><span id=__span-0-768><a id=__codelineno-0-768 name=__codelineno-0-768></a>                            <span class=p>)</span>
</span><span id=__span-0-769><a id=__codelineno-0-769 name=__codelineno-0-769></a>                        <span class=p>)</span>
</span><span id=__span-0-770><a id=__codelineno-0-770 name=__codelineno-0-770></a>
</span><span id=__span-0-771><a id=__codelineno-0-771 name=__codelineno-0-771></a>                <span class=k>return</span> <span class=n>features</span>
</span><span id=__span-0-772><a id=__codelineno-0-772 name=__codelineno-0-772></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-773><a id=__codelineno-0-773 name=__codelineno-0-773></a>                <span class=n>client</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error getting children for </span><span class=si>{</span><span class=n>parent_ucode</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-774><a id=__codelineno-0-774 name=__codelineno-0-774></a>                <span class=k>return</span> <span class=p>[]</span>
</span><span id=__span-0-775><a id=__codelineno-0-775 name=__codelineno-0-775></a>
</span><span id=__span-0-776><a id=__codelineno-0-776 name=__codelineno-0-776></a>        <span class=c1># Start with the country boundaries</span>
</span><span id=__span-0-777><a id=__codelineno-0-777 name=__codelineno-0-777></a>        <span class=n>boundaries</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;FeatureCollection&quot;</span><span class=p>,</span> <span class=s2>&quot;features&quot;</span><span class=p>:</span> <span class=p>[]}</span>
</span><span id=__span-0-778><a id=__codelineno-0-778 name=__codelineno-0-778></a>
</span><span id=__span-0-779><a id=__codelineno-0-779 name=__codelineno-0-779></a>        <span class=c1># If admin_level is 0, just get the country entity</span>
</span><span id=__span-0-780><a id=__codelineno-0-780 name=__codelineno-0-780></a>        <span class=k>if</span> <span class=n>admin_level</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-781><a id=__codelineno-0-781 name=__codelineno-0-781></a>            <span class=n>country_entity</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_entity_by_ucode</span><span class=p>(</span><span class=n>country_ucode</span><span class=p>)</span>
</span><span id=__span-0-782><a id=__codelineno-0-782 name=__codelineno-0-782></a>            <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>country_entity</span><span class=p>:</span>
</span><span id=__span-0-783><a id=__codelineno-0-783 name=__codelineno-0-783></a>                <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>country_entity</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-784><a id=__codelineno-0-784 name=__codelineno-0-784></a>        <span class=c1># If specific admin level requested, get all entities at that level</span>
</span><span id=__span-0-785><a id=__codelineno-0-785 name=__codelineno-0-785></a>        <span class=k>elif</span> <span class=n>admin_level</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-786><a id=__codelineno-0-786 name=__codelineno-0-786></a>            <span class=n>children_features</span> <span class=o>=</span> <span class=n>get_all_children</span><span class=p>(</span>
</span><span id=__span-0-787><a id=__codelineno-0-787 name=__codelineno-0-787></a>                <span class=n>country_ucode</span><span class=p>,</span>
</span><span id=__span-0-788><a id=__codelineno-0-788 name=__codelineno-0-788></a>                <span class=n>latest_view_uuid</span><span class=p>,</span>
</span><span id=__span-0-789><a id=__codelineno-0-789 name=__codelineno-0-789></a>                <span class=n>max_depth</span><span class=o>=</span><span class=n>admin_level</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-790><a id=__codelineno-0-790 name=__codelineno-0-790></a>                <span class=n>admin_level_filter</span><span class=o>=</span><span class=n>admin_level</span><span class=p>,</span>
</span><span id=__span-0-791><a id=__codelineno-0-791 name=__codelineno-0-791></a>            <span class=p>)</span>
</span><span id=__span-0-792><a id=__codelineno-0-792 name=__codelineno-0-792></a>            <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>children_features</span><span class=p>)</span>
</span><span id=__span-0-793><a id=__codelineno-0-793 name=__codelineno-0-793></a>        <span class=c1># If no admin_level specified, get all levels</span>
</span><span id=__span-0-794><a id=__codelineno-0-794 name=__codelineno-0-794></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-795><a id=__codelineno-0-795 name=__codelineno-0-795></a>            <span class=c1># Start with the country entity</span>
</span><span id=__span-0-796><a id=__codelineno-0-796 name=__codelineno-0-796></a>            <span class=n>country_entity</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_entity_by_ucode</span><span class=p>(</span><span class=n>country_ucode</span><span class=p>)</span>
</span><span id=__span-0-797><a id=__codelineno-0-797 name=__codelineno-0-797></a>            <span class=k>if</span> <span class=s2>&quot;features&quot;</span> <span class=ow>in</span> <span class=n>country_entity</span><span class=p>:</span>
</span><span id=__span-0-798><a id=__codelineno-0-798 name=__codelineno-0-798></a>                <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>country_entity</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>])</span>
</span><span id=__span-0-799><a id=__codelineno-0-799 name=__codelineno-0-799></a>
</span><span id=__span-0-800><a id=__codelineno-0-800 name=__codelineno-0-800></a>            <span class=c1># Get all descendants</span>
</span><span id=__span-0-801><a id=__codelineno-0-801 name=__codelineno-0-801></a>            <span class=n>children_features</span> <span class=o>=</span> <span class=n>get_all_children</span><span class=p>(</span>
</span><span id=__span-0-802><a id=__codelineno-0-802 name=__codelineno-0-802></a>                <span class=n>country_ucode</span><span class=p>,</span> <span class=n>latest_view_uuid</span><span class=p>,</span> <span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span>
</span><span id=__span-0-803><a id=__codelineno-0-803 name=__codelineno-0-803></a>            <span class=p>)</span>
</span><span id=__span-0-804><a id=__codelineno-0-804 name=__codelineno-0-804></a>            <span class=n>boundaries</span><span class=p>[</span><span class=s2>&quot;features&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>children_features</span><span class=p>)</span>
</span><span id=__span-0-805><a id=__codelineno-0-805 name=__codelineno-0-805></a>
</span><span id=__span-0-806><a id=__codelineno-0-806 name=__codelineno-0-806></a>    <span class=k>return</span> <span class=n>boundaries</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.handlers.worldpop class="doc doc-heading"> <code>worldpop</code> <a href=#gigaspatial.handlers.worldpop class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.worldpop.WorldPopConfig class="doc doc-heading"> <code>WorldPopConfig</code> <a href=#gigaspatial.handlers.worldpop.WorldPopConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=k>class</span> <span class=nc>WorldPopConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=c1># class variables</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>_metadata_cache</span><span class=p>:</span> <span class=n>ClassVar</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=c1># constants</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>CURRENT_MAX_YEAR</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2022</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=n>EARLIEST_YEAR</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2000</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2020</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=c1># base config</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>WORLDPOP_DB_BASE_URL</span><span class=p>:</span> <span class=n>HttpUrl</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>&quot;https://data.worldpop.org/&quot;</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=n>SCHOOL_AGE_POPULATION_PATH</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;GIS/AgeSex_structures/school_age_population/v1/2020/&quot;</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=p>)</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>PPP_2021_2022_PATH</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;GIS/Population/Global_2021_2022_1km_UNadj/&quot;</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>DATASETS_METADATA_PATH</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=s2>&quot;assets/wpgpDatasets.csv&quot;</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=c1># user config</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;worldpop&quot;</span><span class=p>,</span> <span class=s2>&quot;bronze&quot;</span><span class=p>))</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>country</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>year</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>ge</span><span class=o>=</span><span class=n>EARLIEST_YEAR</span><span class=p>,</span> <span class=n>le</span><span class=o>=</span><span class=n>CURRENT_MAX_YEAR</span><span class=p>)</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=n>resolution</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;HIGH&quot;</span><span class=p>,</span> <span class=s2>&quot;LOW&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=n>default</span><span class=o>=</span><span class=s2>&quot;LOW&quot;</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Spatial resolution of the population grid: HIGH (100m) or LOW (1km)&quot;</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>    <span class=p>)</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=n>un_adjusted</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=n>constrained</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=n>school_age</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;PRIMARY&quot;</span><span class=p>,</span> <span class=s2>&quot;SECONDARY&quot;</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=n>gender</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;F&quot;</span><span class=p>,</span> <span class=s2>&quot;M&quot;</span><span class=p>,</span> <span class=s2>&quot;F_M&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;F_M&quot;</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=nd>@field_validator</span><span class=p>(</span><span class=s2>&quot;country&quot;</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>    <span class=k>def</span> <span class=nf>validate_country</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=k>return</span> <span class=n>pycountry</span><span class=o>.</span><span class=n>countries</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>.</span><span class=n>alpha_3</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=k>except</span> <span class=ne>LookupError</span><span class=p>:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid country code provided: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;after&quot;</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=k>def</span> <span class=nf>validate_configuration</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        Validate that the configuration is valid based on dataset availability constraints.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        Specific rules:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>        - Post-2020 data is only available at 1km resolution with UN adjustment</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>        - School age population data is only available for 2020 at 1km resolution</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=s2>&quot;LOW&quot;</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>                    <span class=sa>f</span><span class=s2>&quot;Data for year </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2> is only available at LOW (1km) resolution&quot;</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>                <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span><span class=p>:</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>                    <span class=sa>f</span><span class=s2>&quot;Data for year </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2> is only available with UN adjustment&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>                <span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=p>:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=s2>&quot;LOW&quot;</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>                    <span class=sa>f</span><span class=s2>&quot;School age data is only available at LOW (1km) resolution&quot;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>                <span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;School age data is only available for 2020&quot;</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=k>return</span> <span class=bp>self</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=nd>@property</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>def</span> <span class=nf>dataset_url</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the URL for the configured dataset. The URL is computed on first access and then cached for subsequent calls.&quot;&quot;&quot;</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;_dataset_url&quot;</span><span class=p>):</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_dataset_url</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_compute_dataset_url</span><span class=p>()</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_dataset_url</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=nd>@property</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>    <span class=k>def</span> <span class=nf>dataset_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Construct and return the path for the configured dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=n>url_parts</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>dataset_url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=n>file_path</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=s2>&quot;/&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=p>[</span><span class=n>url_parts</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>url_parts</span><span class=p>[</span><span class=mi>5</span><span class=p>],</span> <span class=n>url_parts</span><span class=p>[</span><span class=mi>7</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>,</span> <span class=n>url_parts</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]]</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>school_age</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>            <span class=k>else</span> <span class=s2>&quot;/&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>url_parts</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>url_parts</span><span class=p>[</span><span class=mi>6</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>,</span> <span class=n>url_parts</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]])</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=p>)</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=n>file_path</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=k>def</span> <span class=nf>_load_datasets_metadata</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Load and return the WorldPop datasets metadata, using cache if available.&quot;&quot;&quot;</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=k>if</span> <span class=n>WorldPopConfig</span><span class=o>.</span><span class=n>_metadata_cache</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=k>return</span> <span class=n>WorldPopConfig</span><span class=o>.</span><span class=n>_metadata_cache</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>WorldPopConfig</span><span class=o>.</span><span class=n>_metadata_cache</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>                <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>WORLDPOP_DB_BASE_URL</span><span class=p>)</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>DATASETS_METADATA_PATH</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=k>return</span> <span class=n>WorldPopConfig</span><span class=o>.</span><span class=n>_metadata_cache</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=k>except</span> <span class=p>(</span><span class=n>URLError</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>errors</span><span class=o>.</span><span class=n>EmptyDataError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to load WorldPop datasets metadata: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=k>def</span> <span class=nf>_compute_dataset_url</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Construct and return the URL for the configured dataset.&quot;&quot;&quot;</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>        <span class=c1># handle post-2020 datasets</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>            <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>WORLDPOP_DB_BASE_URL</span><span class=p>)</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>PPP_2021_2022_PATH</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>                <span class=o>+</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=bp>self</span><span class=o>.</span><span class=n>constrained</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;un&#39;</span><span class=si>}</span><span class=s2>constrained/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=si>}</span><span class=s2>_ppp_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>_1km_UNadj</span><span class=si>{</span><span class=s1>&#39;_constrained&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=bp>self</span><span class=o>.</span><span class=n>constrained</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=si>}</span><span class=s2>.tif&quot;</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=c1># handle school-age population datasets</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=p>:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>WORLDPOP_DB_BASE_URL</span><span class=p>)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_POPULATION_PATH</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=o>+</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>_SAP_1km_2020/</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>gender</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=si>}</span><span class=s2>_2020_1km.tif&quot;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=c1># handle standard population datasets</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=n>wp_metadata</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_datasets_metadata</span><span class=p>()</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=n>dataset_url</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                <span class=bp>self</span><span class=o>.</span><span class=n>WORLDPOP_DB_BASE_URL</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                <span class=o>+</span> <span class=n>wp_metadata</span><span class=p>[</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                    <span class=p>(</span><span class=n>wp_metadata</span><span class=o>.</span><span class=n>ISO3</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                    <span class=o>&amp;</span> <span class=p>(</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                        <span class=n>wp_metadata</span><span class=o>.</span><span class=n>Covariate</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                        <span class=o>==</span> <span class=s2>&quot;ppp_&quot;</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                        <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                        <span class=o>+</span> <span class=p>(</span><span class=s2>&quot;_UNadj&quot;</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>                    <span class=p>)</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                <span class=p>]</span><span class=o>.</span><span class=n>PathToRaster</span><span class=o>.</span><span class=n>values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>            <span class=p>)</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                <span class=sa>f</span><span class=s2>&quot;No dataset found for country=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>, year=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>, un_adjusted=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>            <span class=p>)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>        <span class=c1># handle resolution conversion if needed</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>==</span> <span class=s2>&quot;HIGH&quot;</span><span class=p>:</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>            <span class=k>return</span> <span class=n>dataset_url</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>        <span class=n>url_parts</span> <span class=o>=</span> <span class=n>dataset_url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>        <span class=n>url_parts</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>            <span class=n>url_parts</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;_1km&quot;</span> <span class=o>+</span> <span class=p>(</span><span class=s2>&quot;_UNadj&quot;</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=p>)</span>  <span class=c1># get 1km folder with UNadj specification</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=n>url_parts</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>=</span> <span class=n>url_parts</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>            <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=p>),</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&quot;_1km_Aggregated&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>        <span class=p>)</span>  <span class=c1># get filename with 1km res</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=n>dataset_url</span> <span class=o>=</span> <span class=s2>&quot;/&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>url_parts</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=k>return</span> <span class=n>dataset_url</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>parts</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=sa>f</span><span class=s2>&quot;WorldpopConfig(&quot;</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=sa>f</span><span class=s2>&quot;  country=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=sa>f</span><span class=s2>&quot;  year=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=sa>f</span><span class=s2>&quot;  resolution=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>resolution</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>            <span class=sa>f</span><span class=s2>&quot;  un_adjusted=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>            <span class=sa>f</span><span class=s2>&quot;  constrained=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>constrained</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=p>]</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=p>:</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=n>parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  school_age=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=n>parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  gender=&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>gender</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=n>parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;)&quot;</span><span class=p>)</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=k>return</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.worldpop.WorldPopConfig.dataset_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>dataset_path</span><span class=p>:</span> <span class=n>Path</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.worldpop.WorldPopConfig.dataset_path class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Construct and return the path for the configured dataset.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.handlers.worldpop.WorldPopConfig.dataset_url class="doc doc-heading"> <code class="highlight language-python"><span class=n>dataset_url</span><span class=p>:</span> <span class=nb>str</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.handlers.worldpop.WorldPopConfig.dataset_url class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Get the URL for the configured dataset. The URL is computed on first access and then cached for subsequent calls.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.worldpop.WorldPopConfig.validate_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_configuration</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.worldpop.WorldPopConfig.validate_configuration class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Validate that the configuration is valid based on dataset availability constraints.</p> <p>Specific rules: - Post-2020 data is only available at 1km resolution with UN adjustment - School age population data is only available for 2020 at 1km resolution</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=nd>@model_validator</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;after&quot;</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=k>def</span> <span class=nf>validate_configuration</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>    Validate that the configuration is valid based on dataset availability constraints.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>    Specific rules:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>    - Post-2020 data is only available at 1km resolution with UN adjustment</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>    - School age population data is only available for 2020 at 1km resolution</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=s2>&quot;LOW&quot;</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>                <span class=sa>f</span><span class=s2>&quot;Data for year </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2> is only available at LOW (1km) resolution&quot;</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>            <span class=p>)</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>un_adjusted</span><span class=p>:</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>                <span class=sa>f</span><span class=s2>&quot;Data for year </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2> is only available with UN adjustment&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>school_age</span><span class=p>:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>resolution</span> <span class=o>!=</span> <span class=s2>&quot;LOW&quot;</span><span class=p>:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>                <span class=sa>f</span><span class=s2>&quot;School age data is only available at LOW (1km) resolution&quot;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span><span class=p>:</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=bp>self</span><span class=o>.</span><span class=n>year</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>SCHOOL_AGE_YEAR</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;School age data is only available for 2020&quot;</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>    <span class=k>return</span> <span class=bp>self</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.handlers.worldpop.WorldPopDownloader class="doc doc-heading"> <code>WorldPopDownloader</code> <a href=#gigaspatial.handlers.worldpop.WorldPopDownloader class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>A class to handle downloads of WorldPop datasets.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=k>class</span> <span class=nc>WorldPopDownloader</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;A class to handle downloads of WorldPop datasets.&quot;&quot;&quot;</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>WorldPopConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>    <span class=p>):</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>        Initialize the downloader.</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>        Args:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>            config: Configuration for the WorldPop dataset, either as a WorldPopConfig object or a dictionary of parameters</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>            data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>            logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>            <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>WorldPopConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>WorldPopConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>    <span class=nd>@classmethod</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>    <span class=k>def</span> <span class=nf>from_country_year</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>year</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>        Create a downloader instance from country and year.</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>        Args:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>            country: Country code or name</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>            year: Year of the dataset</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>            **kwargs: Additional parameters for WorldPopConfig or the downloader</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=k>return</span> <span class=bp>cls</span><span class=p>({</span><span class=s2>&quot;country&quot;</span><span class=p>:</span> <span class=n>country</span><span class=p>,</span> <span class=s2>&quot;year&quot;</span><span class=p>:</span> <span class=n>year</span><span class=p>},</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>        Download the configured dataset to the provided output path.</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=n>output_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>            <span class=n>total_size</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content-length&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>                <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>                    <span class=n>total</span><span class=o>=</span><span class=n>total_size</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>                    <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;B&quot;</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>                    <span class=n>unit_scale</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                    <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>output_path</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>                <span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>                    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>                        <span class=k>if</span> <span class=n>chunk</span><span class=p>:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>                            <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>                            <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>))</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully downloaded dataset: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=k>return</span> <span class=n>output_path</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to download dataset </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>            <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.worldpop.WorldPopDownloader.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.WorldPopDownloader.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initialize the downloader.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="gigaspatial.handlers.worldpop.WorldPopConfig" href="#gigaspatial.handlers.worldpop.WorldPopConfig">WorldPopConfig</a>, dict[str, <span title="typing.Union">Union</span>[str, int]]]</code> </td> <td> <div class=doc-md-description> <p>Configuration for the WorldPop dataset, either as a WorldPopConfig object or a dictionary of parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional data storage interface. If not provided, uses LocalDataStore.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>logger</code></td> <td> <code><span title="typing.Optional">Optional</span>[<span title="logging.Logger">Logger</span>]</code> </td> <td> <div class=doc-md-description> <p>Optional custom logger. If not provided, uses default logger.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>WorldPopConfig</span><span class=p>,</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]],</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>logging</span><span class=o>.</span><span class=n>Logger</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=p>):</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>    Initialize the downloader.</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>    Args:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        config: Configuration for the WorldPop dataset, either as a WorldPopConfig object or a dictionary of parameters</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>        data_store: Optional data storage interface. If not provided, uses LocalDataStore.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        logger: Optional custom logger. If not provided, uses default logger.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=n>config</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config</span><span class=p>,</span> <span class=n>WorldPopConfig</span><span class=p>)</span> <span class=k>else</span> <span class=n>WorldPopConfig</span><span class=p>(</span><span class=o>**</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.worldpop.WorldPopDownloader.download_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>download_dataset</span><span class=p>()</span></code> <a href=#gigaspatial.handlers.worldpop.WorldPopDownloader.download_dataset class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Download the configured dataset to the provided output path.</p> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=k>def</span> <span class=nf>download_dataset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>    Download the configured dataset to the provided output path.</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_url</span><span class=p>,</span> <span class=n>stream</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>        <span class=n>output_path</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>        <span class=n>total_size</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content-length&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=k>with</span> <span class=n>tqdm</span><span class=p>(</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>                <span class=n>total</span><span class=o>=</span><span class=n>total_size</span><span class=p>,</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>                <span class=n>unit</span><span class=o>=</span><span class=s2>&quot;B&quot;</span><span class=p>,</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>                <span class=n>unit_scale</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                <span class=n>desc</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Downloading </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>output_path</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=p>)</span> <span class=k>as</span> <span class=n>pbar</span><span class=p>:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>iter_content</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>8192</span><span class=p>):</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>                    <span class=k>if</span> <span class=n>chunk</span><span class=p>:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>                        <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>                        <span class=n>pbar</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>chunk</span><span class=p>))</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Successfully downloaded dataset: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=k>return</span> <span class=n>output_path</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to download dataset </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error downloading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.handlers.worldpop.WorldPopDownloader.from_country_year class="doc doc-heading"> <code class="highlight language-python"><span class=n>from_country_year</span><span class=p>(</span><span class=n>country</span><span class=p>,</span> <span class=n>year</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#gigaspatial.handlers.worldpop.WorldPopDownloader.from_country_year class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Create a downloader instance from country and year.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>country</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Country code or name</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>year</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>Year of the dataset</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional parameters for WorldPopConfig or the downloader</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/handlers/worldpop.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=nd>@classmethod</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=k>def</span> <span class=nf>from_country_year</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>country</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>year</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>    Create a downloader instance from country and year.</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>    Args:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>        country: Country code or name</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>        year: Year of the dataset</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>        **kwargs: Additional parameters for WorldPopConfig or the downloader</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=k>return</span> <span class=bp>cls</span><span class=p>({</span><span class=s2>&quot;country&quot;</span><span class=p>:</span> <span class=n>country</span><span class=p>,</span> <span class=s2>&quot;year&quot;</span><span class=p>:</span> <span class=n>year</span><span class=p>},</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.read_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.read_dataset class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Read data from various file formats stored in both local and cloud-based storage.</p> <h6 id=gigaspatial.handlers.worldpop.read_dataset--parameters>Parameters:<a class=headerlink href=#gigaspatial.handlers.worldpop.read_dataset--parameters title="Permanent link">&para;</a></h6> <p>data_store : DataStore Instance of DataStore for accessing data storage. path : str, Path Path to the file in data storage. **kwargs : dict Additional arguments passed to the specific reader function.</p> <h6 id=gigaspatial.handlers.worldpop.read_dataset--returns>Returns:<a class=headerlink href=#gigaspatial.handlers.worldpop.read_dataset--returns title="Permanent link">&para;</a></h6> <p>pandas.DataFrame or geopandas.GeoDataFrame The data read from the file.</p> <h6 id=gigaspatial.handlers.worldpop.read_dataset--raises>Raises:<a class=headerlink href=#gigaspatial.handlers.worldpop.read_dataset--raises title="Permanent link">&para;</a></h6> <p>FileNotFoundError If the file doesn't exist in blob storage. ValueError If the file type is unsupported or if there's an error reading the file.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/readers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=k>def</span> <span class=nf>read_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>compression</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>    Read data from various file formats stored in both local and cloud-based storage.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>    Parameters:</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>    ----------</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    data_store : DataStore</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        Instance of DataStore for accessing data storage.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>    path : str, Path</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        Path to the file in data storage.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    **kwargs : dict</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        Additional arguments passed to the specific reader function.</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>    Returns:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    -------</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>    pandas.DataFrame or geopandas.GeoDataFrame</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>        The data read from the file.</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>    Raises:</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>    ------</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>    FileNotFoundError</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        If the file doesn&#39;t exist in blob storage.</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>    ValueError</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        If the file type is unsupported or if there&#39;s an error reading the file.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=c1># Define supported file formats and their readers</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=n>BINARY_FORMATS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=s2>&quot;.shp&quot;</span><span class=p>,</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=s2>&quot;.zip&quot;</span><span class=p>,</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=s2>&quot;.parquet&quot;</span><span class=p>,</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=s2>&quot;.gpkg&quot;</span><span class=p>,</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=s2>&quot;.xlsx&quot;</span><span class=p>,</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=s2>&quot;.xls&quot;</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=s2>&quot;.kmz&quot;</span><span class=p>,</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=s2>&quot;.gz&quot;</span><span class=p>,</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=p>}</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>    <span class=n>PANDAS_READERS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=s2>&quot;.csv&quot;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>        <span class=s2>&quot;.xlsx&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;openpyxl&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=s2>&quot;.xls&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_excel</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;xlrd&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=s2>&quot;.json&quot;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_json</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=c1># &quot;.gz&quot;: lambda f, **kw: pd.read_csv(f, compression=&quot;gzip&quot;, **kw),</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>    <span class=p>}</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=n>GEO_READERS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=s2>&quot;.shp&quot;</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>,</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=s2>&quot;.zip&quot;</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=s2>&quot;.geojson&quot;</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>,</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=s2>&quot;.gpkg&quot;</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>,</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=s2>&quot;.parquet&quot;</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=s2>&quot;.kmz&quot;</span><span class=p>:</span> <span class=n>read_kmz</span><span class=p>,</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=p>}</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=n>COMPRESSION_FORMATS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=s2>&quot;.gz&quot;</span><span class=p>:</span> <span class=s2>&quot;gzip&quot;</span><span class=p>,</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=s2>&quot;.bz2&quot;</span><span class=p>:</span> <span class=s2>&quot;bz2&quot;</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=s2>&quot;.zip&quot;</span><span class=p>:</span> <span class=s2>&quot;zip&quot;</span><span class=p>,</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>        <span class=s2>&quot;.xz&quot;</span><span class=p>:</span> <span class=s2>&quot;xz&quot;</span><span class=p>,</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=p>}</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=c1># Check if file exists</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>data_store</span><span class=o>.</span><span class=n>file_exists</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;File &#39;</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#39; not found in blob storage&quot;</span><span class=p>)</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>        <span class=n>path_obj</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=n>suffixes</span> <span class=o>=</span> <span class=n>path_obj</span><span class=o>.</span><span class=n>suffixes</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=n>file_extension</span> <span class=o>=</span> <span class=n>suffixes</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>if</span> <span class=n>suffixes</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=k>if</span> <span class=n>compression</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>file_extension</span> <span class=ow>in</span> <span class=n>COMPRESSION_FORMATS</span><span class=p>:</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=n>compression_format</span> <span class=o>=</span> <span class=n>COMPRESSION_FORMATS</span><span class=p>[</span><span class=n>file_extension</span><span class=p>]</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=c1># if file has multiple extensions (e.g., .csv.gz), get the inner format</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>suffixes</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                <span class=n>inner_extension</span> <span class=o>=</span> <span class=n>suffixes</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=k>if</span> <span class=n>inner_extension</span> <span class=o>==</span> <span class=s2>&quot;.tar&quot;</span><span class=p>:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                        <span class=s2>&quot;Tar archives (.tar.gz) are not directly supported&quot;</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                    <span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                <span class=k>if</span> <span class=n>inner_extension</span> <span class=ow>in</span> <span class=n>PANDAS_READERS</span><span class=p>:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                        <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                            <span class=k>return</span> <span class=n>PANDAS_READERS</span><span class=p>[</span><span class=n>inner_extension</span><span class=p>](</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                                <span class=n>f</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=n>compression_format</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                            <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>                    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error reading compressed file: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                <span class=k>elif</span> <span class=n>inner_extension</span> <span class=ow>in</span> <span class=n>GEO_READERS</span><span class=p>:</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                        <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                            <span class=k>if</span> <span class=n>compression_format</span> <span class=o>==</span> <span class=s2>&quot;gzip&quot;</span><span class=p>:</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                                <span class=kn>import</span> <span class=nn>gzip</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                                <span class=n>decompressed_data</span> <span class=o>=</span> <span class=n>gzip</span><span class=o>.</span><span class=n>decompress</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                                <span class=kn>import</span> <span class=nn>io</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                                <span class=k>return</span> <span class=n>GEO_READERS</span><span class=p>[</span><span class=n>inner_extension</span><span class=p>](</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                                    <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>decompressed_data</span><span class=p>),</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                                <span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                                    <span class=sa>f</span><span class=s2>&quot;Compression format </span><span class=si>{</span><span class=n>compression_format</span><span class=si>}</span><span class=s2> not supported for geo data&quot;</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                                <span class=p>)</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error reading compressed geo file: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                <span class=c1># if just .gz without clear inner type, assume csv</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                    <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=n>compression_format</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                        <span class=sa>f</span><span class=s2>&quot;Error reading compressed file as CSV: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. &quot;</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                        <span class=sa>f</span><span class=s2>&quot;If not a CSV, specify the format in the filename (e.g., .json.gz)&quot;</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                    <span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=c1># Special handling for compressed files</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>if</span> <span class=n>file_extension</span> <span class=o>==</span> <span class=s2>&quot;.zip&quot;</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=c1># For zip files, we need to use binary mode</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>                <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=c1># Determine if we need binary mode based on file type</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=n>mode</span> <span class=o>=</span> <span class=s2>&quot;rb&quot;</span> <span class=k>if</span> <span class=n>file_extension</span> <span class=ow>in</span> <span class=n>BINARY_FORMATS</span> <span class=k>else</span> <span class=s2>&quot;r&quot;</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=c1># Try reading with appropriate reader</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=k>if</span> <span class=n>file_extension</span> <span class=ow>in</span> <span class=n>PANDAS_READERS</span><span class=p>:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>                <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>mode</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>                    <span class=k>return</span> <span class=n>PANDAS_READERS</span><span class=p>[</span><span class=n>file_extension</span><span class=p>](</span><span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error reading file with pandas: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=k>if</span> <span class=n>file_extension</span> <span class=ow>in</span> <span class=n>GEO_READERS</span><span class=p>:</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>                <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>                    <span class=k>return</span> <span class=n>GEO_READERS</span><span class=p>[</span><span class=n>file_extension</span><span class=p>](</span><span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>                <span class=c1># For parquet files, try pandas reader if geopandas fails</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                <span class=k>if</span> <span class=n>file_extension</span> <span class=o>==</span> <span class=s2>&quot;.parquet&quot;</span><span class=p>:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>                        <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>                            <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>                    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e2</span><span class=p>:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>                        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>                            <span class=sa>f</span><span class=s2>&quot;Failed to read parquet with both geopandas (</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>) &quot;</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>                            <span class=sa>f</span><span class=s2>&quot;and pandas (</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e2</span><span class=p>)</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>                        <span class=p>)</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error reading file with geopandas: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=c1># If we get here, the file type is unsupported</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=n>supported_formats</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>PANDAS_READERS</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span> <span class=o>|</span> <span class=nb>set</span><span class=p>(</span><span class=n>GEO_READERS</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=n>supported_compressions</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>COMPRESSION_FORMATS</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>            <span class=sa>f</span><span class=s2>&quot;Unsupported file type: </span><span class=si>{</span><span class=n>file_extension</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=sa>f</span><span class=s2>&quot;Supported formats: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>supported_formats</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>            <span class=sa>f</span><span class=s2>&quot;Supported compressions: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>supported_compressions</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=p>(</span><span class=ne>FileNotFoundError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>)):</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=k>raise</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error reading dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.read_datasets class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_datasets</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.read_datasets class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Read multiple datasets from data storage at once.</p> <h6 id=gigaspatial.handlers.worldpop.read_datasets--parameters>Parameters:<a class=headerlink href=#gigaspatial.handlers.worldpop.read_datasets--parameters title="Permanent link">&para;</a></h6> <p>data_store : DataStore Instance of DataStore for accessing data storage. paths : list of str Paths to files in data storage. **kwargs : dict Additional arguments passed to read_dataset.</p> <h6 id=gigaspatial.handlers.worldpop.read_datasets--returns>Returns:<a class=headerlink href=#gigaspatial.handlers.worldpop.read_datasets--returns title="Permanent link">&para;</a></h6> <p>dict Dictionary mapping paths to their corresponding DataFrames/GeoDataFrames.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/readers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=k>def</span> <span class=nf>read_datasets</span><span class=p>(</span><span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>paths</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>    Read multiple datasets from data storage at once.</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=sd>    Parameters:</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>    ----------</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>    data_store : DataStore</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        Instance of DataStore for accessing data storage.</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>    paths : list of str</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>        Paths to files in data storage.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>    **kwargs : dict</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        Additional arguments passed to read_dataset.</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>    Returns:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>    -------</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>    dict</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>        Dictionary mapping paths to their corresponding DataFrames/GeoDataFrames.</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>    <span class=n>errors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>paths</span><span class=p>:</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=n>results</span><span class=p>[</span><span class=n>path</span><span class=p>]</span> <span class=o>=</span> <span class=n>read_dataset</span><span class=p>(</span><span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=n>errors</span><span class=p>[</span><span class=n>path</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=k>if</span> <span class=n>errors</span><span class=p>:</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;- </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>error</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>path</span><span class=p>,</span> <span class=n>error</span> <span class=ow>in</span> <span class=n>errors</span><span class=o>.</span><span class=n>items</span><span class=p>())</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Errors reading datasets:</span><span class=se>\n</span><span class=si>{</span><span class=n>error_msg</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=k>return</span> <span class=n>results</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.read_gzipped_json_or_csv class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_gzipped_json_or_csv</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>data_store</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.read_gzipped_json_or_csv class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Reads a gzipped file, attempting to parse it as JSON (lines=True) or CSV.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/readers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=k>def</span> <span class=nf>read_gzipped_json_or_csv</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>data_store</span><span class=p>):</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Reads a gzipped file, attempting to parse it as JSON (lines=True) or CSV.&quot;&quot;&quot;</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=n>g</span> <span class=o>=</span> <span class=n>gzip</span><span class=o>.</span><span class=n>GzipFile</span><span class=p>(</span><span class=n>fileobj</span><span class=o>=</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=n>text</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&quot;utf-8&quot;</span><span class=p>)</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_json</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>(</span><span class=n>text</span><span class=p>),</span> <span class=n>lines</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>            <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>                <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>(</span><span class=n>text</span><span class=p>))</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>                <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=k>except</span> <span class=n>pd</span><span class=o>.</span><span class=n>errors</span><span class=o>.</span><span class=n>ParserError</span><span class=p>:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error: Could not parse </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2> as JSON or CSV.&quot;</span><span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>                <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.read_kmz class="doc doc-heading"> <code class="highlight language-python"><span class=n>read_kmz</span><span class=p>(</span><span class=n>file_obj</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.read_kmz class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Helper function to read KMZ files and return a GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/readers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=k>def</span> <span class=nf>read_kmz</span><span class=p>(</span><span class=n>file_obj</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Helper function to read KMZ files and return a GeoDataFrame.&quot;&quot;&quot;</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>        <span class=k>with</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=n>file_obj</span><span class=p>)</span> <span class=k>as</span> <span class=n>kmz</span><span class=p>:</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>            <span class=c1># Find the KML file in the archive (usually doc.kml)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>            <span class=n>kml_filename</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>                <span class=n>name</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>kmz</span><span class=o>.</span><span class=n>namelist</span><span class=p>()</span> <span class=k>if</span> <span class=n>name</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;.kml&quot;</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>            <span class=p>)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>            <span class=c1># Read the KML content</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>            <span class=n>kml_content</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=n>kmz</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>kml_filename</span><span class=p>))</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>            <span class=n>gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>kml_content</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>            <span class=c1># Validate the GeoDataFrame</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>            <span class=k>if</span> <span class=n>gdf</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>                    <span class=s2>&quot;The KML file is empty or does not contain valid geospatial data.&quot;</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>                <span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=k>return</span> <span class=n>gdf</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=k>except</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>BadZipFile</span><span class=p>:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;The provided file is not a valid KMZ file.&quot;</span><span class=p>)</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>except</span> <span class=ne>StopIteration</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;No KML file found in the KMZ archive.&quot;</span><span class=p>)</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;An error occurred: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.write_dataset class="doc doc-heading"> <code class="highlight language-python"><span class=n>write_dataset</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.write_dataset class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Write DataFrame or GeoDataFrame to various file formats in Azure Blob Storage.</p> <h6 id=gigaspatial.handlers.worldpop.write_dataset--parameters>Parameters:<a class=headerlink href=#gigaspatial.handlers.worldpop.write_dataset--parameters title="Permanent link">&para;</a></h6> <p>data : pandas.DataFrame or geopandas.GeoDataFrame The data to write to blob storage. data_store : DataStore Instance of DataStore for accessing data storage. path : str Path where the file will be written in data storage. **kwargs : dict Additional arguments passed to the specific writer function.</p> <h6 id=gigaspatial.handlers.worldpop.write_dataset--raises>Raises:<a class=headerlink href=#gigaspatial.handlers.worldpop.write_dataset--raises title="Permanent link">&para;</a></h6> <p>ValueError If the file type is unsupported or if there's an error writing the file. TypeError If input data is not a DataFrame or GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/writers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span>
<span class=normal><a href=#__codelineno-0-96>96</a></span>
<span class=normal><a href=#__codelineno-0-97>97</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=k>def</span> <span class=nf>write_dataset</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    Write DataFrame or GeoDataFrame to various file formats in Azure Blob Storage.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    Parameters:</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    ----------</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    data : pandas.DataFrame or geopandas.GeoDataFrame</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>        The data to write to blob storage.</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    data_store : DataStore</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>        Instance of DataStore for accessing data storage.</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    path : str</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>        Path where the file will be written in data storage.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    **kwargs : dict</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>        Additional arguments passed to the specific writer function.</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    Raises:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    ------</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    ValueError</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        If the file type is unsupported or if there&#39;s an error writing the file.</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    TypeError</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>        If input data is not a DataFrame or GeoDataFrame.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=c1># Define supported file formats and their writers</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>BINARY_FORMATS</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;.shp&quot;</span><span class=p>,</span> <span class=s2>&quot;.zip&quot;</span><span class=p>,</span> <span class=s2>&quot;.parquet&quot;</span><span class=p>,</span> <span class=s2>&quot;.gpkg&quot;</span><span class=p>,</span> <span class=s2>&quot;.xlsx&quot;</span><span class=p>,</span> <span class=s2>&quot;.xls&quot;</span><span class=p>}</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=n>PANDAS_WRITERS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=s2>&quot;.csv&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>df</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=s2>&quot;.xlsx&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>df</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>to_excel</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;openpyxl&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=s2>&quot;.json&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>df</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>to_json</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=s2>&quot;.parquet&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>df</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=p>}</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=n>GEO_WRITERS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=s2>&quot;.geojson&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>gdf</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_file</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>driver</span><span class=o>=</span><span class=s2>&quot;GeoJSON&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=s2>&quot;.gpkg&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>gdf</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_file</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=n>driver</span><span class=o>=</span><span class=s2>&quot;GPKG&quot;</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=s2>&quot;.parquet&quot;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>gdf</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>:</span> <span class=n>gdf</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=o>**</span><span class=n>kw</span><span class=p>),</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>    <span class=p>}</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=c1># Input validation</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>)):</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;Input data must be a pandas DataFrame or GeoDataFrame&quot;</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=c1># Get file suffix and ensure it&#39;s lowercase</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=n>suffix</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=o>.</span><span class=n>suffix</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=c1># Determine if we need binary mode based on file type</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>mode</span> <span class=o>=</span> <span class=s2>&quot;wb&quot;</span> <span class=k>if</span> <span class=n>suffix</span> <span class=ow>in</span> <span class=n>BINARY_FORMATS</span> <span class=k>else</span> <span class=s2>&quot;w&quot;</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=c1># Handle different data types and formats</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>            <span class=k>if</span> <span class=n>suffix</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>GEO_WRITERS</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>                <span class=n>supported_formats</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>GEO_WRITERS</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>                    <span class=sa>f</span><span class=s2>&quot;Unsupported file type for GeoDataFrame: </span><span class=si>{</span><span class=n>suffix</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>                    <span class=sa>f</span><span class=s2>&quot;Supported formats: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>supported_formats</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>                <span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>                <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>                    <span class=n>GEO_WRITERS</span><span class=p>[</span><span class=n>suffix</span><span class=p>](</span><span class=n>data</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error writing GeoDataFrame: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>        <span class=k>else</span><span class=p>:</span>  <span class=c1># pandas DataFrame</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=k>if</span> <span class=n>suffix</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>PANDAS_WRITERS</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>                <span class=n>supported_formats</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>PANDAS_WRITERS</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>                    <span class=sa>f</span><span class=s2>&quot;Unsupported file type for DataFrame: </span><span class=si>{</span><span class=n>suffix</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                    <span class=sa>f</span><span class=s2>&quot;Supported formats: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>supported_formats</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>                <span class=k>with</span> <span class=n>data_store</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>mode</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>                    <span class=n>PANDAS_WRITERS</span><span class=p>[</span><span class=n>suffix</span><span class=p>](</span><span class=n>data</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error writing DataFrame: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=p>(</span><span class=ne>TypeError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>)):</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=k>raise</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unexpected error writing dataset: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h4 id=gigaspatial.handlers.worldpop.write_datasets class="doc doc-heading"> <code class="highlight language-python"><span class=n>write_datasets</span><span class=p>(</span><span class=n>data_dict</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.handlers.worldpop.write_datasets class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Write multiple datasets to data storage at once.</p> <h6 id=gigaspatial.handlers.worldpop.write_datasets--parameters>Parameters:<a class=headerlink href=#gigaspatial.handlers.worldpop.write_datasets--parameters title="Permanent link">&para;</a></h6> <p>data_dict : dict Dictionary mapping paths to DataFrames/GeoDataFrames. data_store : DataStore Instance of DataStore for accessing data storage. **kwargs : dict Additional arguments passed to write_dataset.</p> <h6 id=gigaspatial.handlers.worldpop.write_datasets--raises>Raises:<a class=headerlink href=#gigaspatial.handlers.worldpop.write_datasets--raises title="Permanent link">&para;</a></h6> <p>ValueError If there are any errors writing the datasets.</p> <details class=quote> <summary>Source code in <code>gigaspatial/core/io/writers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=k>def</span> <span class=nf>write_datasets</span><span class=p>(</span><span class=n>data_dict</span><span class=p>,</span> <span class=n>data_store</span><span class=p>:</span> <span class=n>DataStore</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>    Write multiple datasets to data storage at once.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>    Parameters:</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>    ----------</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>    data_dict : dict</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=sd>        Dictionary mapping paths to DataFrames/GeoDataFrames.</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>    data_store : DataStore</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>        Instance of DataStore for accessing data storage.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>    **kwargs : dict</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>        Additional arguments passed to write_dataset.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>    Raises:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    ------</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>    ValueError</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>        If there are any errors writing the datasets.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=n>errors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=k>for</span> <span class=n>path</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>data_dict</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=n>write_dataset</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>data_store</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>errors</span><span class=p>[</span><span class=n>path</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=k>if</span> <span class=n>errors</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;- </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>error</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>path</span><span class=p>,</span> <span class=n>error</span> <span class=ow>in</span> <span class=n>errors</span><span class=o>.</span><span class=n>items</span><span class=p>())</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Errors writing datasets:</span><span class=se>\n</span><span class=si>{</span><span class=n>error_msg</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Overview </div> </div> </a> <a href=../processing/ class="md-footer__link md-footer__link--next" aria-label="Next: Processing"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Processing </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 Giga </div> </div> <div class=md-social> <a href=https://github.com/unicef/giga-spatial target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/giga-spatial/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.instant", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.tabs.link", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.3220b9d7.min.js></script> </body> </html>