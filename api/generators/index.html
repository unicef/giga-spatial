<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A powerful Python package for geospatial data analysis and processing"><meta name=author content="Utku Can Ozturk"><link href=https://unicef.github.io/giga-spatial/api/generators/ rel=canonical><link href=../core/ rel=prev><link href=../grid/ rel=next><link rel=icon href=../../assets/GIGA_horizontal_notext_white.webp><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.18"><title>Generators - Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.66ac8b77.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Generators - Documentation"><meta property=og:description content="A powerful Python package for geospatial data analysis and processing"><meta property=og:image content=https://unicef.github.io/giga-spatial/assets/images/social/api/generators.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://unicef.github.io/giga-spatial/api/generators/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Generators - Documentation"><meta name=twitter:description content="A powerful Python package for geospatial data analysis and processing"><meta name=twitter:image content=https://unicef.github.io/giga-spatial/assets/images/social/api/generators.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#generators-module class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Documentation class="md-header__button md-logo" aria-label=Documentation data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Generators </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/unicef/giga-spatial title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> giga-spatial </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../user-guide/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Documentation class="md-nav__button md-logo" aria-label=Documentation data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> Documentation </label> <div class=md-nav__source> <a href=https://github.com/unicef/giga-spatial title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> giga-spatial </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../user-guide/ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../handlers/ class=md-nav__link> <span class=md-ellipsis> Handlers </span> </a> </li> <li class=md-nav__item> <a href=../processing/ class=md-nav__link> <span class=md-ellipsis> Processing </span> </a> </li> <li class=md-nav__item> <a href=../core/ class=md-nav__link> <span class=md-ellipsis> Core </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Generators </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Generators </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#gigaspatial.generators class=md-nav__link> <span class=md-ellipsis> generators </span> </a> <nav class=md-nav aria-label=generators> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gigaspatial.generators.poi class=md-nav__link> <span class=md-ellipsis> poi </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.generators.zonal class=md-nav__link> <span class=md-ellipsis> zonal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../grid/ class=md-nav__link> <span class=md-ellipsis> Grid </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> <span class=md-ellipsis> How to Contribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#gigaspatial.generators class=md-nav__link> <span class=md-ellipsis> generators </span> </a> <nav class=md-nav aria-label=generators> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gigaspatial.generators.poi class=md-nav__link> <span class=md-ellipsis> poi </span> </a> </li> <li class=md-nav__item> <a href=#gigaspatial.generators.zonal class=md-nav__link> <span class=md-ellipsis> zonal </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=generators-module>Generators Module<a class=headerlink href=#generators-module title="Permanent link">&para;</a></h1> <div class="doc doc-object doc-module"> <h2 id=gigaspatial.generators class="doc doc-heading"> <code>gigaspatial.generators</code> <a href=#gigaspatial.generators class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.generators.poi class="doc doc-heading"> <code>poi</code> <a href=#gigaspatial.generators.poi class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.generators.poi.PoiViewGenerator class="doc doc-heading"> <code>PoiViewGenerator</code> <a href=#gigaspatial.generators.poi.PoiViewGenerator class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>POI View Generator for integrating various geospatial datasets such as Google Open Buildings, Microsoft Global Buildings, GHSL Built Surface, and GHSL Settlement Model (SMOD) data with Points of Interest (POIs).</p> <p>This class provides methods to load, process, and map external geospatial data to a given set of POIs, enriching them with relevant attributes. It leverages handler/reader classes for efficient data access and processing.</p> <p>The POIs can be initialized from a list of (latitude, longitude) tuples, a list of dictionaries, a pandas DataFrame, or a geopandas GeoDataFrame.</p> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=k>class</span> <span class=nc>PoiViewGenerator</span><span class=p>:</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    POI View Generator for integrating various geospatial datasets</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    such as Google Open Buildings, Microsoft Global Buildings, GHSL Built Surface,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    and GHSL Settlement Model (SMOD) data with Points of Interest (POIs).</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    This class provides methods to load, process, and map external geospatial</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    data to a given set of POIs, enriching them with relevant attributes.</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    It leverages handler/reader classes for efficient data access and processing.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>    The POIs can be initialized from a list of (latitude, longitude) tuples,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>    a list of dictionaries, a pandas DataFrame, or a geopandas GeoDataFrame.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=n>points</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>],</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=p>],</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>PoiViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>    <span class=p>):</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        Initializes the PoiViewGenerator with the input points and configurations.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        The input `points` are converted into an internal GeoDataFrame</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        (`_points_gdf`) for consistent geospatial operations.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        Args:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>            points (Union[List[Tuple[float, float]], List[dict], pd.DataFrame, gpd.GeoDataFrame]):</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>                The input points of interest. Can be:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>                - A list of (latitude, longitude) tuples.</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>                - A list of dictionaries, where each dict must contain &#39;latitude&#39; and &#39;longitude&#39; keys.</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>                - A pandas DataFrame with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>                - A geopandas GeoDataFrame (expected to have a &#39;geometry&#39; column representing points).</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>            generator_config (Optional[PoiViewGeneratorConfig]):</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>                Configuration for the POI view generation process. If None, a</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>                default `PoiViewGeneratorConfig` will be used.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>            data_store (Optional[DataStore]):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>                An instance of a data store for managing data access (e.g., LocalDataStore).</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>                If None, a default `LocalDataStore` will be used.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>PoiViewGeneratorConfig</span><span class=p>()</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_init_points_gdf</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=k>def</span> <span class=nf>_init_points_gdf</span><span class=p>(</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>        <span class=n>points</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>],</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=p>],</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>        Internal static method to convert various point input formats into a GeoDataFrame.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>        This method standardizes coordinate column names to &#39;latitude&#39; and &#39;longitude&#39;</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>        for consistent internal representation. It also ensures each point has a unique</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>        identifier in the &#39;poi_id&#39; column.</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>        Args:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>            points: Input points in various formats:</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>                - List of (latitude, longitude) tuples</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>                - List of dictionaries with coordinate keys</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>                - DataFrame with coordinate columns</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>                - GeoDataFrame with point geometries</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>        Returns:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>            gpd.GeoDataFrame: Standardized GeoDataFrame with &#39;latitude&#39;, &#39;longitude&#39;,</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>                             and &#39;poi_id&#39; columns</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        Raises:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=sd>            ValueError: If points format is not supported or coordinate columns cannot be detected</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>            <span class=c1># Convert geometry to lat/lon if needed</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=k>if</span> <span class=n>points</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&quot;geometry&quot;</span><span class=p>:</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                <span class=n>points</span> <span class=o>=</span> <span class=n>points</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                <span class=n>points</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>y</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=n>points</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>x</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>            <span class=k>if</span> <span class=s2>&quot;poi_id&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>points</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                <span class=n>points</span><span class=p>[</span><span class=s2>&quot;poi_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;poi_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>))]</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=k>return</span> <span class=n>points</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>            <span class=c1># Detect and standardize coordinate columns</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>                <span class=n>lat_col</span><span class=p>,</span> <span class=n>lon_col</span> <span class=o>=</span> <span class=n>detect_coordinate_columns</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>                <span class=n>points</span> <span class=o>=</span> <span class=n>points</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>                <span class=n>points</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points</span><span class=p>[</span><span class=n>lat_col</span><span class=p>]</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=n>points</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points</span><span class=p>[</span><span class=n>lon_col</span><span class=p>]</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=k>if</span> <span class=s2>&quot;poi_id&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>points</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                    <span class=n>points</span><span class=p>[</span><span class=s2>&quot;poi_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;poi_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>))]</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                <span class=k>return</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                    <span class=sa>f</span><span class=s2>&quot;Could not detect coordinate columns in DataFrame: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                <span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>                <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>                    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>,</span> <span class=s2>&quot;poi_id&quot;</span><span class=p>,</span> <span class=s2>&quot;geometry&quot;</span><span class=p>],</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>                    <span class=n>geometry</span><span class=o>=</span><span class=s2>&quot;geometry&quot;</span><span class=p>,</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                    <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                <span class=p>)</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>tuple</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                <span class=c1># List of (lat, lon) tuples</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>])</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                <span class=n>df</span><span class=p>[</span><span class=s2>&quot;poi_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;poi_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>))]</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                <span class=k>return</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>            <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                <span class=c1># List of dictionaries</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                    <span class=n>lat_col</span><span class=p>,</span> <span class=n>lon_col</span> <span class=o>=</span> <span class=n>detect_coordinate_columns</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                    <span class=n>df</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>lat_col</span><span class=p>]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                    <span class=n>df</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>lon_col</span><span class=p>]</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>                    <span class=k>if</span> <span class=s2>&quot;poi_id&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                        <span class=n>df</span><span class=p>[</span><span class=s2>&quot;poi_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;poi_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>points</span><span class=p>))]</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                    <span class=k>return</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                        <span class=sa>f</span><span class=s2>&quot;Could not detect coordinate columns in dictionary list: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                    <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Unsupported points input type for PoiViewGenerator.&quot;</span><span class=p>)</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=nd>@property</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>    <span class=k>def</span> <span class=nf>points_gdf</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Gets the internal GeoDataFrame of points of interest.&quot;&quot;&quot;</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=k>def</span> <span class=nf>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=n>points_df</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=n>id_column</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=n>lat_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=n>lon_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=n>output_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;nearest&quot;</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>        Maps nearest points from a given DataFrame to the POIs.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=sd>        Enriches the `points_gdf` with the ID and distance to the nearest point</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=sd>        from the input DataFrame for each POI.</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>        Args:</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=sd>            points_df (Union[pd.DataFrame, gpd.GeoDataFrame]):</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>                DataFrame containing points to find nearest neighbors from.</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>                Must have latitude and longitude columns or point geometries.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>            id_column (str):</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>                Name of the column containing unique identifiers for each point.</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>            lat_column (str, optional):</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>                Name of the latitude column in points_df. If None, will attempt to detect it</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>                or extract from geometry if points_df is a GeoDataFrame.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>            lon_column (str, optional):</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>                Name of the longitude column in points_df. If None, will attempt to detect it</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>                or extract from geometry if points_df is a GeoDataFrame.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>            output_prefix (str, optional):</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>                Prefix for the output column names. Defaults to &quot;nearest&quot;.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>                Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>        Returns:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>                          &#39;{output_prefix}_id&#39; and &#39;{output_prefix}_distance&#39;.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>                          Returns a copy of the current `points_gdf` if no points are found.</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>        Raises:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>            ValueError: If required columns are missing from points_df or if coordinate</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>                       columns cannot be detected or extracted from geometry.</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>            <span class=sa>f</span><span class=s2>&quot;Mapping nearest points from </span><span class=si>{</span><span class=n>points_df</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2> to POIs&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=c1># Validate input DataFrame</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=k>if</span> <span class=n>points_df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No points found in the input DataFrame&quot;</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=c1># Handle GeoDataFrame</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points_df</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=n>points_df</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>            <span class=k>if</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&quot;geometry&quot;</span><span class=p>:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>                <span class=n>points_df</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>y</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>                <span class=n>points_df</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>x</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                <span class=n>lat_column</span> <span class=o>=</span> <span class=s2>&quot;latitude&quot;</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=n>lon_column</span> <span class=o>=</span> <span class=s2>&quot;longitude&quot;</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Extracted coordinates from geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>        <span class=c1># Detect coordinate columns if not provided</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>        <span class=k>if</span> <span class=n>lat_column</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>lon_column</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>                <span class=n>detected_lat</span><span class=p>,</span> <span class=n>detected_lon</span> <span class=o>=</span> <span class=n>detect_coordinate_columns</span><span class=p>(</span><span class=n>points_df</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>                <span class=n>lat_column</span> <span class=o>=</span> <span class=n>lat_column</span> <span class=ow>or</span> <span class=n>detected_lat</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>                <span class=n>lon_column</span> <span class=o>=</span> <span class=n>lon_column</span> <span class=ow>or</span> <span class=n>detected_lon</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                    <span class=sa>f</span><span class=s2>&quot;Detected coordinate columns: </span><span class=si>{</span><span class=n>lat_column</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>lon_column</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>                <span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not detect coordinate columns: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=c1># Validate required columns</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=n>required_columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>lat_column</span><span class=p>,</span> <span class=n>lon_column</span><span class=p>,</span> <span class=n>id_column</span><span class=p>]</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>        <span class=n>missing_columns</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>            <span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>required_columns</span> <span class=k>if</span> <span class=n>col</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>points_df</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=p>]</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=k>if</span> <span class=n>missing_columns</span><span class=p>:</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>                <span class=sa>f</span><span class=s2>&quot;Missing required columns in points_df: </span><span class=si>{</span><span class=n>missing_columns</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=p>)</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=kn>from</span> <span class=nn>gigaspatial.processing.geo</span> <span class=kn>import</span> <span class=n>calculate_distance</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Calculating nearest points for each POI&quot;</span><span class=p>)</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=n>tree</span> <span class=o>=</span> <span class=n>cKDTree</span><span class=p>(</span><span class=n>points_df</span><span class=p>[[</span><span class=n>lat_column</span><span class=p>,</span> <span class=n>lon_column</span><span class=p>]])</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=n>points_df_poi</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=n>_</span><span class=p>,</span> <span class=n>idx</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>points_df_poi</span><span class=p>[[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>]],</span> <span class=n>k</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>df_nearest</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>dist</span> <span class=o>=</span> <span class=n>calculate_distance</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>            <span class=n>lat1</span><span class=o>=</span><span class=n>points_df_poi</span><span class=o>.</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>            <span class=n>lon1</span><span class=o>=</span><span class=n>points_df_poi</span><span class=o>.</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>            <span class=n>lat2</span><span class=o>=</span><span class=n>df_nearest</span><span class=p>[</span><span class=n>lat_column</span><span class=p>],</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>            <span class=n>lon2</span><span class=o>=</span><span class=n>df_nearest</span><span class=p>[</span><span class=n>lon_column</span><span class=p>],</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>        <span class=p>)</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>points_df_poi</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=n>result</span><span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_nearest</span><span class=p>[</span><span class=n>id_column</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=n>result</span><span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>_distance&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>            <span class=sa>f</span><span class=s2>&quot;Nearest points mapping complete with prefix &#39;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=n>result</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=k>def</span> <span class=nf>map_google_buildings</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>        Maps Google Open Buildings data to the POIs by finding the nearest building.</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>        Enriches the `points_gdf` with the ID and distance to the nearest</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=sd>        Google Open Building for each POI.</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>        Args:</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>            data_config (Optional[GoogleOpenBuildingsConfig]):</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>                Configuration for accessing Google Open Buildings data. If None, a</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>                default `GoogleOpenBuildingsConfig` will be used.</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>                Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>        Returns:</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>                          &#39;nearest_google_building_id&#39; and &#39;nearest_google_building_distance&#39;.</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>                          Returns a copy of the current `points_gdf` if no buildings are found.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Google Open Buildings data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Google Buildings point data&quot;</span><span class=p>)</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=n>buildings_df</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_points</span><span class=p>(</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>            <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=p>)</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>        <span class=k>if</span> <span class=n>buildings_df</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>buildings_df</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No Google buildings data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>            <span class=n>points_df</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>            <span class=n>id_column</span><span class=o>=</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>            <span class=n>output_prefix</span><span class=o>=</span><span class=s2>&quot;nearest_google_building&quot;</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>        <span class=p>)</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>    <span class=k>def</span> <span class=nf>map_ms_buildings</span><span class=p>(</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>        <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>        Maps Microsoft Global Buildings data to the POIs by finding the nearest building.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>        Enriches the `points_gdf` with the ID and distance to the nearest</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>        Microsoft Global Building for each POI. If buildings don&#39;t have an ID column,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>        creates a unique ID using the building&#39;s coordinates.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>        Args:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>            data_config (Optional[MSBuildingsConfig]):</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>                Configuration for accessing Microsoft Global Buildings data. If None, a</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>                default `MSBuildingsConfig` will be used.</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><span class=sd>                Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>        Returns:</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>                          &#39;nearest_ms_building_id&#39; and &#39;nearest_ms_building_distance&#39;.</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>                          Returns a copy of the current `points_gdf` if no buildings are found.</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Microsoft Global Buildings data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>MSBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Microsoft Buildings polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>            <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>        <span class=p>)</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>        <span class=k>if</span> <span class=n>buildings_gdf</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No Microsoft buildings data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>        <span class=k>if</span> <span class=s2>&quot;building_id&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>buildings_gdf</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Creating building IDs from coordinates&quot;</span><span class=p>)</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>            <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>            <span class=n>buildings_gdf</span><span class=p>[</span><span class=s2>&quot;building_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>                <span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>y</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>x</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>                <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>            <span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>            <span class=n>points_df</span><span class=o>=</span><span class=n>buildings_gdf</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>            <span class=n>id_column</span><span class=o>=</span><span class=s2>&quot;building_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>            <span class=n>output_prefix</span><span class=o>=</span><span class=s2>&quot;nearest_ms_building&quot;</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>        <span class=p>)</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>    <span class=k>def</span> <span class=nf>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>        <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>],</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mean&quot;</span><span class=p>,</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>        <span class=n>map_radius_meters</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>        <span class=n>output_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;zonal_stat&quot;</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>        <span class=n>value_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=n>area_weighted</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><span class=sd>        Maps zonal statistics from raster or polygon data to POIs.</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><span class=sd>        Can operate in three modes:</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=sd>        1. Raster point sampling: Directly samples raster values at POI locations</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><span class=sd>        2. Raster zonal statistics: Creates buffers around POIs and calculates statistics within them</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=sd>        3. Polygon aggregation: Aggregates polygon data to POI buffers with optional area weighting</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>        Args:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=sd>            data (Union[List[TifProcessor], gpd.GeoDataFrame]):</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>                Either a list of TifProcessor objects containing raster data to sample,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>                or a GeoDataFrame containing polygon data to aggregate.</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>            stat (str, optional):</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>                For raster data: Statistic to calculate (&quot;sum&quot;, &quot;mean&quot;, &quot;median&quot;, &quot;min&quot;, &quot;max&quot;).</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>                For polygon data: Aggregation method to use.</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>                Defaults to &quot;mean&quot;.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>            map_radius_meters (float, optional):</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>                If provided, creates circular buffers of this radius around each POI</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>                and calculates statistics within the buffers. If None, samples directly</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>                at POI locations (only for raster data).</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>            output_column (str, optional):</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>                Name of the output column to store the results. Defaults to &quot;zonal_stat&quot;.</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>            value_column (str, optional):</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>                For polygon data: Name of the column to aggregate. Required for polygon data.</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>                Not used for raster data.</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>            area_weighted (bool, optional):</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><span class=sd>                For polygon data: Whether to weight values by fractional area of</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>                intersection. Defaults to False.</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>                Additional keyword arguments passed to the sampling/aggregation functions.</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>        Returns:</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with a new column containing the</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>                          calculated statistics. Returns a copy of the current `points_gdf`</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>                          if no valid data is found.</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>        Raises:</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>            ValueError: If no valid data is provided, if parameters are incompatible,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>                      or if required parameters (value_column) are missing for polygon data.</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>TifProcessor</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>data</span><span class=p>):</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>            <span class=c1># Handle raster data</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No valid raster data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>            <span class=k>if</span> <span class=n>map_radius_meters</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>                    <span class=sa>f</span><span class=s2>&quot;Calculating </span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2> within </span><span class=si>{</span><span class=n>map_radius_meters</span><span class=si>}</span><span class=s2>m buffers around POIs&quot;</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>                <span class=p>)</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>                <span class=c1># Create buffers around POIs</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>                <span class=n>polygon_list</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>                    <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>                    <span class=n>buffer_distance_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>                    <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;round&quot;</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>                <span class=p>)</span><span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>                <span class=c1># Calculate zonal statistics</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>                <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_polygons</span><span class=p>(</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>                    <span class=n>tif_processors</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>polygon_list</span><span class=o>=</span><span class=n>polygon_list</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>                <span class=p>)</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sampling </span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2> at POI locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>                <span class=c1># Sample directly at POI locations</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>                <span class=n>coord_list</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>[[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>                <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>                    <span class=n>tif_processors</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>coordinate_list</span><span class=o>=</span><span class=n>coord_list</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>                <span class=p>)</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>            <span class=c1># Handle polygon data</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>            <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No valid polygon data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>            <span class=k>if</span> <span class=n>map_radius_meters</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;map_radius_meters must be provided for polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>            <span class=k>if</span> <span class=n>value_column</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;value_column must be provided for polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>                <span class=sa>f</span><span class=s2>&quot;Aggregating </span><span class=si>{</span><span class=n>value_column</span><span class=si>}</span><span class=s2> within </span><span class=si>{</span><span class=n>map_radius_meters</span><span class=si>}</span><span class=s2>m buffers around POIs&quot;</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>            <span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>            <span class=c1># Create buffers around POIs</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>            <span class=n>buffer_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>                <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>                <span class=n>buffer_distance_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>                <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;round&quot;</span><span class=p>,</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>            <span class=p>)</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>            <span class=c1># Aggregate polygons to buffers</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_polygons_to_zones</span><span class=p>(</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>                <span class=n>polygons</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>                <span class=n>zones</span><span class=o>=</span><span class=n>buffer_gdf</span><span class=p>,</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>                <span class=n>value_columns</span><span class=o>=</span><span class=n>value_column</span><span class=p>,</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a>                <span class=n>aggregation</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a>                <span class=n>area_weighted</span><span class=o>=</span><span class=n>area_weighted</span><span class=p>,</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>                <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;poi_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a>                <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a>            <span class=p>)</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>            <span class=c1># Extract values for each POI</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a>            <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>value_column</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a>                <span class=s2>&quot;data must be either a list of TifProcessor objects or a GeoDataFrame&quot;</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a>            <span class=p>)</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a>        <span class=n>result</span><span class=p>[</span><span class=n>output_column</span><span class=p>]</span> <span class=o>=</span> <span class=n>sampled_values</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Zonal statistics mapping complete: </span><span class=si>{</span><span class=n>output_column</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=n>result</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a>    <span class=k>def</span> <span class=nf>map_built_s</span><span class=p>(</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a>        <span class=n>map_radius_meters</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>        <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>        <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>        <span class=n>output_column</span><span class=o>=</span><span class=s2>&quot;built_surface_m2&quot;</span><span class=p>,</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=sd>        Maps GHSL Built Surface (GHS_BUILT_S) data to the POIs.</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a><span class=sd>        Calculates the sum of built surface area within a specified buffer</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=sd>        radius around each POI. Enriches `points_gdf` with the &#39;built_surface_m2&#39; column.</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a><span class=sd>        Args:</span>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>            data_config (Optional[GHSLDataConfig]):</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=sd>                Configuration for accessing GHSL Built Surface data. If None, a</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>                default `GHSLDataConfig` for &#39;GHS_BUILT_S&#39; will be used.</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>            map_radius_meters (float):</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>                The buffer distance in meters around each POI to calculate</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>                zonal statistics for built surface. Defaults to 150 meters.</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>                Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>        Returns:</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with a new column:</span>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>                          &#39;built_surface_m2&#39;. Returns a copy of the current</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>                          `points_gdf` if no GHSL Built Surface data is found.</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping GHSL Built Surface data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>            <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>            <span class=n>year</span><span class=o>=</span><span class=n>dataset_year</span><span class=p>,</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>            <span class=n>resolution</span><span class=o>=</span><span class=n>dataset_resolution</span><span class=p>,</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>        <span class=p>)</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>        <span class=n>gdf_points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading GHSL Built Surface raster tiles&quot;</span><span class=p>)</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a>        <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a>            <span class=n>gdf_points</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>        <span class=p>)</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a>            <span class=n>data</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a>            <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a>            <span class=n>map_radius_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>            <span class=n>output_column</span><span class=o>=</span><span class=n>output_column</span><span class=p>,</span>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a>        <span class=p>)</span>
</span><span id=__span-0-555><a id=__codelineno-0-555 name=__codelineno-0-555></a>
</span><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a>    <span class=k>def</span> <span class=nf>map_smod</span><span class=p>(</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>        <span class=n>stat</span><span class=o>=</span><span class=s2>&quot;median&quot;</span><span class=p>,</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>        <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>        <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>        <span class=n>output_column</span><span class=o>=</span><span class=s2>&quot;smod_class&quot;</span><span class=p>,</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>        Maps GHSL Settlement Model (SMOD) data to the POIs.</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a><span class=sd>        Samples the SMOD class value at each POI&#39;s location. Enriches `points_gdf`</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>        with the &#39;smod_class&#39; column.</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>        Args:</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>            data_config (Optional[GHSLDataConfig]):</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=sd>                Configuration for accessing GHSL SMOD data. If None, a</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>                default `GHSLDataConfig` for &#39;GHS_SMOD&#39; will be used.</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a><span class=sd>            **kwargs:</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>                Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a><span class=sd>        Returns:</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a><span class=sd>            pd.DataFrame: The updated GeoDataFrame with a new column:</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=sd>                          &#39;smod_class&#39;. Returns a copy of the current</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=sd>                          `points_gdf` if no GHSL SMOD data is found.</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping GHSL Settlement Model (SMOD) data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a>            <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a>            <span class=n>year</span><span class=o>=</span><span class=n>dataset_year</span><span class=p>,</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>            <span class=n>resolution</span><span class=o>=</span><span class=n>dataset_resolution</span><span class=p>,</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>            <span class=n>coord_system</span><span class=o>=</span><span class=mi>54009</span><span class=p>,</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>        <span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>        <span class=n>gdf_points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading GHSL SMOD raster tiles&quot;</span><span class=p>)</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>        <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>            <span class=n>gdf_points</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>        <span class=p>)</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>            <span class=n>data</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>            <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>  <span class=c1># Use median for categorical data</span>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>            <span class=n>output_column</span><span class=o>=</span><span class=n>output_column</span><span class=p>,</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>        <span class=p>)</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>    <span class=k>def</span> <span class=nf>save_view</span><span class=p>(</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>        <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>        <span class=n>output_format</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a><span class=sd>        Saves the current POI view (the enriched GeoDataFrame) to a file.</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a><span class=sd>        The output path and format are determined by the `generator_config`</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a><span class=sd>        or overridden by the `output_format` parameter.</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a><span class=sd>        Args:</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a><span class=sd>            name (str): The base name for the output file (without extension).</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a><span class=sd>            output_format (Optional[str]):</span>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a><span class=sd>                The desired output format (e.g., &quot;csv&quot;, &quot;geojson&quot;). If None,</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a><span class=sd>                the `output_format` from `generator_config` will be used.</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a><span class=sd>        Returns:</span>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a><span class=sd>            Path: The full path to the saved output file.</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>        <span class=n>format_to_use</span> <span class=o>=</span> <span class=n>output_format</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>generator_config</span><span class=o>.</span><span class=n>output_format</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>        <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generator_config</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>format_to_use</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving POI view to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>        <span class=n>write_dataset</span><span class=p>(</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a>            <span class=n>df</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>            <span class=n>path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>            <span class=nb>format</span><span class=o>=</span><span class=n>format_to_use</span><span class=p>,</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>        <span class=p>)</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>        <span class=k>return</span> <span class=n>output_path</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.points_gdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>points_gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.generators.poi.PoiViewGenerator.points_gdf class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Gets the internal GeoDataFrame of points of interest.</p> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.__init__ class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Initializes the PoiViewGenerator with the input points and configurations.</p> <p>The input <code>points</code> are converted into an internal GeoDataFrame (<code>_points_gdf</code>) for consistent geospatial operations.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>points</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[float, float]], <span title="typing.List">List</span>[dict], <span title="pandas.DataFrame">DataFrame</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>The input points of interest. Can be: - A list of (latitude, longitude) tuples. - A list of dictionaries, where each dict must contain 'latitude' and 'longitude' keys. - A pandas DataFrame with 'latitude' and 'longitude' columns. - A geopandas GeoDataFrame (expected to have a 'geometry' column representing points).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>generator_config</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.generators.poi.PoiViewGeneratorConfig" href="#gigaspatial.generators.poi.PoiViewGeneratorConfig">PoiViewGeneratorConfig</a>]</code> </td> <td> <div class=doc-md-description> <p>Configuration for the POI view generation process. If None, a default <code>PoiViewGeneratorConfig</code> will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a>]</code> </td> <td> <div class=doc-md-description> <p>An instance of a data store for managing data access (e.g., LocalDataStore). If None, a default <code>LocalDataStore</code> will be used.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=n>points</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>],</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=p>],</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>PoiViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=p>):</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    Initializes the PoiViewGenerator with the input points and configurations.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>    The input `points` are converted into an internal GeoDataFrame</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    (`_points_gdf`) for consistent geospatial operations.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    Args:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        points (Union[List[Tuple[float, float]], List[dict], pd.DataFrame, gpd.GeoDataFrame]):</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><span class=sd>            The input points of interest. Can be:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>            - A list of (latitude, longitude) tuples.</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>            - A list of dictionaries, where each dict must contain &#39;latitude&#39; and &#39;longitude&#39; keys.</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>            - A pandas DataFrame with &#39;latitude&#39; and &#39;longitude&#39; columns.</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>            - A geopandas GeoDataFrame (expected to have a &#39;geometry&#39; column representing points).</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>        generator_config (Optional[PoiViewGeneratorConfig]):</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>            Configuration for the POI view generation process. If None, a</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>            default `PoiViewGeneratorConfig` will be used.</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        data_store (Optional[DataStore]):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>            An instance of a data store for managing data access (e.g., LocalDataStore).</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>            If None, a default `LocalDataStore` will be used.</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>PoiViewGeneratorConfig</span><span class=p>()</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_init_points_gdf</span><span class=p>(</span><span class=n>points</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_built_s class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_built_s</span><span class=p>(</span><span class=n>map_radius_meters</span><span class=o>=</span><span class=mi>150</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span> <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>output_column</span><span class=o>=</span><span class=s1>&#39;built_surface_m2&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_built_s class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps GHSL Built Surface (GHS_BUILT_S) data to the POIs.</p> <p>Calculates the sum of built surface area within a specified buffer radius around each POI. Enriches <code>points_gdf</code> with the 'built_surface_m2' column.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_config</code></td> <td> <code><span title="typing.Optional">Optional</span>[GHSLDataConfig]</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing GHSL Built Surface data. If None, a default <code>GHSLDataConfig</code> for 'GHS_BUILT_S' will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>map_radius_meters</code></td> <td> <code>float</code> </td> <td> <div class=doc-md-description> <p>The buffer distance in meters around each POI to calculate zonal statistics for built surface. Defaults to 150 meters.</p> </div> </td> <td> <code>150</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the data reader (if applicable).</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with a new column: 'built_surface_m2'. Returns a copy of the current <code>points_gdf</code> if no GHSL Built Surface data is found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span>
<span class=normal><a href=#__codelineno-0-518>518</a></span>
<span class=normal><a href=#__codelineno-0-519>519</a></span>
<span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=k>def</span> <span class=nf>map_built_s</span><span class=p>(</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a>    <span class=n>map_radius_meters</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>150</span><span class=p>,</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>    <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>    <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>    <span class=n>output_column</span><span class=o>=</span><span class=s2>&quot;built_surface_m2&quot;</span><span class=p>,</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a><span class=sd>    Maps GHSL Built Surface (GHS_BUILT_S) data to the POIs.</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a><span class=sd>    Calculates the sum of built surface area within a specified buffer</span>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a><span class=sd>    radius around each POI. Enriches `points_gdf` with the &#39;built_surface_m2&#39; column.</span>
</span><span id=__span-0-518><a id=__codelineno-0-518 name=__codelineno-0-518></a>
</span><span id=__span-0-519><a id=__codelineno-0-519 name=__codelineno-0-519></a><span class=sd>    Args:</span>
</span><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=sd>        data_config (Optional[GHSLDataConfig]):</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a><span class=sd>            Configuration for accessing GHSL Built Surface data. If None, a</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=sd>            default `GHSLDataConfig` for &#39;GHS_BUILT_S&#39; will be used.</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=sd>        map_radius_meters (float):</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>            The buffer distance in meters around each POI to calculate</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>            zonal statistics for built surface. Defaults to 150 meters.</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>            Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a><span class=sd>    Returns:</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with a new column:</span>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a><span class=sd>                      &#39;built_surface_m2&#39;. Returns a copy of the current</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a><span class=sd>                      `points_gdf` if no GHSL Built Surface data is found.</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping GHSL Built Surface data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>        <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>        <span class=n>year</span><span class=o>=</span><span class=n>dataset_year</span><span class=p>,</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>        <span class=n>resolution</span><span class=o>=</span><span class=n>dataset_resolution</span><span class=p>,</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>    <span class=p>)</span>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>    <span class=n>gdf_points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading GHSL Built Surface raster tiles&quot;</span><span class=p>)</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a>    <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a>        <span class=n>gdf_points</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>    <span class=p>)</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-549><a id=__codelineno-0-549 name=__codelineno-0-549></a>        <span class=n>data</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span>
</span><span id=__span-0-550><a id=__codelineno-0-550 name=__codelineno-0-550></a>        <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>
</span><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a>        <span class=n>map_radius_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>        <span class=n>output_column</span><span class=o>=</span><span class=n>output_column</span><span class=p>,</span>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_google_buildings class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_google_buildings</span><span class=p>(</span><span class=n>handler</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_google_buildings class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps Google Open Buildings data to the POIs by finding the nearest building.</p> <p>Enriches the <code>points_gdf</code> with the ID and distance to the nearest Google Open Building for each POI.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_config</code></td> <td> <code><span title="typing.Optional">Optional</span>[GoogleOpenBuildingsConfig]</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing Google Open Buildings data. If None, a default <code>GoogleOpenBuildingsConfig</code> will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the data reader (if applicable).</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with new columns: 'nearest_google_building_id' and 'nearest_google_building_distance'. Returns a copy of the current <code>points_gdf</code> if no buildings are found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=k>def</span> <span class=nf>map_google_buildings</span><span class=p>(</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>    <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>    Maps Google Open Buildings data to the POIs by finding the nearest building.</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>    Enriches the `points_gdf` with the ID and distance to the nearest</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=sd>    Google Open Building for each POI.</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>    Args:</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>        data_config (Optional[GoogleOpenBuildingsConfig]):</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>            Configuration for accessing Google Open Buildings data. If None, a</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>            default `GoogleOpenBuildingsConfig` will be used.</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>            Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>    Returns:</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>                      &#39;nearest_google_building_id&#39; and &#39;nearest_google_building_distance&#39;.</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>                      Returns a copy of the current `points_gdf` if no buildings are found.</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Google Open Buildings data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Google Buildings point data&quot;</span><span class=p>)</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>    <span class=n>buildings_df</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_points</span><span class=p>(</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=p>)</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=k>if</span> <span class=n>buildings_df</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>buildings_df</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No Google buildings data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>        <span class=n>points_df</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>        <span class=n>id_column</span><span class=o>=</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>,</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>        <span class=n>output_prefix</span><span class=o>=</span><span class=s2>&quot;nearest_google_building&quot;</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_ms_buildings class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_ms_buildings</span><span class=p>(</span><span class=n>handler</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_ms_buildings class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps Microsoft Global Buildings data to the POIs by finding the nearest building.</p> <p>Enriches the <code>points_gdf</code> with the ID and distance to the nearest Microsoft Global Building for each POI. If buildings don't have an ID column, creates a unique ID using the building's coordinates.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_config</code></td> <td> <code><span title="typing.Optional">Optional</span>[MSBuildingsConfig]</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing Microsoft Global Buildings data. If None, a default <code>MSBuildingsConfig</code> will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the data reader (if applicable).</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with new columns: 'nearest_ms_building_id' and 'nearest_ms_building_distance'. Returns a copy of the current <code>points_gdf</code> if no buildings are found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=k>def</span> <span class=nf>map_ms_buildings</span><span class=p>(</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>    <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>    Maps Microsoft Global Buildings data to the POIs by finding the nearest building.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>    Enriches the `points_gdf` with the ID and distance to the nearest</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>    Microsoft Global Building for each POI. If buildings don&#39;t have an ID column,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>    creates a unique ID using the building&#39;s coordinates.</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>    Args:</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        data_config (Optional[MSBuildingsConfig]):</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>            Configuration for accessing Microsoft Global Buildings data. If None, a</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>            default `MSBuildingsConfig` will be used.</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><span class=sd>            Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>    Returns:</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>                      &#39;nearest_ms_building_id&#39; and &#39;nearest_ms_building_distance&#39;.</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>                      Returns a copy of the current `points_gdf` if no buildings are found.</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Microsoft Global Buildings data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>MSBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Microsoft Buildings polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>    <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>        <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>    <span class=p>)</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=k>if</span> <span class=n>buildings_gdf</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No Microsoft buildings data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>    <span class=k>if</span> <span class=s2>&quot;building_id&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>buildings_gdf</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Creating building IDs from coordinates&quot;</span><span class=p>)</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>        <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>        <span class=n>buildings_gdf</span><span class=p>[</span><span class=s2>&quot;building_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>y</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>row</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>x</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>            <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>        <span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>        <span class=n>points_df</span><span class=o>=</span><span class=n>buildings_gdf</span><span class=p>,</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>        <span class=n>id_column</span><span class=o>=</span><span class=s2>&quot;building_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>        <span class=n>output_prefix</span><span class=o>=</span><span class=s2>&quot;nearest_ms_building&quot;</span><span class=p>,</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_nearest_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_nearest_points</span><span class=p>(</span><span class=n>points_df</span><span class=p>,</span> <span class=n>id_column</span><span class=p>,</span> <span class=n>lat_column</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lon_column</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>output_prefix</span><span class=o>=</span><span class=s1>&#39;nearest&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_nearest_points class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps nearest points from a given DataFrame to the POIs.</p> <p>Enriches the <code>points_gdf</code> with the ID and distance to the nearest point from the input DataFrame for each POI.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>points_df</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>DataFrame containing points to find nearest neighbors from. Must have latitude and longitude columns or point geometries.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>id_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the column containing unique identifiers for each point.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>lat_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the latitude column in points_df. If None, will attempt to detect it or extract from geometry if points_df is a GeoDataFrame.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>lon_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the longitude column in points_df. If None, will attempt to detect it or extract from geometry if points_df is a GeoDataFrame.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>output_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for the output column names. Defaults to "nearest".</p> </div> </td> <td> <code>&#39;nearest&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the data reader (if applicable).</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with new columns: '{output_prefix}_id' and '{output_prefix}_distance'. Returns a copy of the current <code>points_gdf</code> if no points are found.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If required columns are missing from points_df or if coordinate columns cannot be detected or extracted from geometry.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a><span class=k>def</span> <span class=nf>map_nearest_points</span><span class=p>(</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>    <span class=n>points_df</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>    <span class=n>id_column</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>    <span class=n>lat_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>    <span class=n>lon_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>    <span class=n>output_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;nearest&quot;</span><span class=p>,</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>    Maps nearest points from a given DataFrame to the POIs.</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=sd>    Enriches the `points_gdf` with the ID and distance to the nearest point</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=sd>    from the input DataFrame for each POI.</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>    Args:</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=sd>        points_df (Union[pd.DataFrame, gpd.GeoDataFrame]):</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>            DataFrame containing points to find nearest neighbors from.</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>            Must have latitude and longitude columns or point geometries.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>        id_column (str):</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>            Name of the column containing unique identifiers for each point.</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>        lat_column (str, optional):</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>            Name of the latitude column in points_df. If None, will attempt to detect it</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>            or extract from geometry if points_df is a GeoDataFrame.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>        lon_column (str, optional):</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>            Name of the longitude column in points_df. If None, will attempt to detect it</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>            or extract from geometry if points_df is a GeoDataFrame.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        output_prefix (str, optional):</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>            Prefix for the output column names. Defaults to &quot;nearest&quot;.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>            Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>    Returns:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with new columns:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>                      &#39;{output_prefix}_id&#39; and &#39;{output_prefix}_distance&#39;.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>                      Returns a copy of the current `points_gdf` if no points are found.</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>    Raises:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>        ValueError: If required columns are missing from points_df or if coordinate</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>                   columns cannot be detected or extracted from geometry.</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=sa>f</span><span class=s2>&quot;Mapping nearest points from </span><span class=si>{</span><span class=n>points_df</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2> to POIs&quot;</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>    <span class=p>)</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=c1># Validate input DataFrame</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>    <span class=k>if</span> <span class=n>points_df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No points found in the input DataFrame&quot;</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=c1># Handle GeoDataFrame</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>points_df</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=n>points_df</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=k>if</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&quot;geometry&quot;</span><span class=p>:</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>            <span class=n>points_df</span><span class=p>[</span><span class=s2>&quot;latitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>y</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=n>points_df</span><span class=p>[</span><span class=s2>&quot;longitude&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>x</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=n>lat_column</span> <span class=o>=</span> <span class=s2>&quot;latitude&quot;</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>            <span class=n>lon_column</span> <span class=o>=</span> <span class=s2>&quot;longitude&quot;</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Extracted coordinates from geometry&quot;</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>    <span class=c1># Detect coordinate columns if not provided</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>    <span class=k>if</span> <span class=n>lat_column</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>lon_column</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=n>detected_lat</span><span class=p>,</span> <span class=n>detected_lon</span> <span class=o>=</span> <span class=n>detect_coordinate_columns</span><span class=p>(</span><span class=n>points_df</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>            <span class=n>lat_column</span> <span class=o>=</span> <span class=n>lat_column</span> <span class=ow>or</span> <span class=n>detected_lat</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>            <span class=n>lon_column</span> <span class=o>=</span> <span class=n>lon_column</span> <span class=ow>or</span> <span class=n>detected_lon</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>                <span class=sa>f</span><span class=s2>&quot;Detected coordinate columns: </span><span class=si>{</span><span class=n>lat_column</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>lon_column</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Could not detect coordinate columns: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=c1># Validate required columns</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>    <span class=n>required_columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>lat_column</span><span class=p>,</span> <span class=n>lon_column</span><span class=p>,</span> <span class=n>id_column</span><span class=p>]</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=n>missing_columns</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>required_columns</span> <span class=k>if</span> <span class=n>col</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>points_df</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=p>]</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>    <span class=k>if</span> <span class=n>missing_columns</span><span class=p>:</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>            <span class=sa>f</span><span class=s2>&quot;Missing required columns in points_df: </span><span class=si>{</span><span class=n>missing_columns</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=p>)</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=kn>from</span> <span class=nn>gigaspatial.processing.geo</span> <span class=kn>import</span> <span class=n>calculate_distance</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Calculating nearest points for each POI&quot;</span><span class=p>)</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>    <span class=n>tree</span> <span class=o>=</span> <span class=n>cKDTree</span><span class=p>(</span><span class=n>points_df</span><span class=p>[[</span><span class=n>lat_column</span><span class=p>,</span> <span class=n>lon_column</span><span class=p>]])</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>    <span class=n>points_df_poi</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=n>_</span><span class=p>,</span> <span class=n>idx</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>points_df_poi</span><span class=p>[[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>]],</span> <span class=n>k</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=n>df_nearest</span> <span class=o>=</span> <span class=n>points_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=n>dist</span> <span class=o>=</span> <span class=n>calculate_distance</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=n>lat1</span><span class=o>=</span><span class=n>points_df_poi</span><span class=o>.</span><span class=n>latitude</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=n>lon1</span><span class=o>=</span><span class=n>points_df_poi</span><span class=o>.</span><span class=n>longitude</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=n>lat2</span><span class=o>=</span><span class=n>df_nearest</span><span class=p>[</span><span class=n>lat_column</span><span class=p>],</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=n>lon2</span><span class=o>=</span><span class=n>df_nearest</span><span class=p>[</span><span class=n>lon_column</span><span class=p>],</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>    <span class=p>)</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>points_df_poi</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>    <span class=n>result</span><span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_nearest</span><span class=p>[</span><span class=n>id_column</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>    <span class=n>result</span><span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>_distance&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=sa>f</span><span class=s2>&quot;Nearest points mapping complete with prefix &#39;</span><span class=si>{</span><span class=n>output_prefix</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>    <span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=n>result</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_smod class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_smod</span><span class=p>(</span><span class=n>stat</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>,</span> <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span> <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>output_column</span><span class=o>=</span><span class=s1>&#39;smod_class&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_smod class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps GHSL Settlement Model (SMOD) data to the POIs.</p> <p>Samples the SMOD class value at each POI's location. Enriches <code>points_gdf</code> with the 'smod_class' column.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data_config</code></td> <td> <code><span title="typing.Optional">Optional</span>[GHSLDataConfig]</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing GHSL SMOD data. If None, a default <code>GHSLDataConfig</code> for 'GHS_SMOD' will be used.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the data reader (if applicable).</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with a new column: 'smod_class'. Returns a copy of the current <code>points_gdf</code> if no GHSL SMOD data is found.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a><span class=k>def</span> <span class=nf>map_smod</span><span class=p>(</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>    <span class=n>stat</span><span class=o>=</span><span class=s2>&quot;median&quot;</span><span class=p>,</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>    <span class=n>dataset_year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>    <span class=n>dataset_resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>    <span class=n>output_column</span><span class=o>=</span><span class=s2>&quot;smod_class&quot;</span><span class=p>,</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>    Maps GHSL Settlement Model (SMOD) data to the POIs.</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a><span class=sd>    Samples the SMOD class value at each POI&#39;s location. Enriches `points_gdf`</span>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>    with the &#39;smod_class&#39; column.</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>    Args:</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>        data_config (Optional[GHSLDataConfig]):</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=sd>            Configuration for accessing GHSL SMOD data. If None, a</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>            default `GHSLDataConfig` for &#39;GHS_SMOD&#39; will be used.</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>            Additional keyword arguments passed to the data reader (if applicable).</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a><span class=sd>    Returns:</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with a new column:</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=sd>                      &#39;smod_class&#39;. Returns a copy of the current</span>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=sd>                      `points_gdf` if no GHSL SMOD data is found.</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping GHSL Settlement Model (SMOD) data to POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a>        <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a>        <span class=n>year</span><span class=o>=</span><span class=n>dataset_year</span><span class=p>,</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>        <span class=n>resolution</span><span class=o>=</span><span class=n>dataset_resolution</span><span class=p>,</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>        <span class=n>coord_system</span><span class=o>=</span><span class=mi>54009</span><span class=p>,</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>    <span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>    <span class=n>gdf_points</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>crs</span><span class=p>)</span>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading GHSL SMOD raster tiles&quot;</span><span class=p>)</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>    <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>        <span class=n>gdf_points</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>    <span class=p>)</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>        <span class=n>data</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>        <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>  <span class=c1># Use median for categorical data</span>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>        <span class=n>output_column</span><span class=o>=</span><span class=n>output_column</span><span class=p>,</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.map_zonal_stats class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_zonal_stats</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=n>map_radius_meters</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>output_column</span><span class=o>=</span><span class=s1>&#39;zonal_stat&#39;</span><span class=p>,</span> <span class=n>value_column</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.map_zonal_stats class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Maps zonal statistics from raster or polygon data to POIs.</p> <p>Can operate in three modes: 1. Raster point sampling: Directly samples raster values at POI locations 2. Raster zonal statistics: Creates buffers around POIs and calculates statistics within them 3. Polygon aggregation: Aggregates polygon data to POI buffers with optional area weighting</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>data</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="gigaspatial.processing.tif_processor.TifProcessor" href="../processing/#gigaspatial.processing.tif_processor.TifProcessor">TifProcessor</a>], <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>Either a list of TifProcessor objects containing raster data to sample, or a GeoDataFrame containing polygon data to aggregate.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>stat</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>For raster data: Statistic to calculate ("sum", "mean", "median", "min", "max"). For polygon data: Aggregation method to use. Defaults to "mean".</p> </div> </td> <td> <code>&#39;mean&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>map_radius_meters</code></td> <td> <code>float</code> </td> <td> <div class=doc-md-description> <p>If provided, creates circular buffers of this radius around each POI and calculates statistics within the buffers. If None, samples directly at POI locations (only for raster data).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>output_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the output column to store the results. Defaults to "zonal_stat".</p> </div> </td> <td> <code>&#39;zonal_stat&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>value_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>For polygon data: Name of the column to aggregate. Required for polygon data. Not used for raster data.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>area_weighted</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>For polygon data: Whether to weight values by fractional area of intersection. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the sampling/aggregation functions.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="pandas.DataFrame">DataFrame</span></code> </td> <td> <div class=doc-md-description> <p>pd.DataFrame: The updated GeoDataFrame with a new column containing the calculated statistics. Returns a copy of the current <code>points_gdf</code> if no valid data is found.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If no valid data is provided, if parameters are incompatible, or if required parameters (value_column) are missing for polygon data.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=k>def</span> <span class=nf>map_zonal_stats</span><span class=p>(</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>    <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>],</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mean&quot;</span><span class=p>,</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>    <span class=n>map_radius_meters</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>    <span class=n>output_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;zonal_stat&quot;</span><span class=p>,</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>    <span class=n>value_column</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>    <span class=n>area_weighted</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><span class=sd>    Maps zonal statistics from raster or polygon data to POIs.</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a><span class=sd>    Can operate in three modes:</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=sd>    1. Raster point sampling: Directly samples raster values at POI locations</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a><span class=sd>    2. Raster zonal statistics: Creates buffers around POIs and calculates statistics within them</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=sd>    3. Polygon aggregation: Aggregates polygon data to POI buffers with optional area weighting</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>    Args:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=sd>        data (Union[List[TifProcessor], gpd.GeoDataFrame]):</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>            Either a list of TifProcessor objects containing raster data to sample,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a><span class=sd>            or a GeoDataFrame containing polygon data to aggregate.</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a><span class=sd>        stat (str, optional):</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=sd>            For raster data: Statistic to calculate (&quot;sum&quot;, &quot;mean&quot;, &quot;median&quot;, &quot;min&quot;, &quot;max&quot;).</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=sd>            For polygon data: Aggregation method to use.</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a><span class=sd>            Defaults to &quot;mean&quot;.</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>        map_radius_meters (float, optional):</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=sd>            If provided, creates circular buffers of this radius around each POI</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>            and calculates statistics within the buffers. If None, samples directly</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>            at POI locations (only for raster data).</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>        output_column (str, optional):</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>            Name of the output column to store the results. Defaults to &quot;zonal_stat&quot;.</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>        value_column (str, optional):</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a><span class=sd>            For polygon data: Name of the column to aggregate. Required for polygon data.</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>            Not used for raster data.</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a><span class=sd>        area_weighted (bool, optional):</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><span class=sd>            For polygon data: Whether to weight values by fractional area of</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>            intersection. Defaults to False.</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>        **kwargs:</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a><span class=sd>            Additional keyword arguments passed to the sampling/aggregation functions.</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a><span class=sd>    Returns:</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a><span class=sd>        pd.DataFrame: The updated GeoDataFrame with a new column containing the</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a><span class=sd>                      calculated statistics. Returns a copy of the current `points_gdf`</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a><span class=sd>                      if no valid data is found.</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a><span class=sd>    Raises:</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a><span class=sd>        ValueError: If no valid data is provided, if parameters are incompatible,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a><span class=sd>                  or if required parameters (value_column) are missing for polygon data.</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>TifProcessor</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>data</span><span class=p>):</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>        <span class=c1># Handle raster data</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No valid raster data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>        <span class=k>if</span> <span class=n>map_radius_meters</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>                <span class=sa>f</span><span class=s2>&quot;Calculating </span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2> within </span><span class=si>{</span><span class=n>map_radius_meters</span><span class=si>}</span><span class=s2>m buffers around POIs&quot;</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>            <span class=p>)</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>            <span class=c1># Create buffers around POIs</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>            <span class=n>polygon_list</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>                <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>                <span class=n>buffer_distance_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>                <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;round&quot;</span><span class=p>,</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>            <span class=p>)</span><span class=o>.</span><span class=n>geometry</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>            <span class=c1># Calculate zonal statistics</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>            <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_polygons</span><span class=p>(</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>                <span class=n>tif_processors</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>polygon_list</span><span class=o>=</span><span class=n>polygon_list</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>            <span class=p>)</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sampling </span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2> at POI locations&quot;</span><span class=p>)</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>            <span class=c1># Sample directly at POI locations</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>            <span class=n>coord_list</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>[[</span><span class=s2>&quot;latitude&quot;</span><span class=p>,</span> <span class=s2>&quot;longitude&quot;</span><span class=p>]]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>            <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_coordinates</span><span class=p>(</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>                <span class=n>tif_processors</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>coordinate_list</span><span class=o>=</span><span class=n>coord_list</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>            <span class=p>)</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>        <span class=c1># Handle polygon data</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>        <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;No valid polygon data found for the provided POIs&quot;</span><span class=p>)</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>        <span class=k>if</span> <span class=n>map_radius_meters</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;map_radius_meters must be provided for polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>        <span class=k>if</span> <span class=n>value_column</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;value_column must be provided for polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>            <span class=sa>f</span><span class=s2>&quot;Aggregating </span><span class=si>{</span><span class=n>value_column</span><span class=si>}</span><span class=s2> within </span><span class=si>{</span><span class=n>map_radius_meters</span><span class=si>}</span><span class=s2>m buffers around POIs&quot;</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>        <span class=p>)</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>        <span class=c1># Create buffers around POIs</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>        <span class=n>buffer_gdf</span> <span class=o>=</span> <span class=n>buffer_geodataframe</span><span class=p>(</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>            <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>            <span class=n>buffer_distance_meters</span><span class=o>=</span><span class=n>map_radius_meters</span><span class=p>,</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>            <span class=n>cap_style</span><span class=o>=</span><span class=s2>&quot;round&quot;</span><span class=p>,</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=p>)</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>        <span class=c1># Aggregate polygons to buffers</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_polygons_to_zones</span><span class=p>(</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>            <span class=n>polygons</span><span class=o>=</span><span class=n>data</span><span class=p>,</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>            <span class=n>zones</span><span class=o>=</span><span class=n>buffer_gdf</span><span class=p>,</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>            <span class=n>value_columns</span><span class=o>=</span><span class=n>value_column</span><span class=p>,</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a>            <span class=n>aggregation</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a>            <span class=n>area_weighted</span><span class=o>=</span><span class=n>area_weighted</span><span class=p>,</span>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>            <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;poi_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a>        <span class=p>)</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>        <span class=c1># Extract values for each POI</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a>        <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>value_column</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a>            <span class=s2>&quot;data must be either a list of TifProcessor objects or a GeoDataFrame&quot;</span>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a>        <span class=p>)</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>    <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a>    <span class=n>result</span><span class=p>[</span><span class=n>output_column</span><span class=p>]</span> <span class=o>=</span> <span class=n>sampled_values</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Zonal statistics mapping complete: </span><span class=si>{</span><span class=n>output_column</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_points_gdf</span> <span class=o>=</span> <span class=n>result</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=gigaspatial.generators.poi.PoiViewGenerator.save_view class="doc doc-heading"> <code class="highlight language-python"><span class=n>save_view</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>output_format</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.generators.poi.PoiViewGenerator.save_view class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p>Saves the current POI view (the enriched GeoDataFrame) to a file.</p> <p>The output path and format are determined by the <code>generator_config</code> or overridden by the <code>output_format</code> parameter.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>name</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The base name for the output file (without extension).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_format</code></td> <td> <code><span title="typing.Optional">Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The desired output format (e.g., "csv", "geojson"). If None, the <code>output_format</code> from <code>generator_config</code> will be used.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Path</code></td> <td> <code><span title="pathlib.Path">Path</span></code> </td> <td> <div class=doc-md-description> <p>The full path to the saved output file.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a><span class=k>def</span> <span class=nf>save_view</span><span class=p>(</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>    <span class=n>output_format</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-611><a id=__codelineno-0-611 name=__codelineno-0-611></a><span class=sd>    Saves the current POI view (the enriched GeoDataFrame) to a file.</span>
</span><span id=__span-0-612><a id=__codelineno-0-612 name=__codelineno-0-612></a>
</span><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a><span class=sd>    The output path and format are determined by the `generator_config`</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a><span class=sd>    or overridden by the `output_format` parameter.</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a><span class=sd>    Args:</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a><span class=sd>        name (str): The base name for the output file (without extension).</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a><span class=sd>        output_format (Optional[str]):</span>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a><span class=sd>            The desired output format (e.g., &quot;csv&quot;, &quot;geojson&quot;). If None,</span>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a><span class=sd>            the `output_format` from `generator_config` will be used.</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a><span class=sd>    Returns:</span>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a><span class=sd>        Path: The full path to the saved output file.</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>    <span class=n>format_to_use</span> <span class=o>=</span> <span class=n>output_format</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>generator_config</span><span class=o>.</span><span class=n>output_format</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>    <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generator_config</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>format_to_use</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving POI view to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>    <span class=n>write_dataset</span><span class=p>(</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a>        <span class=n>df</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>points_gdf</span><span class=p>,</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>        <span class=n>path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>        <span class=nb>format</span><span class=o>=</span><span class=n>format_to_use</span><span class=p>,</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>    <span class=p>)</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>    <span class=k>return</span> <span class=n>output_path</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=gigaspatial.generators.poi.PoiViewGeneratorConfig class="doc doc-heading"> <code>PoiViewGeneratorConfig</code> <a href=#gigaspatial.generators.poi.PoiViewGeneratorConfig class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <p>Configuration for POI (Point of Interest) view generation.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.poi.PoiViewGeneratorConfig.base_path">base_path</span></code></td> <td> <code><span title="pathlib.Path">Path</span></code> </td> <td> <div class=doc-md-description> <p>The base directory where generated POI views will be saved. Defaults to a path retrieved from <code>config</code>.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.poi.PoiViewGeneratorConfig.output_format">output_format</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The default format for saving output files (e.g., "csv", "geojson"). Defaults to "csv".</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/poi.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=nd>@dataclass</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=k>class</span> <span class=nc>PoiViewGeneratorConfig</span><span class=p>:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    Configuration for POI (Point of Interest) view generation.</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>        base_path (Path): The base directory where generated POI views will be saved.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>                          Defaults to a path retrieved from `config`.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>        output_format (str): The default format for saving output files (e.g., &quot;csv&quot;, &quot;geojson&quot;).</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>                             Defaults to &quot;csv&quot;.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;poi&quot;</span><span class=p>,</span> <span class=s2>&quot;views&quot;</span><span class=p>))</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>    <span class=n>output_format</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;csv&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h3 id=gigaspatial.generators.zonal class="doc doc-heading"> <code>zonal</code> <a href=#gigaspatial.generators.zonal class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-module"> <h4 id=gigaspatial.generators.zonal.base class="doc doc-heading"> <code>base</code> <a href=#gigaspatial.generators.zonal.base class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h5 id=gigaspatial.generators.zonal.base.ZonalViewGenerator class="doc doc-heading"> <code>ZonalViewGenerator</code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="gigaspatial.generators.zonal.base.T">T</span>]</code></p> <p>Base class for mapping data to zonal datasets.</p> <p>This class provides the framework for mapping various data sources (points, polygons, rasters) to zonal geometries like grid tiles or catchment areas. It serves as an abstract base class that must be subclassed to implement specific zonal systems.</p> <p>The class supports three main types of data mapping: - Point data aggregation to zones - Polygon data aggregation with optional area weighting - Raster data sampling and statistics</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.base.ZonalViewGenerator.data_store">data_store</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store for accessing input data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.base.ZonalViewGenerator.generator_config">generator_config</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for the generator.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.base.ZonalViewGenerator.logger">logger</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>Logger instance for this class.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=k>class</span> <span class=nc>ZonalViewGenerator</span><span class=p>(</span><span class=n>ABC</span><span class=p>,</span> <span class=n>Generic</span><span class=p>[</span><span class=n>T</span><span class=p>]):</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Base class for mapping data to zonal datasets.</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>    This class provides the framework for mapping various data sources (points, polygons, rasters)</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    to zonal geometries like grid tiles or catchment areas. It serves as an abstract base class</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    that must be subclassed to implement specific zonal systems.</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>    The class supports three main types of data mapping:</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    - Point data aggregation to zones</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    - Polygon data aggregation with optional area weighting</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    - Raster data sampling and statistics</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>        data_store (DataStore): The data store for accessing input data.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>        generator_config (ZonalViewGeneratorConfig): Configuration for the generator.</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>        logger: Logger instance for this class.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ZonalViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>    <span class=p>):</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize the ZonalViewGenerator.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        Args:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>            generator_config (ZonalViewGeneratorConfig, optional): Configuration for the generator.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>                If None, uses default configuration.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>            data_store (DataStore, optional): The data store for accessing input data.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>                If None, uses LocalDataStore.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>ZonalViewGeneratorConfig</span><span class=p>()</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=k>def</span> <span class=nf>get_zonal_geometries</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Polygon</span><span class=p>]:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the geometries of the zones.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>        This method must be implemented by subclasses to return the actual geometric</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        shapes of the zones (e.g., grid tiles, catchment boundaries, administrative areas).</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        Returns:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>            List[Polygon]: A list of Shapely Polygon objects representing zone geometries.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>pass</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=nd>@abstractmethod</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>    <span class=k>def</span> <span class=nf>get_zone_identifiers</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get unique identifiers for each zone.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>        This method must be implemented by subclasses to return identifiers that</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        correspond one-to-one with the geometries returned by get_zonal_geometries().</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>        Returns:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=sd>            List[T]: A list of zone identifiers (e.g., quadkeys, H3 indices, tile IDs).</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>                The type T is determined by the specific zonal system implementation.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>        <span class=k>pass</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Convert zones to a GeoDataFrame.</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>        Creates a GeoDataFrame containing zone identifiers and their corresponding</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>        geometries in WGS84 (EPSG:4326) coordinate reference system.</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>        Returns:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>            gpd.GeoDataFrame: A GeoDataFrame with &#39;zone_id&#39; and &#39;geometry&#39; columns,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>                where zone_id contains the identifiers and geometry contains the</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>                corresponding Polygon objects.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=p>{</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>                <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zone_identifiers</span><span class=p>(),</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>                <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zonal_geometries</span><span class=p>(),</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=p>},</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=p>)</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=nd>@property</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=k>def</span> <span class=nf>zone_gdf</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Cached GeoDataFrame of zones.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        Returns:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>            gpd.GeoDataFrame: Lazily-computed and cached GeoDataFrame of zone geometries</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>                and identifiers.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;_zone_gdf&quot;</span><span class=p>):</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>to_geodataframe</span><span class=p>()</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>    <span class=k>def</span> <span class=nf>map_points</span><span class=p>(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=n>points</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=n>value_columns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=n>aggregation</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=n>predicate</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>        <span class=n>output_suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map point data to zones with spatial aggregation.</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>        Aggregates point data to zones using spatial relationships. Points can be</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>        counted or have their attribute values aggregated using various statistical methods.</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>        Args:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>            points (Union[pd.DataFrame, gpd.GeoDataFrame]): The point data to map.</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>                Must contain geometry information if DataFrame.</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>            value_columns (Union[str, List[str]], optional): Column name(s) containing</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>                values to aggregate. If None, only point counts are performed.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>            aggregation (Union[str, Dict[str, str]]): Aggregation method(s) to use.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>                Can be a single string (&quot;count&quot;, &quot;mean&quot;, &quot;sum&quot;, &quot;min&quot;, &quot;max&quot;, etc.)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>                or a dictionary mapping column names to aggregation methods.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>            predicate (str): Spatial predicate for point-to-zone relationship.</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>                Options include &quot;within&quot;, &quot;intersects&quot;, &quot;contains&quot;. Defaults to &quot;within&quot;.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>            output_suffix (str): Suffix to add to output column names. Defaults to empty string.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>            mapping_function (Callable, optional): Custom function for mapping points to zones.</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>                If provided, signature should be mapping_function(self, points, **mapping_kwargs).</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>                When used, all other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>            **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>        Returns:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>            Dict: Dictionary with zone IDs as keys and aggregated values as values.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>                If value_columns is None, returns point counts per zone.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>                If value_columns is specified, returns aggregated values per zone.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>            <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=s2>&quot;Using default points mapping implementation. Consider creating a specialized mapping function.&quot;</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>            <span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_points_to_zones</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                <span class=n>points</span><span class=o>=</span><span class=n>points</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                <span class=n>zones</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                <span class=n>value_columns</span><span class=o>=</span><span class=n>value_columns</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                <span class=n>aggregation</span><span class=o>=</span><span class=n>aggregation</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>                <span class=n>point_zone_predicate</span><span class=o>=</span><span class=n>predicate</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>                <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>                <span class=n>output_suffix</span><span class=o>=</span><span class=n>output_suffix</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>value_columns</span><span class=p>:</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;point_count&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=n>value_columns</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=k>def</span> <span class=nf>map_polygons</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>        <span class=n>polygons</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>        <span class=n>value_columns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>        <span class=n>aggregation</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=n>area_weighted</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=n>area_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>        <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>        <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map polygon data to zones with optional area weighting.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>        Aggregates polygon data to zones based on spatial intersections. Values can be</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>        weighted by the fractional area of intersection between polygons and zones.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        Args:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>            polygons (Union[pd.DataFrame, gpd.GeoDataFrame]): The polygon data to map.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>                Must contain geometry information if DataFrame.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>            value_columns (Union[str, List[str]], optional): Column name(s) to aggregate.</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>                If None, only intersection areas will be calculated.</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>            aggregation (Union[str, Dict[str, str]]): Aggregation method(s) to use.</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>                Can be a single string (&quot;sum&quot;, &quot;mean&quot;, &quot;max&quot;, &quot;min&quot;) or a dictionary</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>                mapping column names to specific aggregation methods. Defaults to &quot;sum&quot;.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>            area_weighted (bool): Whether to weight values by fractional area of</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>                intersection. Defaults to False.</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>            area_column (str): Name of column to store calculated areas. Only used</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>                if area calculation is needed. Defaults to &quot;area_in_meters&quot;.</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>            mapping_function (Callable, optional): Custom function for mapping polygons</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>                to zones. If provided, signature should be mapping_function(self, polygons, **mapping_kwargs).</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><span class=sd>                When used, all other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>            **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>        Returns:</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>            Dict: Dictionary with zone IDs as keys and aggregated values as values.</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>                Returns aggregated values for the specified value_columns.</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>        Raises:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>            TypeError: If polygons cannot be converted to a GeoDataFrame.</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>        <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>polygons</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=k>if</span> <span class=n>area_column</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>polygons_gdf</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>polygons</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>                <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                    <span class=n>polygons_gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>polygons</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>                <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>                        <span class=s2>&quot;polygons must be a GeoDataFrame or convertible to one&quot;</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                    <span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>                <span class=n>polygons_gdf</span> <span class=o>=</span> <span class=n>polygons</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>            <span class=n>polygons_gdf</span><span class=p>[</span><span class=n>area_column</span><span class=p>]</span> <span class=o>=</span> <span class=n>polygons_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>                <span class=n>polygons_gdf</span><span class=o>.</span><span class=n>estimate_utm_crs</span><span class=p>()</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>            <span class=p>)</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>area</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=k>if</span> <span class=n>value_columns</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>                <span class=s2>&quot;Using default polygon mapping implementation. Consider providing value_columns.&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>            <span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=n>value_columns</span> <span class=o>=</span> <span class=n>area_column</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_polygons_to_zones</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>            <span class=n>polygons</span><span class=o>=</span><span class=n>polygons_gdf</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>            <span class=n>zones</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>            <span class=n>value_columns</span><span class=o>=</span><span class=n>value_columns</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>            <span class=n>aggregation</span><span class=o>=</span><span class=n>aggregation</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=n>area_weighted</span><span class=o>=</span><span class=n>area_weighted</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>        <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=n>value_columns</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>    <span class=k>def</span> <span class=nf>map_rasters</span><span class=p>(</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>tif_processors</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>],</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mean&quot;</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>]:</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map raster data to zones using zonal statistics.</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>        Samples raster values within each zone and computes statistics. Automatically</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><span class=sd>        handles coordinate reference system transformations between raster and zone data.</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>        Args:</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>            tif_processors (List[TifProcessor]): List of TifProcessor objects for</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=sd>                accessing raster data. All processors should have the same CRS.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=sd>            mapping_function (Callable, optional): Custom function for mapping rasters</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>                to zones. If provided, signature should be mapping_function(self, tif_processors, **mapping_kwargs).</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>                When used, stat and other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>            stat (str): Statistic to calculate when aggregating raster values within</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>                each zone. Options include &quot;mean&quot;, &quot;sum&quot;, &quot;min&quot;, &quot;max&quot;, &quot;std&quot;, etc.</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>                Defaults to &quot;mean&quot;.</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>            **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>        Returns:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>            Union[np.ndarray, Dict]: By default, returns a NumPy array of sampled values</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>                with shape (n_zones, n_rasters), taking the first non-nodata value encountered.</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>                Custom mapping functions may return different data structures.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>        Note:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>            If the coordinate reference system of the rasters differs from the zones,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>            the zone geometries will be automatically transformed to match the raster CRS.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>        <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>            <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tif_processors</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>            <span class=s2>&quot;Using default raster mapping implementation. Consider creating a specialized mapping function.&quot;</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>        <span class=p>)</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=n>raster_crs</span> <span class=o>=</span> <span class=n>tif_processors</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>crs</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=k>if</span> <span class=n>raster_crs</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>crs</span><span class=p>:</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Projecting zones to raster CRS: </span><span class=si>{</span><span class=n>raster_crs</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>            <span class=n>zone_geoms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_transformed_geometries</span><span class=p>(</span><span class=n>raster_crs</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>            <span class=n>zone_geoms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zonal_geometries</span><span class=p>()</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=c1># Sample raster values</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>        <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_polygons</span><span class=p>(</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=n>tif_processors</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span> <span class=n>polygon_list</span><span class=o>=</span><span class=n>zone_geoms</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>        <span class=p>)</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>        <span class=k>return</span> <span class=n>sampled_values</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>    <span class=nd>@lru_cache</span><span class=p>(</span><span class=n>maxsize</span><span class=o>=</span><span class=mi>32</span><span class=p>)</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>    <span class=k>def</span> <span class=nf>_get_transformed_geometries</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>target_crs</span><span class=p>):</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get zone geometries transformed to target coordinate reference system.</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>        This method is cached to avoid repeated coordinate transformations for</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>        the same target CRS.</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>        Args:</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>            target_crs: Target coordinate reference system for transformation.</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>        Returns:</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>            List[Polygon]: List of zone geometries transformed to the target CRS.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span><span class=n>target_crs</span><span class=p>)</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>    <span class=k>def</span> <span class=nf>save_view</span><span class=p>(</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>        <span class=n>view_data</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>        <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>        <span class=n>output_format</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Save the generated zonal view to disk.</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>        Args:</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>            view_data (gpd.GeoDataFrame): The zonal view data to save.</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>            name (str): Base name for the output file (without extension).</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>            output_format (str, optional): File format to save in (e.g., &quot;parquet&quot;,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>                &quot;geojson&quot;, &quot;shp&quot;). If None, uses the format specified in generator_config.</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><span class=sd>        Returns:</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=sd>            Path: The full path where the view was saved.</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><span class=sd>        Note:</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>            The output directory is determined by the generator_config.base_path setting.</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><span class=sd>            The file extension is automatically added based on the output format.</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=n>format_to_use</span> <span class=o>=</span> <span class=n>output_format</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_format</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>        <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>format_to_use</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving zonal view to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>        <span class=n>write_dataset</span><span class=p>(</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>            <span class=n>df</span><span class=o>=</span><span class=n>view_data</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>            <span class=n>path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>            <span class=nb>format</span><span class=o>=</span><span class=n>format_to_use</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>        <span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>        <span class=k>return</span> <span class=n>output_path</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.zone_gdf class="doc doc-heading"> <code class="highlight language-python"><span class=n>zone_gdf</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.zone_gdf class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Cached GeoDataFrame of zones.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Lazily-computed and cached GeoDataFrame of zone geometries and identifiers.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.__init__ class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Initialize the ZonalViewGenerator.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>generator_config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for the generator. If None, uses default configuration.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>The data store for accessing input data. If None, uses LocalDataStore.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ZonalViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=p>):</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the ZonalViewGenerator.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    Args:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        generator_config (ZonalViewGeneratorConfig, optional): Configuration for the generator.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>            If None, uses default configuration.</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        data_store (DataStore, optional): The data store for accessing input data.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>            If None, uses LocalDataStore.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span> <span class=ow>or</span> <span class=n>ZonalViewGeneratorConfig</span><span class=p>()</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span> <span class=o>=</span> <span class=n>data_store</span> <span class=ow>or</span> <span class=n>LocalDataStore</span><span class=p>()</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logger</span> <span class=ow>or</span> <span class=n>global_config</span><span class=o>.</span><span class=n>get_logger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.get_zonal_geometries class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_zonal_geometries</span><span class=p>()</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.get_zonal_geometries class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Get the geometries of the zones.</p> <p>This method must be implemented by subclasses to return the actual geometric shapes of the zones (e.g., grid tiles, catchment boundaries, administrative areas).</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="shapely.geometry.Polygon">Polygon</span>]</code> </td> <td> <div class=doc-md-description> <p>List[Polygon]: A list of Shapely Polygon objects representing zone geometries.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span>
<span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=k>def</span> <span class=nf>get_zonal_geometries</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Polygon</span><span class=p>]:</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the geometries of the zones.</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>    This method must be implemented by subclasses to return the actual geometric</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>    shapes of the zones (e.g., grid tiles, catchment boundaries, administrative areas).</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>    Returns:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>        List[Polygon]: A list of Shapely Polygon objects representing zone geometries.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.get_zone_identifiers class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_zone_identifiers</span><span class=p>()</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.get_zone_identifiers class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Get unique identifiers for each zone.</p> <p>This method must be implemented by subclasses to return identifiers that correspond one-to-one with the geometries returned by get_zonal_geometries().</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="gigaspatial.generators.zonal.base.T">T</span>]</code> </td> <td> <div class=doc-md-description> <p>List[T]: A list of zone identifiers (e.g., quadkeys, H3 indices, tile IDs). The type T is determined by the specific zonal system implementation.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=nd>@abstractmethod</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><span class=k>def</span> <span class=nf>get_zone_identifiers</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get unique identifiers for each zone.</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>    This method must be implemented by subclasses to return identifiers that</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>    correspond one-to-one with the geometries returned by get_zonal_geometries().</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>    Returns:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=sd>        List[T]: A list of zone identifiers (e.g., quadkeys, H3 indices, tile IDs).</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>            The type T is determined by the specific zonal system implementation.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>    <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.map_points class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_points</span><span class=p>(</span><span class=n>points</span><span class=p>,</span> <span class=n>value_columns</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>aggregation</span><span class=o>=</span><span class=s1>&#39;count&#39;</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s1>&#39;within&#39;</span><span class=p>,</span> <span class=n>output_suffix</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>mapping_function</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.map_points class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map point data to zones with spatial aggregation.</p> <p>Aggregates point data to zones using spatial relationships. Points can be counted or have their attribute values aggregated using various statistical methods.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>points</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>The point data to map. Must contain geometry information if DataFrame.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>value_columns</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]</code> </td> <td> <div class=doc-md-description> <p>Column name(s) containing values to aggregate. If None, only point counts are performed.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>aggregation</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.Dict">Dict</span>[str, str]]</code> </td> <td> <div class=doc-md-description> <p>Aggregation method(s) to use. Can be a single string ("count", "mean", "sum", "min", "max", etc.) or a dictionary mapping column names to aggregation methods.</p> </div> </td> <td> <code>&#39;count&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>predicate</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Spatial predicate for point-to-zone relationship. Options include "within", "intersects", "contains". Defaults to "within".</p> </div> </td> <td> <code>&#39;within&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>output_suffix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Suffix to add to output column names. Defaults to empty string.</p> </div> </td> <td> <code>&#39;&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>mapping_function</code></td> <td> <code><span title="typing.Callable">Callable</span></code> </td> <td> <div class=doc-md-description> <p>Custom function for mapping points to zones. If provided, signature should be mapping_function(self, points, **mapping_kwargs). When used, all other parameters except mapping_kwargs are ignored.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>**mapping_kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the mapping function.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Dict</code></td> <td> <code><span title="typing.Dict">Dict</span></code> </td> <td> <div class=doc-md-description> <p>Dictionary with zone IDs as keys and aggregated values as values. If value_columns is None, returns point counts per zone. If value_columns is specified, returns aggregated values per zone.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=k>def</span> <span class=nf>map_points</span><span class=p>(</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=n>points</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=n>value_columns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=n>aggregation</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=n>predicate</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=n>output_suffix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map point data to zones with spatial aggregation.</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>    Aggregates point data to zones using spatial relationships. Points can be</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>    counted or have their attribute values aggregated using various statistical methods.</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><span class=sd>    Args:</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>        points (Union[pd.DataFrame, gpd.GeoDataFrame]): The point data to map.</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>            Must contain geometry information if DataFrame.</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        value_columns (Union[str, List[str]], optional): Column name(s) containing</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>            values to aggregate. If None, only point counts are performed.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        aggregation (Union[str, Dict[str, str]]): Aggregation method(s) to use.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>            Can be a single string (&quot;count&quot;, &quot;mean&quot;, &quot;sum&quot;, &quot;min&quot;, &quot;max&quot;, etc.)</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>            or a dictionary mapping column names to aggregation methods.</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        predicate (str): Spatial predicate for point-to-zone relationship.</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>            Options include &quot;within&quot;, &quot;intersects&quot;, &quot;contains&quot;. Defaults to &quot;within&quot;.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>        output_suffix (str): Suffix to add to output column names. Defaults to empty string.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        mapping_function (Callable, optional): Custom function for mapping points to zones.</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>            If provided, signature should be mapping_function(self, points, **mapping_kwargs).</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>            When used, all other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    Returns:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>        Dict: Dictionary with zone IDs as keys and aggregated values as values.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>            If value_columns is None, returns point counts per zone.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>            If value_columns is specified, returns aggregated values per zone.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>    <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>points</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>            <span class=s2>&quot;Using default points mapping implementation. Consider creating a specialized mapping function.&quot;</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_points_to_zones</span><span class=p>(</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=n>points</span><span class=o>=</span><span class=n>points</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=n>zones</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=n>value_columns</span><span class=o>=</span><span class=n>value_columns</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>            <span class=n>aggregation</span><span class=o>=</span><span class=n>aggregation</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>            <span class=n>point_zone_predicate</span><span class=o>=</span><span class=n>predicate</span><span class=p>,</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>            <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>output_suffix</span><span class=o>=</span><span class=n>output_suffix</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>value_columns</span><span class=p>:</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>            <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;point_count&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=n>value_columns</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.map_polygons class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_polygons</span><span class=p>(</span><span class=n>polygons</span><span class=p>,</span> <span class=n>value_columns</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>aggregation</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>area_column</span><span class=o>=</span><span class=s1>&#39;area_in_meters&#39;</span><span class=p>,</span> <span class=n>mapping_function</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.map_polygons class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map polygon data to zones with optional area weighting.</p> <p>Aggregates polygon data to zones based on spatial intersections. Values can be weighted by the fractional area of intersection between polygons and zones.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>polygons</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>The polygon data to map. Must contain geometry information if DataFrame.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>value_columns</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]</code> </td> <td> <div class=doc-md-description> <p>Column name(s) to aggregate. If None, only intersection areas will be calculated.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>aggregation</code></td> <td> <code><span title="typing.Union">Union</span>[str, <span title="typing.Dict">Dict</span>[str, str]]</code> </td> <td> <div class=doc-md-description> <p>Aggregation method(s) to use. Can be a single string ("sum", "mean", "max", "min") or a dictionary mapping column names to specific aggregation methods. Defaults to "sum".</p> </div> </td> <td> <code>&#39;sum&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>area_weighted</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to weight values by fractional area of intersection. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>area_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of column to store calculated areas. Only used if area calculation is needed. Defaults to "area_in_meters".</p> </div> </td> <td> <code>&#39;area_in_meters&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>mapping_function</code></td> <td> <code><span title="typing.Callable">Callable</span></code> </td> <td> <div class=doc-md-description> <p>Custom function for mapping polygons to zones. If provided, signature should be mapping_function(self, polygons, **mapping_kwargs). When used, all other parameters except mapping_kwargs are ignored.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>**mapping_kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the mapping function.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Dict</code></td> <td> <code><span title="typing.Dict">Dict</span></code> </td> <td> <div class=doc-md-description> <p>Dictionary with zone IDs as keys and aggregated values as values. Returns aggregated values for the specified value_columns.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>TypeError</code> </td> <td> <div class=doc-md-description> <p>If polygons cannot be converted to a GeoDataFrame.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=k>def</span> <span class=nf>map_polygons</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=n>polygons</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>    <span class=n>value_columns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=n>aggregation</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=n>area_weighted</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>    <span class=n>area_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map polygon data to zones with optional area weighting.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>    Aggregates polygon data to zones based on spatial intersections. Values can be</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>    weighted by the fractional area of intersection between polygons and zones.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>    Args:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>        polygons (Union[pd.DataFrame, gpd.GeoDataFrame]): The polygon data to map.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>            Must contain geometry information if DataFrame.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>        value_columns (Union[str, List[str]], optional): Column name(s) to aggregate.</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>            If None, only intersection areas will be calculated.</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>        aggregation (Union[str, Dict[str, str]]): Aggregation method(s) to use.</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>            Can be a single string (&quot;sum&quot;, &quot;mean&quot;, &quot;max&quot;, &quot;min&quot;) or a dictionary</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>            mapping column names to specific aggregation methods. Defaults to &quot;sum&quot;.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>        area_weighted (bool): Whether to weight values by fractional area of</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>            intersection. Defaults to False.</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>        area_column (str): Name of column to store calculated areas. Only used</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>            if area calculation is needed. Defaults to &quot;area_in_meters&quot;.</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>        mapping_function (Callable, optional): Custom function for mapping polygons</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>            to zones. If provided, signature should be mapping_function(self, polygons, **mapping_kwargs).</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><span class=sd>            When used, all other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>        **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>    Returns:</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>        Dict: Dictionary with zone IDs as keys and aggregated values as values.</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>            Returns aggregated values for the specified value_columns.</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>    Raises:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>        TypeError: If polygons cannot be converted to a GeoDataFrame.</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>    <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>polygons</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=k>if</span> <span class=n>area_column</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>polygons_gdf</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>polygons</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=n>polygons_gdf</span> <span class=o>=</span> <span class=n>convert_to_geodataframe</span><span class=p>(</span><span class=n>polygons</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>                    <span class=s2>&quot;polygons must be a GeoDataFrame or convertible to one&quot;</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                <span class=p>)</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=n>polygons_gdf</span> <span class=o>=</span> <span class=n>polygons</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=n>polygons_gdf</span><span class=p>[</span><span class=n>area_column</span><span class=p>]</span> <span class=o>=</span> <span class=n>polygons_gdf</span><span class=o>.</span><span class=n>to_crs</span><span class=p>(</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>            <span class=n>polygons_gdf</span><span class=o>.</span><span class=n>estimate_utm_crs</span><span class=p>()</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>        <span class=p>)</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>area</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=k>if</span> <span class=n>value_columns</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>            <span class=s2>&quot;Using default polygon mapping implementation. Consider providing value_columns.&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=n>value_columns</span> <span class=o>=</span> <span class=n>area_column</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>aggregate_polygons_to_zones</span><span class=p>(</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=n>polygons</span><span class=o>=</span><span class=n>polygons_gdf</span><span class=p>,</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>zones</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=n>value_columns</span><span class=o>=</span><span class=n>value_columns</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=n>aggregation</span><span class=o>=</span><span class=n>aggregation</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=n>area_weighted</span><span class=o>=</span><span class=n>area_weighted</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>    <span class=k>return</span> <span class=n>result</span><span class=p>[</span><span class=n>value_columns</span><span class=p>]</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.map_rasters class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_rasters</span><span class=p>(</span><span class=n>tif_processors</span><span class=p>,</span> <span class=n>mapping_function</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.map_rasters class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map raster data to zones using zonal statistics.</p> <p>Samples raster values within each zone and computes statistics. Automatically handles coordinate reference system transformations between raster and zone data.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tif_processors</code></td> <td> <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="gigaspatial.processing.tif_processor.TifProcessor" href="../processing/#gigaspatial.processing.tif_processor.TifProcessor">TifProcessor</a>]</code> </td> <td> <div class=doc-md-description> <p>List of TifProcessor objects for accessing raster data. All processors should have the same CRS.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>mapping_function</code></td> <td> <code><span title="typing.Callable">Callable</span></code> </td> <td> <div class=doc-md-description> <p>Custom function for mapping rasters to zones. If provided, signature should be mapping_function(self, tif_processors, **mapping_kwargs). When used, stat and other parameters except mapping_kwargs are ignored.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>stat</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Statistic to calculate when aggregating raster values within each zone. Options include "mean", "sum", "min", "max", "std", etc. Defaults to "mean".</p> </div> </td> <td> <code>&#39;mean&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>**mapping_kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Additional keyword arguments passed to the mapping function.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.Dict">Dict</span>]</code> </td> <td> <div class=doc-md-description> <p>Union[np.ndarray, Dict]: By default, returns a NumPy array of sampled values with shape (n_zones, n_rasters), taking the first non-nodata value encountered. Custom mapping functions may return different data structures.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>If the coordinate reference system of the rasters differs from the zones, the zone geometries will be automatically transformed to match the raster CRS.</p> </details> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=k>def</span> <span class=nf>map_rasters</span><span class=p>(</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=n>tif_processors</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>TifProcessor</span><span class=p>],</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=n>mapping_function</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;mean&quot;</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>    <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>]:</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map raster data to zones using zonal statistics.</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>    Samples raster values within each zone and computes statistics. Automatically</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><span class=sd>    handles coordinate reference system transformations between raster and zone data.</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a><span class=sd>    Args:</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>        tif_processors (List[TifProcessor]): List of TifProcessor objects for</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=sd>            accessing raster data. All processors should have the same CRS.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=sd>        mapping_function (Callable, optional): Custom function for mapping rasters</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>            to zones. If provided, signature should be mapping_function(self, tif_processors, **mapping_kwargs).</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>            When used, stat and other parameters except mapping_kwargs are ignored.</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>        stat (str): Statistic to calculate when aggregating raster values within</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a><span class=sd>            each zone. Options include &quot;mean&quot;, &quot;sum&quot;, &quot;min&quot;, &quot;max&quot;, &quot;std&quot;, etc.</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>            Defaults to &quot;mean&quot;.</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>        **mapping_kwargs: Additional keyword arguments passed to the mapping function.</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>    Returns:</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>        Union[np.ndarray, Dict]: By default, returns a NumPy array of sampled values</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>            with shape (n_zones, n_rasters), taking the first non-nodata value encountered.</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>            Custom mapping functions may return different data structures.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>    Note:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>        If the coordinate reference system of the rasters differs from the zones,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>        the zone geometries will be automatically transformed to match the raster CRS.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>    <span class=k>if</span> <span class=n>mapping_function</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>        <span class=k>return</span> <span class=n>mapping_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tif_processors</span><span class=p>,</span> <span class=o>**</span><span class=n>mapping_kwargs</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>        <span class=s2>&quot;Using default raster mapping implementation. Consider creating a specialized mapping function.&quot;</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>    <span class=p>)</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>    <span class=n>raster_crs</span> <span class=o>=</span> <span class=n>tif_processors</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>crs</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>    <span class=k>if</span> <span class=n>raster_crs</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>crs</span><span class=p>:</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Projecting zones to raster CRS: </span><span class=si>{</span><span class=n>raster_crs</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=n>zone_geoms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_transformed_geometries</span><span class=p>(</span><span class=n>raster_crs</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=n>zone_geoms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zonal_geometries</span><span class=p>()</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=c1># Sample raster values</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=n>sampled_values</span> <span class=o>=</span> <span class=n>sample_multiple_tifs_by_polygons</span><span class=p>(</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=n>tif_processors</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span> <span class=n>polygon_list</span><span class=o>=</span><span class=n>zone_geoms</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>    <span class=p>)</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>    <span class=k>return</span> <span class=n>sampled_values</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.save_view class="doc doc-heading"> <code class="highlight language-python"><span class=n>save_view</span><span class=p>(</span><span class=n>view_data</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>output_format</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.save_view class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Save the generated zonal view to disk.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>view_data</code></td> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>The zonal view data to save.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>name</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Base name for the output file (without extension).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>output_format</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>File format to save in (e.g., "parquet", "geojson", "shp"). If None, uses the format specified in generator_config.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>Path</code></td> <td> <code><span title="pathlib.Path">Path</span></code> </td> <td> <div class=doc-md-description> <p>The full path where the view was saved.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>The output directory is determined by the generator_config.base_path setting. The file extension is automatically added based on the output format.</p> </details> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=k>def</span> <span class=nf>save_view</span><span class=p>(</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>    <span class=n>view_data</span><span class=p>:</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>    <span class=n>output_format</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Path</span><span class=p>:</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Save the generated zonal view to disk.</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a><span class=sd>    Args:</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>        view_data (gpd.GeoDataFrame): The zonal view data to save.</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>        name (str): Base name for the output file (without extension).</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>        output_format (str, optional): File format to save in (e.g., &quot;parquet&quot;,</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>            &quot;geojson&quot;, &quot;shp&quot;). If None, uses the format specified in generator_config.</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><span class=sd>    Returns:</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=sd>        Path: The full path where the view was saved.</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><span class=sd>    Note:</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>        The output directory is determined by the generator_config.base_path setting.</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><span class=sd>        The file extension is automatically added based on the output format.</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>    <span class=n>format_to_use</span> <span class=o>=</span> <span class=n>output_format</span> <span class=ow>or</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>output_format</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>    <span class=n>output_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>base_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>format_to_use</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saving zonal view to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>    <span class=n>write_dataset</span><span class=p>(</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>        <span class=n>df</span><span class=o>=</span><span class=n>view_data</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>        <span class=n>path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>),</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>        <span class=nb>format</span><span class=o>=</span><span class=n>format_to_use</span><span class=p>,</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>    <span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=k>return</span> <span class=n>output_path</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.base.ZonalViewGenerator.to_geodataframe class="doc doc-heading"> <code class="highlight language-python"><span class=n>to_geodataframe</span><span class=p>()</span></code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGenerator.to_geodataframe class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Convert zones to a GeoDataFrame.</p> <p>Creates a GeoDataFrame containing zone identifiers and their corresponding geometries in WGS84 (EPSG:4326) coordinate reference system.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: A GeoDataFrame with 'zone_id' and 'geometry' columns, where zone_id contains the identifiers and geometry contains the corresponding Polygon objects.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert zones to a GeoDataFrame.</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    Creates a GeoDataFrame containing zone identifiers and their corresponding</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><span class=sd>    geometries in WGS84 (EPSG:4326) coordinate reference system.</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>    Returns:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>        gpd.GeoDataFrame: A GeoDataFrame with &#39;zone_id&#39; and &#39;geometry&#39; columns,</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>            where zone_id contains the identifiers and geometry contains the</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=sd>            corresponding Polygon objects.</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=k>return</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=p>{</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zone_identifiers</span><span class=p>(),</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_zonal_geometries</span><span class=p>(),</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=p>},</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=n>crs</span><span class=o>=</span><span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h5 id=gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig class="doc doc-heading"> <code>ZonalViewGeneratorConfig</code> <a href=#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p> <p>Configuration for zonal view generation.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig.base_path">base_path</span></code></td> <td> <code><span title="pathlib.Path">Path</span></code> </td> <td> <div class=doc-md-description> <p>Base directory path for storing zonal views. Defaults to configured zonal views path.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig.output_format">output_format</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Default output format for saved views. Defaults to "parquet".</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/base.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=k>class</span> <span class=nc>ZonalViewGeneratorConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configuration for zonal view generation.</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>        base_path (Path): Base directory path for storing zonal views. Defaults to</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>            configured zonal views path.</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>        output_format (str): Default output format for saved views. Defaults to &quot;parquet&quot;.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>base_path</span><span class=p>:</span> <span class=n>Path</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>default</span><span class=o>=</span><span class=n>global_config</span><span class=o>.</span><span class=n>get_path</span><span class=p>(</span><span class=s2>&quot;zonal&quot;</span><span class=p>,</span> <span class=s2>&quot;views&quot;</span><span class=p>))</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=n>output_format</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;parquet&quot;</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>ensure_available</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 id=gigaspatial.generators.zonal.geometry class="doc doc-heading"> <code>geometry</code> <a href=#gigaspatial.generators.zonal.geometry class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h5 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator class="doc doc-heading"> <code>GeometryBasedZonalViewGenerator</code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGenerator" href="#gigaspatial.generators.zonal.base.ZonalViewGenerator">ZonalViewGenerator</a>[<span title="gigaspatial.generators.zonal.base.T">T</span>]</code></p> <p>Mid-level class for zonal view generation based on geometries with identifiers.</p> <p>This class serves as an intermediate between the abstract ZonalViewGenerator and specific implementations like MercatorViewGenerator or H3ViewGenerator. It handles the common case where zones are defined by a mapping between zone identifiers and geometries, either provided as a dictionary or as a GeoDataFrame.</p> <p>The class extends the base functionality with methods for mapping common geospatial datasets including GHSL (Global Human Settlement Layer), Google Open Buildings, and Microsoft Global Buildings data.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.zone_dict">zone_dict</span></code></td> <td> <code><span title="typing.Dict">Dict</span>[<span title="gigaspatial.generators.zonal.base.T">T</span>, <span title="shapely.geometry.Polygon">Polygon</span>]</code> </td> <td> <div class=doc-md-description> <p>Mapping of zone identifiers to geometries.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.zone_id_column">zone_id_column</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the column containing zone identifiers.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.zone_data_crs">zone_data_crs</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Coordinate reference system of the zone data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator._zone_gdf">_zone_gdf</span></code></td> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>Cached GeoDataFrame representation of zones.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.data_store">data_store</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>For accessing input data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.config">config</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for view generation.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.logger">logger</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Logger instance for this class.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=k>class</span> <span class=nc>GeometryBasedZonalViewGenerator</span><span class=p>(</span><span class=n>ZonalViewGenerator</span><span class=p>[</span><span class=n>T</span><span class=p>]):</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Mid-level class for zonal view generation based on geometries with identifiers.</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    This class serves as an intermediate between the abstract ZonalViewGenerator and specific</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>    implementations like MercatorViewGenerator or H3ViewGenerator. It handles the common case</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    where zones are defined by a mapping between zone identifiers and geometries, either</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>    provided as a dictionary or as a GeoDataFrame.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>    The class extends the base functionality with methods for mapping common geospatial</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>    datasets including GHSL (Global Human Settlement Layer), Google Open Buildings,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    and Microsoft Global Buildings data.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>        zone_dict (Dict[T, Polygon]): Mapping of zone identifiers to geometries.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>        zone_id_column (str): Name of the column containing zone identifiers.</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>        zone_data_crs (str): Coordinate reference system of the zone data.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>        _zone_gdf (gpd.GeoDataFrame): Cached GeoDataFrame representation of zones.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>        data_store (DataStore): For accessing input data.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>        config (ZonalViewGeneratorConfig): Configuration for view generation.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>        logger: Logger instance for this class.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=n>zone_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=n>T</span><span class=p>,</span> <span class=n>Polygon</span><span class=p>],</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=n>zone_id_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=n>zone_data_crs</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ZonalViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=p>):</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Initialize with zone geometries and identifiers.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>        Args:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>            zone_data (Union[Dict[T, Polygon], gpd.GeoDataFrame]): Zone definitions.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>                Either a dictionary mapping zone identifiers to Polygon/MultiPolygon geometries,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>                or a GeoDataFrame with geometries and a zone identifier column.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>            zone_id_column (str): Name of the column containing zone identifiers.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>                Only used if zone_data is a GeoDataFrame. Defaults to &quot;zone_id&quot;.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>            zone_data_crs (str): Coordinate reference system of the zone data.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>                Defaults to &quot;EPSG:4326&quot; (WGS84).</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>            config (ZonalViewGeneratorConfig, optional): Generator configuration.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>                If None, uses default configuration.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>            data_store (DataStore, optional): Data store for accessing input data.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>                If None, uses LocalDataStore.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>        Raises:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>            TypeError: If zone_data is not a dictionary or GeoDataFrame, or if dictionary</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>                values are not Polygon/MultiPolygon geometries.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>            ValueError: If zone_id_column is not found in GeoDataFrame, or if the provided</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>                CRS doesn&#39;t match the GeoDataFrame&#39;s CRS.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>=</span> <span class=n>zone_id_column</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_data_crs</span> <span class=o>=</span> <span class=n>zone_data_crs</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=c1># Store zone data based on input type</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>zone_data</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>            <span class=k>for</span> <span class=n>zone_id</span><span class=p>,</span> <span class=n>geom</span> <span class=ow>in</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>                <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geom</span><span class=p>,</span> <span class=p>(</span><span class=n>Polygon</span><span class=p>,</span> <span class=n>MultiPolygon</span><span class=p>)):</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                        <span class=sa>f</span><span class=s2>&quot;Zone </span><span class=si>{</span><span class=n>zone_id</span><span class=si>}</span><span class=s2>: Expected (Multi)Polygon, got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>geom</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>                    <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=c1># Store the original dictionary</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_dict</span> <span class=o>=</span> <span class=n>zone_data</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=c1># Also create a GeoDataFrame for consistent access</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>                <span class=p>{</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>                    <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>zone_data</span><span class=o>.</span><span class=n>keys</span><span class=p>()),</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>                    <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>zone_data</span><span class=o>.</span><span class=n>values</span><span class=p>()),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>                <span class=p>},</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>                <span class=n>crs</span><span class=o>=</span><span class=n>zone_data_crs</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>=</span> <span class=s2>&quot;zone_id&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>zone_data</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                    <span class=s2>&quot;zone_data must be either a Dict[T, Polygon] or a GeoDataFrame&quot;</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=k>if</span> <span class=n>zone_id_column</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>                    <span class=sa>f</span><span class=s2>&quot;Zone ID column &#39;</span><span class=si>{</span><span class=n>zone_id_column</span><span class=si>}</span><span class=s2>&#39; not found in GeoDataFrame&quot;</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>                <span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>            <span class=k>if</span> <span class=n>zone_data_crs</span> <span class=o>!=</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>crs</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                    <span class=sa>f</span><span class=s2>&quot;Provided data crs &#39;</span><span class=si>{</span><span class=n>zone_data_crs</span><span class=si>}</span><span class=s2>&#39; does not match to the crs of the data &#39;</span><span class=si>{</span><span class=n>zone_data</span><span class=o>.</span><span class=n>crs</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                <span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=c1># Store the GeoDataFrame</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span> <span class=o>=</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=n>zone_id_column</span><span class=p>:</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>})</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=c1># Also create a dictionary for fast lookups</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_dict</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>zone_data</span><span class=p>[</span><span class=n>zone_id_column</span><span class=p>],</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>geometry</span><span class=p>))</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>    <span class=k>def</span> <span class=nf>get_zonal_geometries</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Polygon</span><span class=p>]:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the geometry of each zone.</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>        Returns:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>            List[Polygon]: A list of zone geometries in the order they appear in the</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>                underlying GeoDataFrame.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>    <span class=k>def</span> <span class=nf>get_zone_identifiers</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get the identifier for each zone.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>        Returns:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>            List[T]: A list of zone identifiers in the order they appear in the</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>                underlying GeoDataFrame.</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Convert zones to a GeoDataFrame with standardized column names.</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>        Returns:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>            gpd.GeoDataFrame: A GeoDataFrame with &#39;zone_id&#39; and &#39;geometry&#39; columns.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>                The zone_id column is renamed from the original zone_id_column if different.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=c1># If we already have a GeoDataFrame, just rename the ID column if needed</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>!=</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span><span class=p>:</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>})</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>    <span class=k>def</span> <span class=nf>map_built_s</span><span class=p>(</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>        <span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>        <span class=n>name_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;built_surface_m2_&quot;</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map GHSL Built-up Surface data to zones.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        Convenience method for mapping Global Human Settlement Layer Built-up Surface</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        data using appropriate default parameters for built surface analysis.</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>        Args:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>            ghsl_data_config (GHSLDataConfig): Configuration for GHSL Built-up Surface data.</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>                Defaults to GHS_BUILT_S product for 2020 at 100m resolution.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>            stat (str): Statistic to calculate for built surface values within each zone.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>                Defaults to &quot;sum&quot; which gives total built surface area.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>            name_prefix (str): Prefix for the output column name. Defaults to &quot;built_surface_m2_&quot;.</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><span class=sd>        Returns:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=sd>            gpd.GeoDataFrame: Updated GeoDataFrame with zones and built surface metrics.</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><span class=sd>                Adds a column named &quot;{name_prefix}{stat}&quot; containing the aggregated values.</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>            <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=n>year</span><span class=o>=</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=n>resolution</span><span class=o>=</span><span class=n>resolution</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=p>)</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>handler</span><span class=o>=</span><span class=n>handler</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=n>name_prefix</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>    <span class=k>def</span> <span class=nf>map_smod</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>        <span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;median&quot;</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=n>name_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;smod_class_&quot;</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map GHSL Settlement Model data to zones.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>        Convenience method for mapping Global Human Settlement Layer Settlement Model</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>        data using appropriate default parameters for settlement classification analysis.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>        Args:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>            ghsl_data_config (GHSLDataConfig): Configuration for GHSL Settlement Model data.</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>                Defaults to GHS_SMOD product for 2020 at 1000m resolution in Mollweide projection.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>            stat (str): Statistic to calculate for settlement class values within each zone.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>                Defaults to &quot;median&quot; which gives the predominant settlement class.</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>            name_prefix (str): Prefix for the output column name. Defaults to &quot;smod_class_&quot;.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        Returns:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>            gpd.GeoDataFrame: Updated GeoDataFrame with zones and settlement classification.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>                Adds a column named &quot;{name_prefix}{stat}&quot; containing the aggregated values.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>            <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=n>year</span><span class=o>=</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>            <span class=n>resolution</span><span class=o>=</span><span class=n>resolution</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>            <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>            <span class=n>coord_system</span><span class=o>=</span><span class=mi>54009</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>            <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=p>)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=n>handler</span><span class=o>=</span><span class=n>handler</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=n>name_prefix</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=k>def</span> <span class=nf>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=n>handler</span><span class=p>:</span> <span class=n>GHSLDataHandler</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>        <span class=n>name_prefix</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map Global Human Settlement Layer data to zones.</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>        Loads and processes GHSL raster data for the intersecting tiles, then samples</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>        the raster values within each zone using the specified statistic.</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>        Args:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>            ghsl_data_config (GHSLDataConfig): Configuration specifying which GHSL</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>                product, year, resolution, and coordinate system to use.</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>            stat (str): Statistic to calculate for raster values within each zone.</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>                Common options: &quot;mean&quot;, &quot;sum&quot;, &quot;median&quot;, &quot;min&quot;, &quot;max&quot;.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>            name_prefix (str, optional): Prefix for the output column name.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>                If None, uses the GHSL product name in lowercase followed by underscore.</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>        Returns:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>            gpd.GeoDataFrame: Updated GeoDataFrame with zones and GHSL metrics.</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>                Adds a column named &quot;{name_prefix}{stat}&quot; containing the sampled values.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>        Note:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>            The method automatically determines which GHSL tiles intersect with the zones</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>            and loads only the necessary data for efficient processing.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GHSLDataHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=sa>f</span><span class=s2>&quot;Mapping </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> data (year: </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>, resolution: </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resolution</span><span class=si>}</span><span class=s2>m)&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>        <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>        <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=sa>f</span><span class=s2>&quot;Sampling </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> data using &#39;</span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2>&#39; statistic&quot;</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>        <span class=n>sampled_values</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_rasters</span><span class=p>(</span><span class=n>tif_processors</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>)</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=n>name_prefix</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>            <span class=n>name_prefix</span> <span class=k>if</span> <span class=n>name_prefix</span> <span class=k>else</span> <span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&quot;_&quot;</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>column_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name_prefix</span><span class=si>}{</span><span class=n>stat</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=n>column_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>sampled_values</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added </span><span class=si>{</span><span class=n>column_name</span><span class=si>}</span><span class=s2> column&quot;</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>    <span class=k>def</span> <span class=nf>map_google_buildings</span><span class=p>(</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>        <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>        <span class=n>use_polygons</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map Google Open Buildings data to zones.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>        Processes Google Open Buildings dataset to calculate building counts and total</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>        building area within each zone. Can use either point centroids (faster) or</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>        polygon geometries (more accurate) for spatial operations.</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>        Args:</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>            google_open_buildings_config (GoogleOpenBuildingsConfig): Configuration</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>                for accessing Google Open Buildings data. Uses default configuration if not provided.</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>            use_polygons (bool): Whether to use polygon geometries for buildings.</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>                If True, uses actual building polygons for more accurate area calculations</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>                but with slower performance. If False, uses building centroids with</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>                area values from attributes for faster processing. Defaults to False.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>        Returns:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>            gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics.</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>                Adds columns:</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>                - &#39;google_buildings_count&#39;: Number of buildings in each zone</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>                - &#39;google_buildings_area_in_meters&#39;: Total building area in square meters</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>        Note:</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>            If no Google Buildings data is found for the zones, returns the original</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>            GeoDataFrame unchanged with a warning logged.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>            <span class=sa>f</span><span class=s2>&quot;Mapping Google Open Buildings data (use_polygons=</span><span class=si>{</span><span class=n>use_polygons</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>        <span class=p>)</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Google Buildings point data&quot;</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=n>buildings_df</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_points</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>        <span class=k>if</span> <span class=n>buildings_df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No Google buildings data found for the provided zones&quot;</span><span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>use_polygons</span><span class=p>:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Aggregating building data using points with attributes&quot;</span><span class=p>)</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>                <span class=n>points</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>                <span class=n>value_columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>],</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>                <span class=n>aggregation</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>:</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>:</span> <span class=s2>&quot;sum&quot;</span><span class=p>},</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>                <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>            <span class=p>)</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>            <span class=n>count_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>]</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>            <span class=n>area_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;area_in_meters&quot;</span><span class=p>]</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>                <span class=s2>&quot;Loading Google Buildings polygon data for more accurate mapping&quot;</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>            <span class=p>)</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>            <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_polygons</span><span class=p>(</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>                <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>            <span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>                <span class=s2>&quot;Calculating building areas with area-weighted aggregation&quot;</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>            <span class=p>)</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>            <span class=n>area_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_polygons</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Counting buildings using points data&quot;</span><span class=p>)</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>            <span class=n>count_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span><span class=n>points</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>)</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;google_buildings_count&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>count_result</span><span class=p>)</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;google_buildings_area_in_meters&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>            <span class=n>area_result</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>        <span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added Google building data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=k>def</span> <span class=nf>map_ms_buildings</span><span class=p>(</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>        <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>        <span class=n>use_polygons</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Map Microsoft Global Buildings data to zones.</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><span class=sd>        Processes Microsoft Global Buildings dataset to calculate building counts and</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=sd>        total building area within each zone. Can use either centroid points (faster)</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><span class=sd>        or polygon geometries (more accurate) for spatial operations.</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><span class=sd>        Args:</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=sd>            ms_buildings_config (MSBuildingsConfig, optional): Configuration for</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><span class=sd>                accessing Microsoft Global Buildings data. If None, uses default configuration.</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=sd>            use_polygons (bool): Whether to use polygon geometries for buildings.</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=sd>                If True, uses actual building polygons for more accurate area calculations</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>                but with slower performance. If False, uses building centroids with</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><span class=sd>                area values from attributes for faster processing. Defaults to False.</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>        Returns:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>            gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics.</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>                Adds columns:</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><span class=sd>                - &#39;ms_buildings_count&#39;: Number of buildings in each zone</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><span class=sd>                - &#39;ms_buildings_area_in_meters&#39;: Total building area in square meters</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>        Note:</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><span class=sd>            If no Microsoft Buildings data is found for the zones, returns the original</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><span class=sd>            GeoDataFrame unchanged with a warning logged. Building areas are calculated</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=sd>            in meters using appropriate UTM projections.</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Microsoft Global Buildings data&quot;</span><span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Microsoft Buildings polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>        <span class=n>handler</span> <span class=o>=</span> <span class=n>MSBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>        <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>        <span class=p>)</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>        <span class=c1># Check if we found any buildings</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>        <span class=k>if</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>                <span class=s2>&quot;No Microsoft buildings data found for the provided zones&quot;</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>            <span class=p>)</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a>        <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>add_area_in_meters</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>        <span class=n>building_centroids</span> <span class=o>=</span> <span class=n>get_centroids</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>use_polygons</span><span class=p>:</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Aggregating building data using points with attributes&quot;</span><span class=p>)</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>                <span class=n>points</span><span class=o>=</span><span class=n>building_centroids</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>                <span class=n>value_columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>],</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>                <span class=n>aggregation</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>:</span> <span class=s2>&quot;sum&quot;</span><span class=p>},</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>                <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>            <span class=p>)</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>            <span class=n>count_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>]</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>            <span class=n>area_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;area_in_meters&quot;</span><span class=p>]</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>                <span class=s2>&quot;Calculating building areas with area-weighted aggregation&quot;</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>            <span class=p>)</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>            <span class=n>area_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_polygons</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Counting Microsoft buildings per zone&quot;</span><span class=p>)</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>            <span class=n>count_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>                <span class=n>points</span><span class=o>=</span><span class=n>building_centroids</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>            <span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;ms_buildings_count&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>count_result</span><span class=p>)</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;ms_buildings_area_in_meters&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>            <span class=n>area_result</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>        <span class=p>)</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added Microsoft building data&quot;</span><span class=p>)</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.__init__ class="doc doc-heading"> <code class="highlight language-python"><span class=fm>__init__</span><span class=p>(</span><span class=n>zone_data</span><span class=p>,</span> <span class=n>zone_id_column</span><span class=o>=</span><span class=s1>&#39;zone_id&#39;</span><span class=p>,</span> <span class=n>zone_data_crs</span><span class=o>=</span><span class=s1>&#39;EPSG:4326&#39;</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.__init__ class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Initialize with zone geometries and identifiers.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>zone_data</code></td> <td> <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[<span title="gigaspatial.generators.zonal.base.T">T</span>, <span title="shapely.geometry.Polygon">Polygon</span>], <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code> </td> <td> <div class=doc-md-description> <p>Zone definitions. Either a dictionary mapping zone identifiers to Polygon/MultiPolygon geometries, or a GeoDataFrame with geometries and a zone identifier column.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>zone_id_column</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the column containing zone identifiers. Only used if zone_data is a GeoDataFrame. Defaults to "zone_id".</p> </div> </td> <td> <code>&#39;zone_id&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>zone_data_crs</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Coordinate reference system of the zone data. Defaults to "EPSG:4326" (WGS84).</p> </div> </td> <td> <code>&#39;EPSG:4326&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>config</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Generator configuration. If None, uses default configuration.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>data_store</code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>Data store for accessing input data. If None, uses LocalDataStore.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>TypeError</code> </td> <td> <div class=doc-md-description> <p>If zone_data is not a dictionary or GeoDataFrame, or if dictionary values are not Polygon/MultiPolygon geometries.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If zone_id_column is not found in GeoDataFrame, or if the provided CRS doesn't match the GeoDataFrame's CRS.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>    <span class=n>zone_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=n>T</span><span class=p>,</span> <span class=n>Polygon</span><span class=p>],</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>],</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>    <span class=n>zone_id_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=n>zone_data_crs</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;EPSG:4326&quot;</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ZonalViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=p>):</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize with zone geometries and identifiers.</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>    Args:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>        zone_data (Union[Dict[T, Polygon], gpd.GeoDataFrame]): Zone definitions.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>            Either a dictionary mapping zone identifiers to Polygon/MultiPolygon geometries,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>            or a GeoDataFrame with geometries and a zone identifier column.</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        zone_id_column (str): Name of the column containing zone identifiers.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>            Only used if zone_data is a GeoDataFrame. Defaults to &quot;zone_id&quot;.</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        zone_data_crs (str): Coordinate reference system of the zone data.</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>            Defaults to &quot;EPSG:4326&quot; (WGS84).</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>        config (ZonalViewGeneratorConfig, optional): Generator configuration.</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>            If None, uses default configuration.</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        data_store (DataStore, optional): Data store for accessing input data.</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>            If None, uses LocalDataStore.</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>    Raises:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        TypeError: If zone_data is not a dictionary or GeoDataFrame, or if dictionary</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>            values are not Polygon/MultiPolygon geometries.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        ValueError: If zone_id_column is not found in GeoDataFrame, or if the provided</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>            CRS doesn&#39;t match the GeoDataFrame&#39;s CRS.</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span> <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>=</span> <span class=n>zone_id_column</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=bp>self</span><span class=o>.</span><span class=n>zone_data_crs</span> <span class=o>=</span> <span class=n>zone_data_crs</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=c1># Store zone data based on input type</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>zone_data</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=k>for</span> <span class=n>zone_id</span><span class=p>,</span> <span class=n>geom</span> <span class=ow>in</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geom</span><span class=p>,</span> <span class=p>(</span><span class=n>Polygon</span><span class=p>,</span> <span class=n>MultiPolygon</span><span class=p>)):</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                    <span class=sa>f</span><span class=s2>&quot;Zone </span><span class=si>{</span><span class=n>zone_id</span><span class=si>}</span><span class=s2>: Expected (Multi)Polygon, got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>geom</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>                <span class=p>)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>        <span class=c1># Store the original dictionary</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_dict</span> <span class=o>=</span> <span class=n>zone_data</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>        <span class=c1># Also create a GeoDataFrame for consistent access</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span> <span class=o>=</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=p>{</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>                <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>zone_data</span><span class=o>.</span><span class=n>keys</span><span class=p>()),</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>                <span class=s2>&quot;geometry&quot;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>zone_data</span><span class=o>.</span><span class=n>values</span><span class=p>()),</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=p>},</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=n>crs</span><span class=o>=</span><span class=n>zone_data_crs</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>=</span> <span class=s2>&quot;zone_id&quot;</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>zone_data</span><span class=p>,</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>):</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                <span class=s2>&quot;zone_data must be either a Dict[T, Polygon] or a GeoDataFrame&quot;</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>        <span class=k>if</span> <span class=n>zone_id_column</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>                <span class=sa>f</span><span class=s2>&quot;Zone ID column &#39;</span><span class=si>{</span><span class=n>zone_id_column</span><span class=si>}</span><span class=s2>&#39; not found in GeoDataFrame&quot;</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=p>)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=k>if</span> <span class=n>zone_data_crs</span> <span class=o>!=</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>crs</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                <span class=sa>f</span><span class=s2>&quot;Provided data crs &#39;</span><span class=si>{</span><span class=n>zone_data_crs</span><span class=si>}</span><span class=s2>&#39; does not match to the crs of the data &#39;</span><span class=si>{</span><span class=n>zone_data</span><span class=o>.</span><span class=n>crs</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>            <span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=c1># Store the GeoDataFrame</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span> <span class=o>=</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=n>zone_id_column</span><span class=p>:</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>})</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>        <span class=c1># Also create a dictionary for fast lookups</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_dict</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>zone_data</span><span class=p>[</span><span class=n>zone_id_column</span><span class=p>],</span> <span class=n>zone_data</span><span class=o>.</span><span class=n>geometry</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.get_zonal_geometries class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_zonal_geometries</span><span class=p>()</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.get_zonal_geometries class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Get the geometry of each zone.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="shapely.geometry.Polygon">Polygon</span>]</code> </td> <td> <div class=doc-md-description> <p>List[Polygon]: A list of zone geometries in the order they appear in the underlying GeoDataFrame.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=k>def</span> <span class=nf>get_zonal_geometries</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Polygon</span><span class=p>]:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the geometry of each zone.</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    Returns:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>        List[Polygon]: A list of zone geometries in the order they appear in the</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>            underlying GeoDataFrame.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>geometry</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.get_zone_identifiers class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_zone_identifiers</span><span class=p>()</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.get_zone_identifiers class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Get the identifier for each zone.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="typing.List">List</span>[<span title="gigaspatial.generators.zonal.base.T">T</span>]</code> </td> <td> <div class=doc-md-description> <p>List[T]: A list of zone identifiers in the order they appear in the underlying GeoDataFrame.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=k>def</span> <span class=nf>get_zone_identifiers</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the identifier for each zone.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>    Returns:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        List[T]: A list of zone identifiers in the order they appear in the</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>            underlying GeoDataFrame.</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_built_s class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_built_s</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span> <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=s1>&#39;built_surface_m2_&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_built_s class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map GHSL Built-up Surface data to zones.</p> <p>Convenience method for mapping Global Human Settlement Layer Built-up Surface data using appropriate default parameters for built surface analysis.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ghsl_data_config</code></td> <td> <code>GHSLDataConfig</code> </td> <td> <div class=doc-md-description> <p>Configuration for GHSL Built-up Surface data. Defaults to GHS_BUILT_S product for 2020 at 100m resolution.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>stat</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Statistic to calculate for built surface values within each zone. Defaults to "sum" which gives total built surface area.</p> </div> </td> <td> <code>&#39;sum&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>name_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for the output column name. Defaults to "built_surface_m2_".</p> </div> </td> <td> <code>&#39;built_surface_m2_&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Updated GeoDataFrame with zones and built surface metrics. Adds a column named "{name_prefix}{stat}" containing the aggregated values.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=k>def</span> <span class=nf>map_built_s</span><span class=p>(</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>    <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;sum&quot;</span><span class=p>,</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>    <span class=n>name_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;built_surface_m2_&quot;</span><span class=p>,</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map GHSL Built-up Surface data to zones.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>    Convenience method for mapping Global Human Settlement Layer Built-up Surface</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>    data using appropriate default parameters for built surface analysis.</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>    Args:</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>        ghsl_data_config (GHSLDataConfig): Configuration for GHSL Built-up Surface data.</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>            Defaults to GHS_BUILT_S product for 2020 at 100m resolution.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>        stat (str): Statistic to calculate for built surface values within each zone.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>            Defaults to &quot;sum&quot; which gives total built surface area.</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=sd>        name_prefix (str): Prefix for the output column name. Defaults to &quot;built_surface_m2_&quot;.</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><span class=sd>    Returns:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=sd>        gpd.GeoDataFrame: Updated GeoDataFrame with zones and built surface metrics.</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><span class=sd>            Adds a column named &quot;{name_prefix}{stat}&quot; containing the aggregated values.</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_BUILT_S&quot;</span><span class=p>,</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>year</span><span class=o>=</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=n>resolution</span><span class=o>=</span><span class=n>resolution</span><span class=p>,</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=p>)</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>        <span class=n>handler</span><span class=o>=</span><span class=n>handler</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=n>name_prefix</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_ghsl class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_ghsl</span><span class=p>(</span><span class=n>handler</span><span class=p>,</span> <span class=n>stat</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_ghsl class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map Global Human Settlement Layer data to zones.</p> <p>Loads and processes GHSL raster data for the intersecting tiles, then samples the raster values within each zone using the specified statistic.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ghsl_data_config</code></td> <td> <code>GHSLDataConfig</code> </td> <td> <div class=doc-md-description> <p>Configuration specifying which GHSL product, year, resolution, and coordinate system to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>stat</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Statistic to calculate for raster values within each zone. Common options: "mean", "sum", "median", "min", "max".</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>name_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for the output column name. If None, uses the GHSL product name in lowercase followed by underscore.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Updated GeoDataFrame with zones and GHSL metrics. Adds a column named "{name_prefix}{stat}" containing the sampled values.</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>The method automatically determines which GHSL tiles intersect with the zones and loads only the necessary data for efficient processing.</p> </details> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=k>def</span> <span class=nf>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>    <span class=n>handler</span><span class=p>:</span> <span class=n>GHSLDataHandler</span><span class=p>,</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>    <span class=n>name_prefix</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map Global Human Settlement Layer data to zones.</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a><span class=sd>    Loads and processes GHSL raster data for the intersecting tiles, then samples</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>    the raster values within each zone using the specified statistic.</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>    Args:</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>        ghsl_data_config (GHSLDataConfig): Configuration specifying which GHSL</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>            product, year, resolution, and coordinate system to use.</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>        stat (str): Statistic to calculate for raster values within each zone.</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>            Common options: &quot;mean&quot;, &quot;sum&quot;, &quot;median&quot;, &quot;min&quot;, &quot;max&quot;.</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        name_prefix (str, optional): Prefix for the output column name.</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>            If None, uses the GHSL product name in lowercase followed by underscore.</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>    Returns:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>        gpd.GeoDataFrame: Updated GeoDataFrame with zones and GHSL metrics.</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>            Adds a column named &quot;{name_prefix}{stat}&quot; containing the sampled values.</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a><span class=sd>    Note:</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a><span class=sd>        The method automatically determines which GHSL tiles intersect with the zones</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=sd>        and loads only the necessary data for efficient processing.</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GHSLDataHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>        <span class=sa>f</span><span class=s2>&quot;Mapping </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> data (year: </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>, resolution: </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>resolution</span><span class=si>}</span><span class=s2>m)&quot;</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=n>tif_processors</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=p>)</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>        <span class=sa>f</span><span class=s2>&quot;Sampling </span><span class=si>{</span><span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=si>}</span><span class=s2> data using &#39;</span><span class=si>{</span><span class=n>stat</span><span class=si>}</span><span class=s2>&#39; statistic&quot;</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>    <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>    <span class=n>sampled_values</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_rasters</span><span class=p>(</span><span class=n>tif_processors</span><span class=o>=</span><span class=n>tif_processors</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>)</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>    <span class=n>name_prefix</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=n>name_prefix</span> <span class=k>if</span> <span class=n>name_prefix</span> <span class=k>else</span> <span class=n>handler</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>product</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&quot;_&quot;</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>    <span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>    <span class=n>column_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name_prefix</span><span class=si>}{</span><span class=n>stat</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=n>column_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>sampled_values</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added </span><span class=si>{</span><span class=n>column_name</span><span class=si>}</span><span class=s2> column&quot;</span><span class=p>)</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_google_buildings class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_google_buildings</span><span class=p>(</span><span class=n>handler</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>use_polygons</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_google_buildings class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map Google Open Buildings data to zones.</p> <p>Processes Google Open Buildings dataset to calculate building counts and total building area within each zone. Can use either point centroids (faster) or polygon geometries (more accurate) for spatial operations.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>google_open_buildings_config</code></td> <td> <code>GoogleOpenBuildingsConfig</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing Google Open Buildings data. Uses default configuration if not provided.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>use_polygons</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to use polygon geometries for buildings. If True, uses actual building polygons for more accurate area calculations but with slower performance. If False, uses building centroids with area values from attributes for faster processing. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics. Adds columns: - 'google_buildings_count': Number of buildings in each zone - 'google_buildings_area_in_meters': Total building area in square meters</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>If no Google Buildings data is found for the zones, returns the original GeoDataFrame unchanged with a warning logged.</p> </details> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=k>def</span> <span class=nf>map_google_buildings</span><span class=p>(</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>    <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>GoogleOpenBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=n>use_polygons</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map Google Open Buildings data to zones.</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a><span class=sd>    Processes Google Open Buildings dataset to calculate building counts and total</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a><span class=sd>    building area within each zone. Can use either point centroids (faster) or</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a><span class=sd>    polygon geometries (more accurate) for spatial operations.</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a><span class=sd>    Args:</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a><span class=sd>        google_open_buildings_config (GoogleOpenBuildingsConfig): Configuration</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a><span class=sd>            for accessing Google Open Buildings data. Uses default configuration if not provided.</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a><span class=sd>        use_polygons (bool): Whether to use polygon geometries for buildings.</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a><span class=sd>            If True, uses actual building polygons for more accurate area calculations</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a><span class=sd>            but with slower performance. If False, uses building centroids with</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=sd>            area values from attributes for faster processing. Defaults to False.</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a><span class=sd>    Returns:</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>        gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics.</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>            Adds columns:</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a><span class=sd>            - &#39;google_buildings_count&#39;: Number of buildings in each zone</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>            - &#39;google_buildings_area_in_meters&#39;: Total building area in square meters</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=sd>    Note:</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>        If no Google Buildings data is found for the zones, returns the original</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>        GeoDataFrame unchanged with a warning logged.</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=sa>f</span><span class=s2>&quot;Mapping Google Open Buildings data (use_polygons=</span><span class=si>{</span><span class=n>use_polygons</span><span class=si>}</span><span class=s2>)&quot;</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>    <span class=p>)</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Google Buildings point data&quot;</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>handler</span> <span class=ow>or</span> <span class=n>GoogleOpenBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=n>buildings_df</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_points</span><span class=p>(</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>    <span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=k>if</span> <span class=n>buildings_df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No Google buildings data found for the provided zones&quot;</span><span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>use_polygons</span><span class=p>:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Aggregating building data using points with attributes&quot;</span><span class=p>)</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>            <span class=n>points</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>            <span class=n>value_columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>],</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>            <span class=n>aggregation</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>:</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>:</span> <span class=s2>&quot;sum&quot;</span><span class=p>},</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>            <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>        <span class=p>)</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>        <span class=n>count_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;full_plus_code&quot;</span><span class=p>]</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>        <span class=n>area_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;area_in_meters&quot;</span><span class=p>]</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>            <span class=s2>&quot;Loading Google Buildings polygon data for more accurate mapping&quot;</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>        <span class=p>)</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>        <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_polygons</span><span class=p>(</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>            <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>        <span class=p>)</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>            <span class=s2>&quot;Calculating building areas with area-weighted aggregation&quot;</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>        <span class=p>)</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>        <span class=n>area_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_polygons</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Counting buildings using points data&quot;</span><span class=p>)</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>        <span class=n>count_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span><span class=n>points</span><span class=o>=</span><span class=n>buildings_df</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>)</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;google_buildings_count&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>count_result</span><span class=p>)</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;google_buildings_area_in_meters&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>        <span class=n>area_result</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added Google building data&quot;</span><span class=p>)</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_ms_buildings class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_ms_buildings</span><span class=p>(</span><span class=n>handler</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>use_polygons</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_ms_buildings class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map Microsoft Global Buildings data to zones.</p> <p>Processes Microsoft Global Buildings dataset to calculate building counts and total building area within each zone. Can use either centroid points (faster) or polygon geometries (more accurate) for spatial operations.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ms_buildings_config</code></td> <td> <code>MSBuildingsConfig</code> </td> <td> <div class=doc-md-description> <p>Configuration for accessing Microsoft Global Buildings data. If None, uses default configuration.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>use_polygons</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to use polygon geometries for buildings. If True, uses actual building polygons for more accurate area calculations but with slower performance. If False, uses building centroids with area values from attributes for faster processing. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics. Adds columns: - 'ms_buildings_count': Number of buildings in each zone - 'ms_buildings_area_in_meters': Total building area in square meters</p> </div> </td> </tr> </tbody> </table> <details class=note open> <summary>Note</summary> <p>If no Microsoft Buildings data is found for the zones, returns the original GeoDataFrame unchanged with a warning logged. Building areas are calculated in meters using appropriate UTM projections.</p> </details> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=k>def</span> <span class=nf>map_ms_buildings</span><span class=p>(</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>    <span class=n>handler</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MSBuildingsHandler</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>    <span class=n>use_polygons</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map Microsoft Global Buildings data to zones.</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a><span class=sd>    Processes Microsoft Global Buildings dataset to calculate building counts and</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=sd>    total building area within each zone. Can use either centroid points (faster)</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><span class=sd>    or polygon geometries (more accurate) for spatial operations.</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a><span class=sd>    Args:</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=sd>        ms_buildings_config (MSBuildingsConfig, optional): Configuration for</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><span class=sd>            accessing Microsoft Global Buildings data. If None, uses default configuration.</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=sd>        use_polygons (bool): Whether to use polygon geometries for buildings.</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a><span class=sd>            If True, uses actual building polygons for more accurate area calculations</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a><span class=sd>            but with slower performance. If False, uses building centroids with</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a><span class=sd>            area values from attributes for faster processing. Defaults to False.</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a><span class=sd>    Returns:</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a><span class=sd>        gpd.GeoDataFrame: Updated GeoDataFrame with zones and building metrics.</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a><span class=sd>            Adds columns:</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a><span class=sd>            - &#39;ms_buildings_count&#39;: Number of buildings in each zone</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><span class=sd>            - &#39;ms_buildings_area_in_meters&#39;: Total building area in square meters</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a><span class=sd>    Note:</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><span class=sd>        If no Microsoft Buildings data is found for the zones, returns the original</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><span class=sd>        GeoDataFrame unchanged with a warning logged. Building areas are calculated</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a><span class=sd>        in meters using appropriate UTM projections.</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Mapping Microsoft Global Buildings data&quot;</span><span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Loading Microsoft Buildings polygon data&quot;</span><span class=p>)</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>MSBuildingsHandler</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>    <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>handler</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>        <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=p>,</span> <span class=n>ensure_available</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ensure_available</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>    <span class=p>)</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>    <span class=c1># Check if we found any buildings</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>    <span class=k>if</span> <span class=n>buildings_gdf</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>            <span class=s2>&quot;No Microsoft buildings data found for the provided zones&quot;</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>        <span class=p>)</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a>    <span class=n>buildings_gdf</span> <span class=o>=</span> <span class=n>add_area_in_meters</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>    <span class=n>building_centroids</span> <span class=o>=</span> <span class=n>get_centroids</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>)</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>use_polygons</span><span class=p>:</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Aggregating building data using points with attributes&quot;</span><span class=p>)</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>            <span class=n>points</span><span class=o>=</span><span class=n>building_centroids</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>            <span class=n>value_columns</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>],</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>            <span class=n>aggregation</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;count&quot;</span><span class=p>,</span> <span class=s2>&quot;area_in_meters&quot;</span><span class=p>:</span> <span class=s2>&quot;sum&quot;</span><span class=p>},</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>            <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=p>)</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=n>count_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;type&quot;</span><span class=p>]</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=n>area_result</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&quot;area_in_meters&quot;</span><span class=p>]</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>            <span class=s2>&quot;Calculating building areas with area-weighted aggregation&quot;</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>        <span class=p>)</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>        <span class=n>area_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_polygons</span><span class=p>(</span><span class=n>buildings_gdf</span><span class=p>,</span> <span class=n>area_weighted</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Counting Microsoft buildings per zone&quot;</span><span class=p>)</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>        <span class=n>count_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_points</span><span class=p>(</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>            <span class=n>points</span><span class=o>=</span><span class=n>building_centroids</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;within&quot;</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>        <span class=p>)</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;ms_buildings_count&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>count_result</span><span class=p>)</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=p>[</span><span class=s2>&quot;ms_buildings_area_in_meters&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_gdf</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>        <span class=n>area_result</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>    <span class=p>)</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Added Microsoft building data&quot;</span><span class=p>)</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_smod class="doc doc-heading"> <code class="highlight language-python"><span class=n>map_smod</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span> <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=s1>&#39;smod_class_&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.map_smod class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Map GHSL Settlement Model data to zones.</p> <p>Convenience method for mapping Global Human Settlement Layer Settlement Model data using appropriate default parameters for settlement classification analysis.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ghsl_data_config</code></td> <td> <code>GHSLDataConfig</code> </td> <td> <div class=doc-md-description> <p>Configuration for GHSL Settlement Model data. Defaults to GHS_SMOD product for 2020 at 1000m resolution in Mollweide projection.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>stat</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Statistic to calculate for settlement class values within each zone. Defaults to "median" which gives the predominant settlement class.</p> </div> </td> <td> <code>&#39;median&#39;</code> </td> </tr> <tr class=doc-section-item> <td><code>name_prefix</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Prefix for the output column name. Defaults to "smod_class_".</p> </div> </td> <td> <code>&#39;smod_class_&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: Updated GeoDataFrame with zones and settlement classification. Adds a column named "{name_prefix}{stat}" containing the aggregated values.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=k>def</span> <span class=nf>map_smod</span><span class=p>(</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>    <span class=n>year</span><span class=o>=</span><span class=mi>2020</span><span class=p>,</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>    <span class=n>resolution</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>    <span class=n>stat</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;median&quot;</span><span class=p>,</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>    <span class=n>name_prefix</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;smod_class_&quot;</span><span class=p>,</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map GHSL Settlement Model data to zones.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>    Convenience method for mapping Global Human Settlement Layer Settlement Model</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>    data using appropriate default parameters for settlement classification analysis.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>    Args:</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>        ghsl_data_config (GHSLDataConfig): Configuration for GHSL Settlement Model data.</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>            Defaults to GHS_SMOD product for 2020 at 1000m resolution in Mollweide projection.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>        stat (str): Statistic to calculate for settlement class values within each zone.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>            Defaults to &quot;median&quot; which gives the predominant settlement class.</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>        name_prefix (str): Prefix for the output column name. Defaults to &quot;smod_class_&quot;.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>    Returns:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>        gpd.GeoDataFrame: Updated GeoDataFrame with zones and settlement classification.</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>            Adds a column named &quot;{name_prefix}{stat}&quot; containing the aggregated values.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=n>handler</span> <span class=o>=</span> <span class=n>GHSLDataHandler</span><span class=p>(</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=n>product</span><span class=o>=</span><span class=s2>&quot;GHS_SMOD&quot;</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>        <span class=n>year</span><span class=o>=</span><span class=n>year</span><span class=p>,</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=n>resolution</span><span class=o>=</span><span class=n>resolution</span><span class=p>,</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>        <span class=n>data_store</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=n>coord_system</span><span class=o>=</span><span class=mi>54009</span><span class=p>,</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>    <span class=p>)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>map_ghsl</span><span class=p>(</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>        <span class=n>handler</span><span class=o>=</span><span class=n>handler</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=n>stat</span><span class=p>,</span> <span class=n>name_prefix</span><span class=o>=</span><span class=n>name_prefix</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h6 id=gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.to_geodataframe class="doc doc-heading"> <code class="highlight language-python"><span class=n>to_geodataframe</span><span class=p>()</span></code> <a href=#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator.to_geodataframe class=headerlink title="Permanent link">&para;</a></h6> <div class="doc doc-contents "> <p>Convert zones to a GeoDataFrame with standardized column names.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>gpd.GeoDataFrame: A GeoDataFrame with 'zone_id' and 'geometry' columns. The zone_id column is renamed from the original zone_id_column if different.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/geometry.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=k>def</span> <span class=nf>to_geodataframe</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert zones to a GeoDataFrame with standardized column names.</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>    Returns:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>        gpd.GeoDataFrame: A GeoDataFrame with &#39;zone_id&#39; and &#39;geometry&#39; columns.</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>            The zone_id column is renamed from the original zone_id_column if different.</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>    <span class=c1># If we already have a GeoDataFrame, just rename the ID column if needed</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_zone_gdf</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span> <span class=o>!=</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>:</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=bp>self</span><span class=o>.</span><span class=n>zone_id_column</span><span class=p>:</span> <span class=s2>&quot;zone_id&quot;</span><span class=p>})</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h4 id=gigaspatial.generators.zonal.mercator class="doc doc-heading"> <code>mercator</code> <a href=#gigaspatial.generators.zonal.mercator class=headerlink title="Permanent link">&para;</a></h4> <div class="doc doc-contents "> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h5 id=gigaspatial.generators.zonal.mercator.MercatorViewGenerator class="doc doc-heading"> <code>MercatorViewGenerator</code> <a href=#gigaspatial.generators.zonal.mercator.MercatorViewGenerator class=headerlink title="Permanent link">&para;</a></h5> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator" href="#gigaspatial.generators.zonal.geometry.GeometryBasedZonalViewGenerator">GeometryBasedZonalViewGenerator</a>[<span title="gigaspatial.generators.zonal.base.T">T</span>]</code></p> <p>Mid-level class for zonal view generation based on geometries with identifiers.</p> <p>This class serves as an intermediate between the abstract ZonalViewGenerator and specific implementations like MercatorViewGenerator or H3ViewGenerator. It handles the common case where zones are defined by a mapping between zone identifiers and geometries, either provided as a dictionary or as a GeoDataFrame.</p> <p>The class extends the base functionality with methods for mapping common geospatial datasets including GHSL (Global Human Settlement Layer), Google Open Buildings, and Microsoft Global Buildings data.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.zone_dict">zone_dict</span></code></td> <td> <code>Dict[<span title="gigaspatial.generators.zonal.base.T">T</span>, Polygon]</code> </td> <td> <div class=doc-md-description> <p>Mapping of zone identifiers to geometries.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.zone_id_column">zone_id_column</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Name of the column containing zone identifiers.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.zone_data_crs">zone_data_crs</span></code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>Coordinate reference system of the zone data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator._zone_gdf">_zone_gdf</span></code></td> <td> <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code> </td> <td> <div class=doc-md-description> <p>Cached GeoDataFrame representation of zones.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.data_store">data_store</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.core.io.data_store.DataStore" href="../core/#gigaspatial.core.io.data_store.DataStore">DataStore</a></code> </td> <td> <div class=doc-md-description> <p>For accessing input data.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.generator_config">generator_config</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for view generation.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="gigaspatial.generators.zonal.mercator.MercatorViewGenerator.logger">logger</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig" href="#gigaspatial.generators.zonal.base.ZonalViewGeneratorConfig">ZonalViewGeneratorConfig</a></code> </td> <td> <div class=doc-md-description> <p>Logger instance for this class.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>gigaspatial/generators/zonal/mercator.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=k>class</span> <span class=nc>MercatorViewGenerator</span><span class=p>(</span><span class=n>GeometryBasedZonalViewGenerator</span><span class=p>[</span><span class=n>T</span><span class=p>]):</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Mid-level class for zonal view generation based on geometries with identifiers.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>    This class serves as an intermediate between the abstract ZonalViewGenerator and specific</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    implementations like MercatorViewGenerator or H3ViewGenerator. It handles the common case</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>    where zones are defined by a mapping between zone identifiers and geometries, either</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>    provided as a dictionary or as a GeoDataFrame.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    The class extends the base functionality with methods for mapping common geospatial</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>    datasets including GHSL (Global Human Settlement Layer), Google Open Buildings,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>    and Microsoft Global Buildings data.</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>        zone_dict (Dict[T, Polygon]): Mapping of zone identifiers to geometries.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>        zone_id_column (str): Name of the column containing zone identifiers.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>        zone_data_crs (str): Coordinate reference system of the zone data.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>        _zone_gdf (gpd.GeoDataFrame): Cached GeoDataFrame representation of zones.</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>        data_store (DataStore): For accessing input data.</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>        generator_config (ZonalViewGeneratorConfig): Configuration for view generation.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>        logger: Logger instance for this class.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=n>source</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>            <span class=nb>str</span><span class=p>,</span>  <span class=c1># country</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=n>BaseGeometry</span><span class=p>,</span>  <span class=c1># shapely geom</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=n>gpd</span><span class=o>.</span><span class=n>GeoDataFrame</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>            <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Point</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]],</span>  <span class=c1># points</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>            <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>  <span class=c1># quadkeys</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=p>],</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>        <span class=n>zoom_level</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=n>predicate</span><span class=o>=</span><span class=s2>&quot;intersects&quot;</span><span class=p>,</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ZonalViewGeneratorConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=n>data_store</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DataStore</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>        <span class=n>logger</span><span class=p>:</span> <span class=n>logging</span><span class=o>.</span><span class=n>Logger</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=p>):</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=n>zone_data</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_init_zone_data</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>zoom_level</span><span class=p>,</span> <span class=n>predicate</span><span class=p>),</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>            <span class=n>zone_id_column</span><span class=o>=</span><span class=s2>&quot;quadkey&quot;</span><span class=p>,</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>,</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=n>data_store</span><span class=o>=</span><span class=n>data_store</span><span class=p>,</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>            <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=p>)</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>    <span class=k>def</span> <span class=nf>_init_zone_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source</span><span class=p>,</span> <span class=n>zoom_level</span><span class=p>,</span> <span class=n>predicate</span><span class=p>):</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>            <span class=n>tiles</span> <span class=o>=</span> <span class=n>CountryMercatorTiles</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>country</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>zoom_level</span><span class=o>=</span><span class=n>zoom_level</span><span class=p>)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=p>(</span><span class=n>BaseGeometry</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)):</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>all</span><span class=p>(</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>                <span class=nb>isinstance</span><span class=p>(</span><span class=n>qk</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=k>for</span> <span class=n>qk</span> <span class=ow>in</span> <span class=n>source</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>            <span class=p>):</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>                <span class=n>tiles</span> <span class=o>=</span> <span class=n>MercatorTiles</span><span class=o>.</span><span class=n>from_quadkeys</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>                <span class=n>tiles</span> <span class=o>=</span> <span class=n>MercatorTiles</span><span class=o>.</span><span class=n>from_spatial</span><span class=p>(</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>                    <span class=n>source</span><span class=o>=</span><span class=n>source</span><span class=p>,</span> <span class=n>zoom_level</span><span class=o>=</span><span class=n>zoom_level</span><span class=p>,</span> <span class=n>predicate</span><span class=o>=</span><span class=n>predicate</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>                <span class=p>)</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;sadadasfasfkasmf&quot;</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=k>return</span> <span class=n>tiles</span><span class=o>.</span><span class=n>to_geodataframe</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../core/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Core"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Core </div> </div> </a> <a href=../grid/ class="md-footer__link md-footer__link--next" aria-label="Next: Grid"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Grid </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 Giga </div> </div> <div class=md-social> <a href=https://github.com/unicef/giga-spatial target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/giga-spatial/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.instant", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.tabs.link", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.3220b9d7.min.js></script> </body> </html>